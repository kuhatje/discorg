<!DOCTYPE html><html lang=en><head><title>LanceDB - bug-reports</title><meta charset=utf-8><meta name=viewport content="width=device-width"><style>@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-normal-400.woff2");font-family:gg sans;font-weight:400;font-style:normal}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-normal-500.woff2");font-family:gg sans;font-weight:500;font-style:normal}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-normal-600.woff2");font-family:gg sans;font-weight:600;font-style:normal}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-normal-700.woff2");font-family:gg sans;font-weight:700;font-style:normal}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-normal-800.woff2");font-family:gg sans;font-weight:800;font-style:normal}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-italic-400.woff2");font-family:gg sans;font-weight:400;font-style:italic}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-italic-500.woff2");font-family:gg sans;font-weight:500;font-style:italic}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-italic-600.woff2");font-family:gg sans;font-weight:600;font-style:italic}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-italic-700.woff2");font-family:gg sans;font-weight:700;font-style:italic}@font-face{src:url("https://cdn.jsdelivr.net/gh/Tyrrrz/DiscordFonts@master/ggsans-italic-800.woff2");font-family:gg sans;font-weight:800;font-style:italic}html,body{margin:0;padding:0;background-color:#36393e;color:#dcddde;font-family:"gg sans","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:17px;font-weight:400;scroll-behavior:smooth}a{color:#00aff4;text-decoration:none}a:hover{text-decoration:underline}img{object-fit:contain;image-rendering:high-quality;image-rendering:-webkit-optimize-contrast}.preamble{display:grid;grid-template-columns:auto 1fr;max-width:100%;padding:1rem}.preamble__guild-icon-container{grid-column:1}.preamble__guild-icon{max-width:88px;max-height:88px}.preamble__entries-container{grid-column:2;margin-left:1rem}.preamble__entry{margin-bottom:0.15rem;color:#ffffff;font-size:1.4rem}.preamble__entry--small{font-size:1rem}.chatlog{padding:1rem 0;width:100%;border-top:1px solid rgba(255,255,255,0.1);border-bottom:1px solid rgba(255,255,255,0.1)}.chatlog__message-group{margin-bottom:1rem}.chatlog__message-container{background-color:transparent;transition:background-color 1s ease}.chatlog__message-container--highlighted{background-color:rgba(114,137,218,0.2)}.chatlog__message-container--pinned{background-color:rgba(249,168,37,0.05)}.chatlog__message{display:grid;grid-template-columns:auto 1fr;padding:0.15rem 0;direction:ltr;unicode-bidi:bidi-override}.chatlog__message:hover{background-color:#32353b}.chatlog__message:hover .chatlog__short-timestamp{display:block}.chatlog__message-aside{grid-column:1;width:72px;padding:0.15rem 0.15rem 0 0.15rem;text-align:center}.chatlog__reply-symbol{height:10px;margin:6px 4px 4px 36px;border-left:2px solid #4f545c;border-top:2px solid #4f545c;border-radius:8px 0 0 0}.chatlog__avatar{width:40px;height:40px;border-radius:50%}.chatlog__short-timestamp{display:none;color:#a3a6aa;font-size:0.75rem;font-weight:500;direction:ltr;unicode-bidi:bidi-override}.chatlog__message-primary{grid-column:2;min-width:0}.chatlog__reply{display:flex;margin-bottom:0.15rem;align-items:center;color:#b5b6b8;font-size:0.875rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.chatlog__reply-avatar{width:16px;height:16px;margin-right:0.25rem;border-radius:50%}.chatlog__reply-author{margin-right:0.3rem;font-weight:600}.chatlog__reply-content{overflow:hidden;text-overflow:ellipsis}.chatlog__reply-link{cursor:pointer}.chatlog__reply-link *{display:inline;pointer-events:none}.chatlog__reply-link .chatlog__markdown-quote{display:inline}.chatlog__reply-link .chatlog__markdown-pre{display:inline}.chatlog__reply-link:hover{color:#ffffff}.chatlog__reply-link:hover *:not(.chatlog__markdown-spoiler){color:inherit}.chatlog__reply-edited-timestamp{margin-left:0.25rem;color:#a3a6aa;font-size:0.75rem;font-weight:500;direction:ltr;unicode-bidi:bidi-override}.chatlog__system-notification-icon{width:18px;height:18px}.chatlog__system-notification-author{font-weight:500;color:#ffffff}.chatlog__system-notification-content{color:#96989d}.chatlog__system-notification-link{font-weight:500;color:#ffffff}.chatlog__system-notification-timestamp{margin-left:0.3rem;color:#a3a6aa;font-size:0.75rem;font-weight:500;direction:ltr;unicode-bidi:bidi-override}.chatlog__system-notification-timestamp a{color:inherit}.chatlog__header{margin-bottom:0.1rem}.chatlog__author{font-weight:500;color:#ffffff}.chatlog__author-tag{position:relative;top:-0.1rem;margin-left:0.3rem;padding:0.05rem 0.3rem;border-radius:3px;background-color:#5865F2;color:#ffffff;font-size:0.625rem;font-weight:500;line-height:1.3}.chatlog__timestamp{margin-left:0.3rem;color:#a3a6aa;font-size:0.75rem;font-weight:500;direction:ltr;unicode-bidi:bidi-override}.chatlog__timestamp a{color:inherit}.chatlog__content{padding-right:1rem;font-size:0.95rem;word-wrap:break-word}.chatlog__edited-timestamp{margin-left:0.15rem;color:#a3a6aa;font-size:0.75rem;font-weight:500}.chatlog__attachment{position:relative;width:fit-content;margin-top:0.3rem;border-radius:3px;overflow:hidden}.chatlog__attachment--hidden{cursor:pointer;box-shadow:0 0 1px 1px rgba(0,0,0,0.1)}.chatlog__attachment--hidden *{pointer-events:none}.chatlog__attachment-spoiler-caption{display:none;position:absolute;left:50%;top:50%;z-index:999;padding:0.4rem 0.8rem;border-radius:20px;transform:translate(-50%,-50%);background-color:rgba(0,0,0,0.9);color:#dcddde;font-size:0.9rem;font-weight:600;letter-spacing:0.05rem}.chatlog__attachment--hidden .chatlog__attachment-spoiler-caption{display:block}.chatlog__attachment--hidden:hover .chatlog__attachment-spoiler-caption{color:#fff}.chatlog__attachment-media{max-width:45vw;max-height:500px;vertical-align:top;border-radius:3px}.chatlog__attachment--hidden .chatlog__attachment-media{filter:blur(44px)}.chatlog__attachment-generic{max-width:520px;width:100%;height:40px;padding:10px;border:1px solid #292b2f;border-radius:3px;background-color:#2f3136;overflow:hidden}.chatlog__attachment--hidden .chatlog__attachment-generic{filter:blur(44px)}.chatlog__attachment-generic-icon{float:left;width:30px;height:100%;margin-right:10px}.chatlog__attachment-generic-size{color:#72767d;font-size:12px}.chatlog__attachment-generic-name{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.chatlog__embed{display:flex;margin-top:0.3rem;max-width:520px}.chatlog__embed-color-pill{flex-shrink:0;width:0.25rem;border-top-left-radius:3px;border-bottom-left-radius:3px}.chatlog__embed-color-pill--default{background-color:#202225}.chatlog__embed-content-container{display:flex;flex-direction:column;padding:0.5rem 0.6rem;border:1px solid rgba(46,48,54,0.6);border-top-right-radius:3px;border-bottom-right-radius:3px;background-color:rgba(46,48,54,0.3)}.chatlog__embed-content{display:flex;width:100%}.chatlog__embed-text{flex:1}.chatlog__embed-author-container{display:flex;margin-bottom:0.5rem;align-items:center}.chatlog__embed-author-icon{width:20px;height:20px;margin-right:0.5rem;border-radius:50%}.chatlog__embed-author{color:#ffffff;font-size:0.875rem;font-weight:600;direction:ltr;unicode-bidi:bidi-override}.chatlog__embed-author-link{color:#ffffff}.chatlog__embed-title{margin-bottom:0.5rem;color:#ffffff;font-size:0.875rem;font-weight:600}.chatlog__embed-description{color:#dcddde;font-weight:500;font-size:0.85rem}.chatlog__embed-fields{display:flex;flex-wrap:wrap;gap:0 0.5rem}.chatlog__embed-field{flex:0;min-width:100%;max-width:506px;padding-top:0.6rem;font-size:0.875rem}.chatlog__embed-field--inline{flex:1;flex-basis:auto;min-width:50px}.chatlog__embed-field-name{margin-bottom:0.2rem;color:#ffffff;font-weight:600}.chatlog__embed-field-value{color:#dcddde;font-weight:500}.chatlog__embed-thumbnail{flex:0;max-width:80px;max-height:80px;margin-left:1.2rem;border-radius:3px}.chatlog__embed-images{display:grid;margin-top:0.6rem;grid-template-columns:repeat(2,1fr);gap:0.25rem}.chatlog__embed-images--single{display:block}.chatlog__embed-image{object-fit:cover;object-position:center;max-width:500px;max-height:400px;width:100%;height:100%;border-radius:3px}.chatlog__embed-footer{margin-top:0.6rem;color:#dcddde}.chatlog__embed-footer-icon{width:20px;height:20px;margin-right:0.2rem;border-radius:50%;vertical-align:middle}.chatlog__embed-footer-text{vertical-align:middle;font-size:0.75rem;font-weight:500}.chatlog__embed-invite-container{min-width:320px;padding:0.6rem 0.7rem;border:1px solid rgba(46,48,54,0.6);border-radius:3px;background-color:rgba(46,48,54,0.3)}.chatlog__embed-invite-title{margin:0 0 0.8rem 0;color:#b9bbbe;font-size:0.75rem;font-weight:700;text-transform:uppercase}.chatlog__embed-invite{display:flex}.chatlog__embed-invite-guild-icon{width:50px;height:50px;border-radius:0.85rem}.chatlog__embed-invite-info{margin-left:1rem}.chatlog__embed-invite-guild-name{color:#ffffff;font-weight:600}.chatlog__embed-invite-guild-name a{color:inherit}.chatlog__embed-invite-channel-icon{width:18px;height:18px;vertical-align:bottom}.chatlog__embed-invite-channel-name{font-size:0.9rem;font-weight:600}.chatlog__embed-generic-image{object-fit:contain;object-position:left;max-width:45vw;max-height:500px;vertical-align:top;border-radius:3px}.chatlog__embed-generic-video{object-fit:contain;object-position:left;max-width:45vw;max-height:500px;vertical-align:top;border-radius:3px}.chatlog__embed-generic-gifv{object-fit:contain;object-position:left;max-width:45vw;max-height:500px;vertical-align:top;border-radius:3px}.chatlog__embed-spotify{border:0}.chatlog__embed-twitch{border:0}.chatlog__embed-youtube-container{margin-top:0.6rem}.chatlog__embed-youtube{border:0;border-radius:3px}.chatlog__sticker{width:180px;height:180px}.chatlog__sticker--media{max-width:100%;max-height:100%}.chatlog__reactions{display:flex}.chatlog__reaction{display:flex;margin:0.35rem 0.1rem 0.1rem 0;padding:0.125rem 0.375rem;border:1px solid transparent;border-radius:8px;background-color:#2f3136;align-items:center}.chatlog__reaction:hover{border:1px solid hsla(0,0%,100%,.2);background-color:transparent}.chatlog__reaction-count{min-width:9px;margin-left:0.35rem;color:#b9bbbe;font-size:0.875rem}.chatlog__reaction:hover .chatlog__reaction-count{color:#dcddde}.chatlog__markdown{max-width:100%;line-height:1.3;overflow-wrap:break-word}.chatlog__markdown h1{margin:1rem 0 0.5rem;color:#f2f3f5;font-size:1.5rem;line-height:1}.chatlog__markdown h2{margin:1rem 0 0.5rem;color:#f2f3f5;font-size:1.25rem;line-height:1}.chatlog__markdown h3{margin:1rem 0 0.5rem;color:#f2f3f5;font-size:1rem;line-height:1}.chatlog__markdown h1:first-child,h2:first-child,h3:first-child{margin-top:0.5rem}.chatlog__markdown ul,ol{margin:0 0 0 1rem;padding:0}.chatlog__markdown-preserve{white-space:pre-wrap}.chatlog__markdown-spoiler{background-color:rgba(255,255,255,0.1);padding:0 2px;border-radius:3px}.chatlog__markdown-spoiler--hidden{cursor:pointer;background-color:#202225;color:rgba(0,0,0,0)}.chatlog__markdown-spoiler--hidden:hover{background-color:rgba(32,34,37,0.8)}.chatlog__markdown-spoiler--hidden::selection{color:rgba(0,0,0,0)}.chatlog__markdown-quote{display:flex;margin:0.05rem 0}.chatlog__markdown-quote-border{margin-right:0.5rem;border:2px solid #4f545c;border-radius:3px}.chatlog__markdown-pre{background-color:#2f3136;font-family:"Consolas","Courier New",Courier,monospace;font-size:0.85rem;text-decoration:inherit}.chatlog__markdown-pre--multiline{display:block;margin-top:0.25rem;padding:0.5rem;border:2px solid #282b30;border-radius:5px;color:#b9bbbe}.chatlog__markdown-pre--multiline.hljs{background-color:#2f3136;color:#b9bbbe}.chatlog__markdown-pre--inline{display:inline-block;padding:2px;border-radius:3px}.chatlog__markdown-mention{border-radius:3px;padding:0 2px;background-color:rgba(88,101,242,.3);color:#dee0fc;font-weight:500}.chatlog__markdown-mention:hover{background-color:#5865f2;color:#ffffff}.chatlog__markdown-timestamp{background-color:rgba(255,255,255,0.1);padding:0 2px;border-radius:3px}.chatlog__emoji{width:1.325rem;height:1.325rem;margin:0 0.06rem;vertical-align:-0.4rem}.chatlog__emoji--small{width:1rem;height:1rem}.chatlog__emoji--large{width:2.8rem;height:2.8rem}.postamble{padding:1.25rem}.postamble__entry{color:#ffffff}</style><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/solarized-dark.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js></script><script>document.addEventListener('DOMContentLoaded',()=>{document.querySelectorAll('.chatlog__markdown-pre--multiline').forEach(e=>hljs.highlightBlock(e));});</script><script src=https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.8.1/lottie.min.js></script><script>document.addEventListener('DOMContentLoaded',()=>{document.querySelectorAll('.chatlog__sticker--media[data-source]').forEach(e=>{const anim=lottie.loadAnimation({container:e,renderer:'svg',loop:true,autoplay:true,path:e.getAttribute('data-source')});anim.addEventListener('data_failed',()=>e.innerHTML='<strong>[Sticker cannot be rendered]</strong>');});});</script><script>function scrollToMessage(event,id){const element=document.getElementById('chatlog__message-container-'+id);if(!element)
return;event.preventDefault();element.classList.add('chatlog__message-container--highlighted');window.scrollTo({top:element.getBoundingClientRect().top-document.body.getBoundingClientRect().top-(window.innerHeight/2),behavior:'smooth'});window.setTimeout(()=>element.classList.remove('chatlog__message-container--highlighted'),2000);}
function showSpoiler(event,element){if(!element)
return;if(element.classList.contains('chatlog__attachment--hidden')){event.preventDefault();element.classList.remove('chatlog__attachment--hidden');}
if(element.classList.contains('chatlog__markdown-spoiler--hidden')){event.preventDefault();element.classList.remove('chatlog__markdown-spoiler--hidden');}}</script><svg style=display:none xmlns=http://www.w3.org/2000/svg><defs><symbol id=attachment-icon viewBox="0 0 720 960"><path fill=#f4f5fb d=M50,935a25,25,0,0,1-25-25V50A25,25,0,0,1,50,25H519.6L695,201.32V910a25,25,0,0,1-25,25Z /><path fill=#7789c4 d=M509.21,50,670,211.63V910H50V50H509.21M530,0H50A50,50,0,0,0,0,50V910a50,50,0,0,0,50,50H670a50,50,0,0,0,50-50h0V191Z /><path fill=#f4f5fb d=M530,215a25,25,0,0,1-25-25V50a25,25,0,0,1,16.23-23.41L693.41,198.77A25,25,0,0,1,670,215Z /><path fill=#7789c4 d=M530,70.71,649.29,190H530V70.71M530,0a50,50,0,0,0-50,50V190a50,50,0,0,0,50,50H670a50,50,0,0,0,50-50Z /></symbol><symbol id=join-icon viewBox="0 0 18 18"><path fill=#3ba55c d="m0 8h14.2l-3.6-3.6 1.4-1.4 6 6-6 6-1.4-1.4 3.6-3.6h-14.2" /></symbol><symbol id=leave-icon viewBox="0 0 18 18"><path fill=#ed4245 d="m3.8 8 3.6-3.6-1.4-1.4-6 6 6 6 1.4-1.4-3.6-3.6h14.2v-2" /></symbol><symbol id=call-icon viewBox="0 0 18 18"><path fill=#3ba55c fill-rule=evenodd d="M17.7163041 15.36645368c-.0190957.02699568-1.9039523 2.6680735-2.9957762 2.63320406-3.0676659-.09785935-6.6733809-3.07188394-9.15694343-5.548738C3.08002193 9.9740657.09772497 6.3791404 0 3.3061316v-.024746C0 2.2060575 2.61386252.3152347 2.64082114.2972376c.7110335-.4971705 1.4917101-.3149497 1.80959713.1372281.19320342.2744561 2.19712724 3.2811005 2.42290565 3.6489167.09884826.1608492.14714912.3554431.14714912.5702838 0 .2744561-.07975258.5770327-.23701117.8751101-.1527655.2902036-.65262318 1.1664385-.89862055 1.594995.2673396.3768148.94804468 1.26429792 2.351016 2.66357424 1.39173858 1.39027775 2.28923588 2.07641807 2.67002628 2.34187563.4302146-.2452108 1.3086162-.74238132 1.5972981-.89423205.5447887-.28682915 1.0907006-.31944893 1.4568885-.08661115.3459689.2182151 3.3383754 2.21027167 3.6225641 2.41611376.2695862.19234426.4144887.5399137.4144887.91672846 0 .2969525-.089862.61190215-.2808189.88523346" /></symbol><symbol id=pencil-icon viewBox="0 0 18 18"><path fill=#99aab5 d="m0 14.25v3.75h3.75l11.06-11.06-3.75-3.75zm17.71-10.21c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75z" /></symbol><symbol id=pin-icon viewBox="0 0 18 18"><path fill=#b9bbbe d="m16.908 8.39684-8.29587-8.295827-1.18584 1.184157 1.18584 1.18584-4.14834 4.1475v.00167l-1.18583-1.18583-1.185 1.18583 3.55583 3.55502-4.740831 4.74 1.185001 1.185 4.74083-4.74 3.55581 3.555 1.185-1.185-1.185-1.185 4.1475-4.14836h.0009l1.185 1.185z" /></symbol><symbol id=channel-icon viewBox="0 0 24 24"><path fill=#b9bbbe d="M5.88657 21C5.57547 21 5.3399 20.7189 5.39427 20.4126L6.00001 17H2.59511C2.28449 17 2.04905 16.7198 2.10259 16.4138L2.27759 15.4138C2.31946 15.1746 2.52722 15 2.77011 15H6.35001L7.41001 9H4.00511C3.69449 9 3.45905 8.71977 3.51259 8.41381L3.68759 7.41381C3.72946 7.17456 3.93722 7 4.18011 7H7.76001L8.39677 3.41262C8.43914 3.17391 8.64664 3 8.88907 3H9.87344C10.1845 3 10.4201 3.28107 10.3657 3.58738L9.76001 7H15.76L16.3968 3.41262C16.4391 3.17391 16.6466 3 16.8891 3H17.8734C18.1845 3 18.4201 3.28107 18.3657 3.58738L17.76 7H21.1649C21.4755 7 21.711 7.28023 21.6574 7.58619L21.4824 8.58619C21.4406 8.82544 21.2328 9 20.9899 9H17.41L16.35 15H19.7549C20.0655 15 20.301 15.2802 20.2474 15.5862L20.0724 16.5862C20.0306 16.8254 19.8228 17 19.5799 17H16L15.3632 20.5874C15.3209 20.8261 15.1134 21 14.8709 21H13.8866C13.5755 21 13.3399 20.7189 13.3943 20.4126L14 17H8.00001L7.36325 20.5874C7.32088 20.8261 7.11337 21 6.87094 21H5.88657ZM9.41045 9L8.35045 15H14.3504L15.4104 9H9.41045Z" /></symbol><symbol id=thread-icon viewBox="0 0 24 24"><path fill=#b9bbbe d="M5.43309 21C5.35842 21 5.30189 20.9325 5.31494 20.859L5.99991 17H2.14274C2.06819 17 2.01168 16.9327 2.02453 16.8593L2.33253 15.0993C2.34258 15.0419 2.39244 15 2.45074 15H6.34991L7.40991 9H3.55274C3.47819 9 3.42168 8.93274 3.43453 8.85931L3.74253 7.09931C3.75258 7.04189 3.80244 7 3.86074 7H7.75991L8.45234 3.09903C8.46251 3.04174 8.51231 3 8.57049 3H10.3267C10.4014 3 10.4579 3.06746 10.4449 3.14097L9.75991 7H15.7599L16.4523 3.09903C16.4625 3.04174 16.5123 3 16.5705 3H18.3267C18.4014 3 18.4579 3.06746 18.4449 3.14097L17.7599 7H21.6171C21.6916 7 21.7481 7.06725 21.7353 7.14069L21.4273 8.90069C21.4172 8.95811 21.3674 9 21.3091 9H17.4099L17.0495 11.04H15.05L15.4104 9H9.41035L8.35035 15H10.5599V17H7.99991L7.30749 20.901C7.29732 20.9583 7.24752 21 7.18934 21H5.43309Z" /><path fill=#b9bbbe d="M13.4399 12.96C12.9097 12.96 12.4799 13.3898 12.4799 13.92V20.2213C12.4799 20.7515 12.9097 21.1813 13.4399 21.1813H14.3999C14.5325 21.1813 14.6399 21.2887 14.6399 21.4213V23.4597C14.6399 23.6677 14.8865 23.7773 15.0408 23.6378L17.4858 21.4289C17.6622 21.2695 17.8916 21.1813 18.1294 21.1813H22.5599C23.0901 21.1813 23.5199 20.7515 23.5199 20.2213V13.92C23.5199 13.3898 23.0901 12.96 22.5599 12.96H13.4399Z" /></symbol></defs></svg><body><div class=preamble><div class=preamble__guild-icon-container><img class=preamble__guild-icon src="https://cdn.discordapp.com/icons/1030247538198061086/3b63f3695230f74fda100de956749b12.png?size=512" alt="Guild icon" loading=lazy></div><div class=preamble__entries-container><div class=preamble__entry>LanceDB</div><div class=preamble__entry>Archived channels / bug-reports</div></div></div>
<div class="chatlog">

<div class=chatlog__message-group><div id=chatlog__message-container-1105636820500357240 class=chatlog__message-container data-message-id=1105636820500357240><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:25â€¯PM"><a href=#chatlog__message-container-1105636820500357240>5/9/2023 11:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>new filter bug of very uncertain origin</span></div></div></div></div><div id=chatlog__message-container-1105636836094771270 class=chatlog__message-container data-message-id=1105636836094771270><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:26â€¯PM">11:26â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ArrowInvalid: C Data interface error: Io error: Execution error: LanceError(I/O): Execution error: LanceError(Arrow): Invalid argument error: null_count 3546 for an array exceeds length of 2336 elements</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105637384122536058 class=chatlog__message-container data-message-id=1105637384122536058><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:28â€¯PM"><a href=#chatlog__message-container-1105637384122536058>5/9/2023 11:28â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>iiuc, this blocks you more than the filter expression one?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105637713111158784 class=chatlog__message-container data-message-id=1105637713111158784><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:29â€¯PM"><a href=#chatlog__message-container-1105637713111158784>5/9/2023 11:29â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yes, the filter expression issue i fixed by just changing the column names</span></div></div></div></div><div id=chatlog__message-container-1105637799174082563 class=chatlog__message-container data-message-id=1105637799174082563><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:29â€¯PM">11:29â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>currently trying to test out performance on a dataset of ~350k rows</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105637841909862471 class=chatlog__message-container data-message-id=1105637841909862471><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:30â€¯PM"><a href=#chatlog__message-container-1105637841909862471>5/9/2023 11:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh this seems to be similar to <a href="https://github.com/lancedb/lancedb/issues/64">https://github.com/lancedb/lancedb/issues/64</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/64><div class="chatlog__markdown chatlog__markdown-preserve">lanceError (arrow) - caused by typing issue in input dataframe &#183; Is...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">lancedb error on version 0.1.2 error below is solvable by forcing dtypes of def force_types_of_df(df): desired_dtypes = { &#39;id&#39;: &#39;string&#39;, &#39;comment_text&#39;: &#39;string&#39;, &amp;...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/15tP54h2r6dDZ5stQXWo-1uTk5vKm4H3pOSM2Es73TE/https/opengraph.githubassets.com/aaa932bdda0261f8e57002de0ecd03ae4efbdb46c7fce0d00b1506ee37301ccc/lancedb/lancedb/issues/64> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/15tP54h2r6dDZ5stQXWo-1uTk5vKm4H3pOSM2Es73TE/https/opengraph.githubassets.com/aaa932bdda0261f8e57002de0ecd03ae4efbdb46c7fce0d00b1506ee37301ccc/lancedb/lancedb/issues/64 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105637947438538794 class=chatlog__message-container data-message-id=1105637947438538794><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:30â€¯PM"><a href=#chatlog__message-container-1105637947438538794>5/9/2023 11:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i don&#39;t think there are any nans? i guess i should just load that column &amp; inspect it</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105638061993365585 class=chatlog__message-container data-message-id=1105638061993365585><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:30â€¯PM"><a href=#chatlog__message-container-1105638061993365585>5/9/2023 11:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yea there is no nulls (somewhere a bug in our code i feel)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105638108013285397 class=chatlog__message-container data-message-id=1105638108013285397><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:31â€¯PM"><a href=#chatlog__message-container-1105638108013285397>5/9/2023 11:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>new bug when reading this data</span></div></div></div></div><div id=chatlog__message-container-1105638118255755316 class=chatlog__message-container data-message-id=1105638118255755316><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:31â€¯PM">11:31â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ArrowInvalid: C Data interface error: Io error: Execution error: LanceError(I/O): Execution error: LanceError(Arrow): Invalid argument error: Offset invariant failure: non-monotonic offset at slot 7419: 2147137240 &gt; 0</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105638120105455758 class=chatlog__message-container data-message-id=1105638120105455758><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:31â€¯PM"><a href=#chatlog__message-container-1105638120105455758>5/9/2023 11:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>if you could repro easily, pls do let us know</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105638153332719656 class=chatlog__message-container data-message-id=1105638153332719656><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:31â€¯PM"><a href=#chatlog__message-container-1105638153332719656>5/9/2023 11:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this is just reading the webp column</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105638203924426782 class=chatlog__message-container data-message-id=1105638203924426782><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:31â€¯PM"><a href=#chatlog__message-container-1105638203924426782>5/9/2023 11:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>it looks like a overflow</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105638210186514492 class=chatlog__message-container data-message-id=1105638210186514492><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:31â€¯PM"><a href=#chatlog__message-container-1105638210186514492>5/9/2023 11:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>wrote dataset with <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">dataset = lance.write_dataset(
    reader,
    write_path,
    max_rows_per_file=100 * 1024,
    max_rows_per_group=10 * 1024,
)</code></span></div></div></div></div><div id=chatlog__message-container-1105638474591240233 class=chatlog__message-container data-message-id=1105638474591240233><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:32â€¯PM">11:32â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yeah these fragments are ~22GiB</span></div></div></div></div><div id=chatlog__message-container-1105638526546083970 class=chatlog__message-container data-message-id=1105638526546083970><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:32â€¯PM">11:32â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>and lots of variable-length columns</span></div></div></div></div><div id=chatlog__message-container-1105638601385070652 class=chatlog__message-container data-message-id=1105638601385070652><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:33â€¯PM">11:33â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>maybe i should reduce rows per group &amp; rows per file?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105638664748412988 class=chatlog__message-container data-message-id=1105638664748412988><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:33â€¯PM"><a href=#chatlog__message-container-1105638664748412988>5/9/2023 11:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this is a known bug , that if your input is just one RecordBatch, it does not &quot;cut&quot; it at the moment.</span></div></div></div></div><div id=chatlog__message-container-1105638755580264548 class=chatlog__message-container data-message-id=1105638755580264548><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:33â€¯PM">11:33â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/eto-ai/lance/pull/811">https://github.com/eto-ai/lance/pull/811</a> fix is here , but still need some work, a few days out</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/eto-ai/lance/pull/811><div class="chatlog__markdown chatlog__markdown-preserve">Support max_rows_per_group by eddyxu &#183; Pull Request #811 &#183; eto-ai/l...</div></a></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/VZE-ksvQEQeDdLyLWd7DOd-siu_WUYb0yleYeTu4koU/https/opengraph.githubassets.com/205fde27bf6d506eeacfdb8e8038b4abe251afa5356b7465505c0a16386ee2c2/eto-ai/lance/pull/811> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/VZE-ksvQEQeDdLyLWd7DOd-siu_WUYb0yleYeTu4koU/https/opengraph.githubassets.com/205fde27bf6d506eeacfdb8e8038b4abe251afa5356b7465505c0a16386ee2c2/eto-ai/lance/pull/811 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1105638913571307531 class=chatlog__message-container data-message-id=1105638913571307531><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:34â€¯PM">11:34â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>can you try to walk around that by do a few <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">slicing</code> over your RecordBatch / Table, to make each of them not more than 1M</span></div></div></div></div><div id=chatlog__message-container-1105638924619096066 class=chatlog__message-container data-message-id=1105638924619096066><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:34â€¯PM">11:34â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>1M records</span></div></div></div></div><div id=chatlog__message-container-1105639002276642897 class=chatlog__message-container data-message-id=1105639002276642897><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:34â€¯PM">11:34â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>each of them to be just your desired <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">max_rows_per_group</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105639122346967073 class=chatlog__message-container data-message-id=1105639122346967073><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105638664748412988')"> this is a known bug , that if your input is just one RecordBatch, it does not &quot;cut&quot; it at the moment. </span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:35â€¯PM"><a href=#chatlog__message-container-1105639122346967073>5/9/2023 11:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>wdym?</span></div></div></div></div><div id=chatlog__message-container-1105639200969216133 class=chatlog__message-container data-message-id=1105639200969216133><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:35â€¯PM">11:35â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i don&#39;t understand what slicing you want me to do, the reader in this case is a bunch of 64-row <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">RecordBatch</code>es</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105639367214645372 class=chatlog__message-container data-message-id=1105639367214645372><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:36â€¯PM"><a href=#chatlog__message-container-1105639367214645372>5/9/2023 11:36â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hmm, that&#39;s strange.</span></div></div></div></div><div id=chatlog__message-container-1105639454284206220 class=chatlog__message-container data-message-id=1105639454284206220><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:36â€¯PM">11:36â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>so what column could it be, i.e., what would be the mean size of that column</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105639520336089159 class=chatlog__message-container data-message-id=1105639520336089159><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:36â€¯PM"><a href=#chatlog__message-container-1105639520336089159>5/9/2023 11:36â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>in this case i&#39;m just loading the webp column, i can check mean size one sec</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105639559456358400 class=chatlog__message-container data-message-id=1105639559456358400><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:36â€¯PM"><a href=#chatlog__message-container-1105639559456358400>5/9/2023 11:36â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><img
    loading="lazy"
    class="chatlog__emoji chatlog__emoji--large"
    alt="ðŸ™"
    title="pray"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105639571573710869 class=chatlog__message-container data-message-id=1105639571573710869><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:36â€¯PM"><a href=#chatlog__message-container-1105639571573710869>5/9/2023 11:36â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh wait uh</span></div></div></div></div><div id=chatlog__message-container-1105639590523588748 class=chatlog__message-container data-message-id=1105639590523588748><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:37â€¯PM">11:37â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>idk how easily i can check that</span></div></div></div></div><div id=chatlog__message-container-1105639610228420610 class=chatlog__message-container data-message-id=1105639610228420610><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:37â€¯PM">11:37â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i guess i can load a few batches</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=ok_hand><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘Œ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44c.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div><div id=chatlog__message-container-1105640174098063433 class=chatlog__message-container data-message-id=1105640174098063433><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:39â€¯PM">11:39â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>histogram of sizes in bytes for the first 10k rows</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1105640173892546680/image.png?ex=698a7027&amp;is=69891ea7&amp;hm=5993c3649010f1715f317485b8541e3f0284d2fede29ce52d60029db15c7bd3f&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1105640173892546680/image.png?ex=698a7027&amp;is=69891ea7&amp;hm=5993c3649010f1715f317485b8541e3f0284d2fede29ce52d60029db15c7bd3f&amp;" alt="Image attachment" title="Image: image.png (14.67 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105640296047452220 class=chatlog__message-container data-message-id=1105640296047452220><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:39â€¯PM"><a href=#chatlog__message-container-1105640296047452220>5/9/2023 11:39â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hmm, so if the group size is correct, this is no more than 10MB per group</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105640749271371786 class=chatlog__message-container data-message-id=1105640749271371786><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:41â€¯PM"><a href=#chatlog__message-container-1105640749271371786>5/9/2023 11:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i think there are some very large outliers</span></div></div></div></div><div id=chatlog__message-container-1105640828384329820 class=chatlog__message-container data-message-id=1105640828384329820><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:41â€¯PM">11:41â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>trying 100k rows now w/1000 bins</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105640911221837884 class=chatlog__message-container data-message-id=1105640911221837884><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=theseriousadult>jack</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105640749271371786')"> i think there are some very large outliers </span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:42â€¯PM"><a href=#chatlog__message-container-1105640911221837884>5/9/2023 11:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>eg yuuuuuge images</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=mechanical_leg><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ¦¿ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f9bf.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105640960685244426 class=chatlog__message-container data-message-id=1105640960685244426><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:42â€¯PM"><a href=#chatlog__message-container-1105640960685244426>5/9/2023 11:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>lemme take a look. in the meantime, if it is easy, can you try just create fragments to be smaller 4GB  , just in case. 

iirc, the offsets are uint32 now, might be the reason</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105640990716473354 class=chatlog__message-container data-message-id=1105640990716473354><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:42â€¯PM"><a href=#chatlog__message-container-1105640990716473354>5/9/2023 11:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh</span></div></div></div></div><div id=chatlog__message-container-1105641002640883713 class=chatlog__message-container data-message-id=1105641002640883713><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:42â€¯PM">11:42â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>that&#39;s def it</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641116432347148 class=chatlog__message-container data-message-id=1105641116432347148><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:43â€¯PM"><a href=#chatlog__message-container-1105641116432347148>5/9/2023 11:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yea that&#39;s arrow&#39;s default offset types. we might miss the chance to cast it somewhere</span> <span class=chatlog__edited-timestamp title="Tuesday, May 9, 2023 11:43â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641298855198751 class=chatlog__message-container data-message-id=1105641298855198751><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=theseriousadult>jack</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105640174098063433')"> histogram of sizes in bytes for the first 10k rows </span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:43â€¯PM"><a href=#chatlog__message-container-1105641298855198751>5/9/2023 11:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh wait, the <em>x</em> axis here is number of bytes, in millions</span></div></div></div></div><div id=chatlog__message-container-1105641328156610592 class=chatlog__message-container data-message-id=1105641328156610592><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:43â€¯PM">11:43â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i think</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641376705679441 class=chatlog__message-container data-message-id=1105641376705679441><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:44â€¯PM"><a href=#chatlog__message-container-1105641376705679441>5/9/2023 11:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh , y is counts?</span></div></div></div></div><div id=chatlog__message-container-1105641420649418752 class=chatlog__message-container data-message-id=1105641420649418752><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:44â€¯PM">11:44â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh ... lol</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641537527885854 class=chatlog__message-container data-message-id=1105641537527885854><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:44â€¯PM"><a href=#chatlog__message-container-1105641537527885854>5/9/2023 11:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>there we go - y axis is density, x axis is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">log10(len(webp))</code></span> <span class=chatlog__edited-timestamp title="Tuesday, May 9, 2023 11:45â€¯PM">(edited)</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1105641537326563428/image.png?ex=698a716c&amp;is=69891fec&amp;hm=2a51553785208eeb2d767e259600561a58a08e5353ba8ab69a3f8bf2dbea2f16&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1105641537326563428/image.png?ex=698a716c&amp;is=69891fec&amp;hm=2a51553785208eeb2d767e259600561a58a08e5353ba8ab69a3f8bf2dbea2f16&amp;" alt="Image attachment" title="Image: image.png (12.47 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641541449547877 class=chatlog__message-container data-message-id=1105641541449547877><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:44â€¯PM"><a href=#chatlog__message-container-1105641541449547877>5/9/2023 11:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>there are a few in 1-2MBs, 10K of that is 2GB ?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641559849963633 class=chatlog__message-container data-message-id=1105641559849963633><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:44â€¯PM"><a href=#chatlog__message-container-1105641559849963633>5/9/2023 11:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yep</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641583329677332 class=chatlog__message-container data-message-id=1105641583329677332><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/179323964227715072/218c4d38fe80c0c8f4db901d233a7274.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=arc_. data-user-id=179323964227715072>Arc</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:44â€¯PM"><a href=#chatlog__message-container-1105641583329677332>5/9/2023 11:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey there! Sorry to interrupt you guys but I think this is not supposed to work like this. In the screenshots you can see that the database consists of 4 columns, when I&#39;m specifying a where clause for the &quot;user&quot; column, I get this error. <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ValueError: LanceError(I/O): function &#39;user&#39; is not supported</code>. What could be the problem?</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1105641583065432095/image.png?ex=698a7177&amp;is=69891ff7&amp;hm=cf8cd291a094c2a3d3c50ab1d7965d0cac4e4c5c5d55acec3666e22bc9486e39&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1105641583065432095/image.png?ex=698a7177&amp;is=69891ff7&amp;hm=cf8cd291a094c2a3d3c50ab1d7965d0cac4e4c5c5d55acec3666e22bc9486e39&amp;" alt="Image attachment" title="Image: image.png (2.36 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641594402635826 class=chatlog__message-container data-message-id=1105641594402635826><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:44â€¯PM"><a href=#chatlog__message-container-1105641594402635826>5/9/2023 11:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>so probably i need smaller groups of rows too</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641824195985430 class=chatlog__message-container data-message-id=1105641824195985430><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=theseriousadult>jack</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105641537527885854')"> there we go - y axis is density, x axis is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">log10(len(webp))</code> </span> <span class=chatlog__reply-edited-timestamp title="Tuesday, May 9, 2023 11:45â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:45â€¯PM"><a href=#chatlog__message-container-1105641824195985430>5/9/2023 11:45â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>so that&#39;s mostly 100kb, some as low as 1kb, many as high as 10mb</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641835826774087 class=chatlog__message-container data-message-id=1105641835826774087><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:45â€¯PM"><a href=#chatlog__message-container-1105641835826774087>5/9/2023 11:45â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh, what type do you use to store webp?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641862968123502 class=chatlog__message-container data-message-id=1105641862968123502><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105641835826774087')"> oh, what type do you use to store webp? </span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:46â€¯PM"><a href=#chatlog__message-container-1105641862968123502>5/9/2023 11:46â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>bytes</span></div></div></div></div><div id=chatlog__message-container-1105641891363573881 class=chatlog__message-container data-message-id=1105641891363573881><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:46â€¯PM">11:46â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>err, <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">binary</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641915069775954 class=chatlog__message-container data-message-id=1105641915069775954><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:46â€¯PM"><a href=#chatlog__message-container-1105641915069775954>5/9/2023 11:46â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>try <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">LargeBinary</code>? which is 64 bit length</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641917271773244 class=chatlog__message-container data-message-id=1105641917271773244><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:46â€¯PM"><a href=#chatlog__message-container-1105641917271773244>5/9/2023 11:46â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>should I be using a different type?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105641949093953617 class=chatlog__message-container data-message-id=1105641949093953617><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:46â€¯PM"><a href=#chatlog__message-container-1105641949093953617>5/9/2023 11:46â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>for offsets</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105642204829069410 class=chatlog__message-container data-message-id=1105642204829069410><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:47â€¯PM"><a href=#chatlog__message-container-1105642204829069410>5/9/2023 11:47â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>how do I cast a column for a record batch?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105642380826267678 class=chatlog__message-container data-message-id=1105642380826267678><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=theseriousadult>jack</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105642204829069410')"> how do I cast a column for a record batch? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:48â€¯PM"><a href=#chatlog__message-container-1105642380826267678>5/9/2023 11:48â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://arrow.apache.org/docs/python/generated/pyarrow.compute.cast.html">https://arrow.apache.org/docs/python/generated/pyarrow.compute.cast.html</a> maybe ..</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105642438648934480 class=chatlog__message-container data-message-id=1105642438648934480><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:48â€¯PM"><a href=#chatlog__message-container-1105642438648934480>5/9/2023 11:48â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>table has a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cast</code> method which takes a schema</span></div></div></div></div><div id=chatlog__message-container-1105642459674972160 class=chatlog__message-container data-message-id=1105642459674972160><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:48â€¯PM">11:48â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i should see if recordbatch has similar</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=ok_hand><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘Œ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44c.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div><div id=chatlog__message-container-1105643048035168306 class=chatlog__message-container data-message-id=1105643048035168306><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:50â€¯PM">11:50â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>nope</span></div></div></div></div><div id=chatlog__message-container-1105643077089103893 class=chatlog__message-container data-message-id=1105643077089103893><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:50â€¯PM">11:50â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>so i guess i can... route through <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table</code></span></div></div></div></div><div id=chatlog__message-container-1105643105786527884 class=chatlog__message-container data-message-id=1105643105786527884><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:50â€¯PM">11:50â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><img
    loading="lazy"
    class="chatlog__emoji chatlog__emoji--large"
    alt="ðŸ¤·"
    title="person_shrugging"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f937.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105643116372967554 class=chatlog__message-container data-message-id=1105643116372967554><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:51â€¯PM"><a href=#chatlog__message-container-1105643116372967554>5/9/2023 11:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://arrow.apache.org/docs/python/generated/pyarrow.large_binary.html#pyarrow.large_binary">https://arrow.apache.org/docs/python/generated/pyarrow.large_binary.html#pyarrow.large_binary</a></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105643143870816316 class=chatlog__message-container data-message-id=1105643143870816316><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:51â€¯PM"><a href=#chatlog__message-container-1105643143870816316>5/9/2023 11:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>pyarrow has such a weird api</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105643206869274794 class=chatlog__message-container data-message-id=1105643206869274794><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:51â€¯PM"><a href=#chatlog__message-container-1105643206869274794>5/9/2023 11:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>does it take more time to create from scratch or better to convert from existing table?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105643246358626414 class=chatlog__message-container data-message-id=1105643246358626414><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=theseriousadult>jack</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105643143870816316')"> pyarrow has such a weird api </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:51â€¯PM"><a href=#chatlog__message-container-1105643246358626414>5/9/2023 11:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>do tell <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™‚"
    title="slight_smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f642.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105643362968686622 class=chatlog__message-container data-message-id=1105643362968686622><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:51â€¯PM"><a href=#chatlog__message-container-1105643362968686622>5/9/2023 11:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>eg there&#39;s no way to concat <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">RecordBatchReader</code>s</span></div></div></div></div><div id=chatlog__message-container-1105643468719652935 class=chatlog__message-container data-message-id=1105643468719652935><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:52â€¯PM">11:52â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pa.table</code> will work on a dict, but <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pa.record_batch</code> won&#39;t</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105643596671107194 class=chatlog__message-container data-message-id=1105643596671107194><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:52â€¯PM"><a href=#chatlog__message-container-1105643596671107194>5/9/2023 11:52â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>do you have some concrete needs that we can do some syntax super from lance?</span></div></div></div></div><div id=chatlog__message-container-1105643719807483934 class=chatlog__message-container data-message-id=1105643719807483934><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:53â€¯PM">11:53â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://arrow.apache.org/docs/python/generated/pyarrow.Table.html#pyarrow.Table.from_batches">https://arrow.apache.org/docs/python/generated/pyarrow.Table.html#pyarrow.Table.from_batches</a>  can takes some batches to build a Table</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105644016692895815 class=chatlog__message-container data-message-id=1105644016692895815><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:54â€¯PM"><a href=#chatlog__message-container-1105644016692895815>5/9/2023 11:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I mean, I want the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pa.table</code> / <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pa.record_batch(values, names=keys)</code> type detection, I just add some casts afterwards bc it&#39;s cheap</span></div></div></div></div><div id=chatlog__message-container-1105644069352374322 class=chatlog__message-container data-message-id=1105644069352374322><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:54â€¯PM">11:54â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I guess what I want is something like</span></div></div></div></div><div id=chatlog__message-container-1105644402514337842 class=chatlog__message-container data-message-id=1105644402514337842><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:56â€¯PM">11:56â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-py">def write_{dataset,fragment}_from_batch_iter(
  batches: Iterator[Dict[str, np.array]], 
  *, 
  type_overrides: Dict[str, PyArrowType], 
  **other_write_args
) -&gt; lance.Dataset:
  ...</code></span> <span class=chatlog__edited-timestamp title="Tuesday, May 9, 2023 11:56â€¯PM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1105644585234997288 class=chatlog__message-container data-message-id=1105644585234997288><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:56â€¯PM">11:56â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m basically writing that API now</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105645191458721833 class=chatlog__message-container data-message-id=1105645191458721833><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 9, 2023 11:59â€¯PM"><a href=#chatlog__message-container-1105645191458721833>5/9/2023 11:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Kk, I see . We can make some of them work I feel . Have done something similar for adapters of torch.tensor .</span></div></div></div></div><div id=chatlog__message-container-1105645273990049793 class=chatlog__message-container data-message-id=1105645273990049793><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, May 9, 2023 11:59â€¯PM">11:59â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Need run an errand now . Will check back in half hour or so</span></div></div></div></div><div id=chatlog__message-container-1105645412121051136 class=chatlog__message-container data-message-id=1105645412121051136><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:00â€¯AM">12:00â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We do have someone else asking us for numpy native types / api support .</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105647568597303397 class=chatlog__message-container data-message-id=1105647568597303397><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:08â€¯AM"><a href=#chatlog__message-container-1105647568597303397>5/10/2023 12:08â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="lei.xu">@lei</span> how big should a column be before I write it as a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">large_binary</code>?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105647977650987058 class=chatlog__message-container data-message-id=1105647977650987058><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:10â€¯AM"><a href=#chatlog__message-container-1105647977650987058>5/10/2023 12:10â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>A row group  is bigger than i32::max bytes</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105649400040140860 class=chatlog__message-container data-message-id=1105649400040140860><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=theseriousadult>jack</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105644402514337842')"> <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-py">def write_{dataset,fragment}_from_batch_iter(
  batches: Iterator[Dict[str, np.array]], 
  *, 
  type_overrides: Dict[str, PyArrowType], 
  **other_write_args
) -&gt; lance.Dataset:
  ...</code> </span> <span class=chatlog__reply-edited-timestamp title="Tuesday, May 9, 2023 11:56â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:15â€¯AM"><a href=#chatlog__message-container-1105649400040140860>5/10/2023 12:15â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>another reason to support this api, it naturally extends to including types that don&#39;t exist in pyarrow, since eg tensor columns w/bf16 dtype can&#39;t currently pass through pyarrow w/o cast to float32 &amp; flattening</span> <span class=chatlog__edited-timestamp title="Wednesday, May 10, 2023 12:16â€¯AM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1105650359055171655 class=chatlog__message-container data-message-id=1105650359055171655><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:19â€¯AM">12:19â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">large_binary</code> type seems to be working so far <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™‚"
    title="slight_smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f642.svg"></span></div></div></div></div><div id=chatlog__message-container-1105650814019706960 class=chatlog__message-container data-message-id=1105650814019706960><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:21â€¯AM">12:21â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">count_rows()</code> is returning completely wrong results with filters</span></div></div></div></div><div id=chatlog__message-container-1105650843421790218 class=chatlog__message-container data-message-id=1105650843421790218><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:21â€¯AM">12:21â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>always returning as if no filters were applied</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105651194489217177 class=chatlog__message-container data-message-id=1105651194489217177><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:23â€¯AM"><a href=#chatlog__message-container-1105651194489217177>5/10/2023 12:23â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Oh yea I have not done filtered count row yet <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ¤£"
    title="rofl"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f923.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105651258985033798 class=chatlog__message-container data-message-id=1105651258985033798><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:23â€¯AM"><a href=#chatlog__message-container-1105651258985033798>5/10/2023 12:23â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.to_table()</code> with some trivial columns still gets me the right number of rows i think</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105651452078215168 class=chatlog__message-container data-message-id=1105651452078215168><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:24â€¯AM"><a href=#chatlog__message-container-1105651452078215168>5/10/2023 12:24â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yea . Count rows has a short / cheap implementation by just counting the metadata of each fragment</span></div></div></div></div><div id=chatlog__message-container-1105651516511113276 class=chatlog__message-container data-message-id=1105651516511113276><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:24â€¯AM">12:24â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>If you need . We can deliver it early next week</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105654576159400027 class=chatlog__message-container data-message-id=1105654576159400027><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:36â€¯AM"><a href=#chatlog__message-container-1105654576159400027>5/10/2023 12:36â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/eto-ai/lance/issues/841">https://github.com/eto-ai/lance/issues/841</a> filed for <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">count_rows(expression)</code></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/eto-ai/lance/issues/841><div class="chatlog__markdown chatlog__markdown-preserve">Support <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">count_rows()</code> with filter expression. &#183; Issue #841 &#183; eto-a...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Problem Statement Dataset.count_rows() does quick / cheap calculation of total rows in the dataset. We have not yet implemented the dataset.count_rows(expression). Solution Support Dataset::count_r...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/hmwkr3FUV-wXzj0iXUaTBHYUoj9ythUlCOD3IOofMKM/https/opengraph.githubassets.com/27b3ecbbface8707197a21155dd5e021105b172932f1e4e9c00d411d07bf2eff/eto-ai/lance/issues/841> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/hmwkr3FUV-wXzj0iXUaTBHYUoj9ythUlCOD3IOofMKM/https/opengraph.githubassets.com/27b3ecbbface8707197a21155dd5e021105b172932f1e4e9c00d411d07bf2eff/eto-ai/lance/issues/841 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105655434523717702 class=chatlog__message-container data-message-id=1105655434523717702><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105651516511113276')"> If you need . We can deliver it early next week </span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:39â€¯AM"><a href=#chatlog__message-container-1105655434523717702>5/10/2023 12:39â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>no rush bc the workaround is so easy</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660115371167784 class=chatlog__message-container data-message-id=1105660115371167784><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:58â€¯AM"><a href=#chatlog__message-container-1105660115371167784>5/10/2023 12:58â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hmm seems like in general there&#39;s issues w/<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">binary</code> types in large fragments</span></div></div></div></div><div id=chatlog__message-container-1105660134526570626 class=chatlog__message-container data-message-id=1105660134526570626><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:58â€¯AM">12:58â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ArrowInvalid: C Data interface error: Io error: Execution error: LanceError(I/O): Execution error: LanceError(Arrow): Invalid argument error: null_count 3483 for an array exceeds length of 2230 elements</code></span></div></div></div></div><div id=chatlog__message-container-1105660171050553345 class=chatlog__message-container data-message-id=1105660171050553345><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:58â€¯AM">12:58â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this happens when i add the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">url</code> column to my call</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660294681858088 class=chatlog__message-container data-message-id=1105660294681858088><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:59â€¯AM"><a href=#chatlog__message-container-1105660294681858088>5/10/2023 12:59â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>do you have N/A in url column?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660318174163024 class=chatlog__message-container data-message-id=1105660318174163024><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:59â€¯AM"><a href=#chatlog__message-container-1105660318174163024>5/10/2023 12:59â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this works, but breaks if i uncomment <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">alt</code> or <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">url</code>
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-py">for batch in dataset.to_batches(
    columns=[
        &quot;webp&quot;,
        # &quot;alt&quot;,
        # &quot;url&quot;,
    ],
    filter=filter_expr,
):</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660338029998170 class=chatlog__message-container data-message-id=1105660338029998170><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1105660294681858088')"> do you have N/A in url column? </span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:59â€¯AM"><a href=#chatlog__message-container-1105660338029998170>5/10/2023 12:59â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i don&#39;t think so?</span></div></div></div></div><div id=chatlog__message-container-1105660346397622362 class=chatlog__message-container data-message-id=1105660346397622362><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:59â€¯AM">12:59â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>can check</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660398897746011 class=chatlog__message-container data-message-id=1105660398897746011><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:59â€¯AM"><a href=#chatlog__message-container-1105660398897746011>5/10/2023 12:59â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>alt / url are var-length binary?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660425409937429 class=chatlog__message-container data-message-id=1105660425409937429><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 12:59â€¯AM"><a href=#chatlog__message-container-1105660425409937429>5/10/2023 12:59â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yeah they both are</span></div></div></div></div><div id=chatlog__message-container-1105660444494008390 class=chatlog__message-container data-message-id=1105660444494008390><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:59â€¯AM">12:59â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>actually hmm url seems to be working</span></div></div></div></div><div id=chatlog__message-container-1105660464257564813 class=chatlog__message-container data-message-id=1105660464257564813><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 12:59â€¯AM">12:59â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i bet i have some nulls in alt</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660490371313675 class=chatlog__message-container data-message-id=1105660490371313675><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:00â€¯AM"><a href=#chatlog__message-container-1105660490371313675>5/10/2023 1:00â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>alt sounds like nulls lol</span></div></div></div></div><div id=chatlog__message-container-1105660593177890887 class=chatlog__message-container data-message-id=1105660593177890887><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:00â€¯AM">1:00â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i can write some tests to verify var-length binary / strings</span></div></div></div></div><div id=chatlog__message-container-1105660623683063948 class=chatlog__message-container data-message-id=1105660623683063948><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:00â€¯AM">1:00â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>tonight</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660663235354654 class=chatlog__message-container data-message-id=1105660663235354654><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:00â€¯AM"><a href=#chatlog__message-container-1105660663235354654>5/10/2023 1:00â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yep there are nulls in alt</span></div></div></div></div><div id=chatlog__message-container-1105660679144353992 class=chatlog__message-container data-message-id=1105660679144353992><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:00â€¯AM">1:00â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i should add a filter ig</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105660772203372624 class=chatlog__message-container data-message-id=1105660772203372624><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:01â€¯AM"><a href=#chatlog__message-container-1105660772203372624>5/10/2023 1:01â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>no worries, this should be a regression, we did support null before. so bug fix wont be too big</span></div></div></div></div><div id=chatlog__message-container-1105661376724205598 class=chatlog__message-container data-message-id=1105661376724205598><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:03â€¯AM">1:03â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>thanks for debugging with us patiently tho.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105661507917852682 class=chatlog__message-container data-message-id=1105661507917852682><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:04â€¯AM"><a href=#chatlog__message-container-1105661507917852682>5/10/2023 1:04â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>heh tried adding a filter</span></div></div></div></div><div id=chatlog__message-container-1105661527287156837 class=chatlog__message-container data-message-id=1105661527287156837><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:04â€¯AM">1:04â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ValueError: LanceError(I/O): function &#39;true_unless_null&#39; is not supported</code></span></div></div></div></div><div id=chatlog__message-container-1105661698699972668 class=chatlog__message-container data-message-id=1105661698699972668><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:04â€¯AM">1:04â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>tried to add <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">~ pc.is_null(pc.field(&quot;alt&quot;))</code></span></div></div></div></div><div id=chatlog__message-container-1105661708804042802 class=chatlog__message-container data-message-id=1105661708804042802><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:04â€¯AM">1:04â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ValueError: LanceError(I/O): function &#39;invert&#39; is not supported</code></span></div></div></div></div><div id=chatlog__message-container-1105662013641859123 class=chatlog__message-container data-message-id=1105662013641859123><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:06â€¯AM">1:06â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this is a blocker for me</span> <span class=chatlog__edited-timestamp title="Wednesday, May 10, 2023 1:06â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105662035385122927 class=chatlog__message-container data-message-id=1105662035385122927><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:06â€¯AM"><a href=#chatlog__message-container-1105662035385122927>5/10/2023 1:06â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh , yea we only support &gt;&lt;= is_in now .   These twos are needed</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105662043673067540 class=chatlog__message-container data-message-id=1105662043673067540><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:06â€¯AM"><a href=#chatlog__message-container-1105662043673067540>5/10/2023 1:06â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>but might be the last one!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105662057954693250 class=chatlog__message-container data-message-id=1105662057954693250><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:06â€¯AM"><a href=#chatlog__message-container-1105662057954693250>5/10/2023 1:06â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ok</span></div></div></div></div><div id=chatlog__message-container-1105662102825357373 class=chatlog__message-container data-message-id=1105662102825357373><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:06â€¯AM">1:06â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Will have that in today &amp; tmr</span></div></div></div></div><div id=chatlog__message-container-1105662239698059334 class=chatlog__message-container data-message-id=1105662239698059334><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:07â€¯AM">1:07â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Nulls and these two functions, right ?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105663526116278402 class=chatlog__message-container data-message-id=1105663526116278402><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:12â€¯AM"><a href=#chatlog__message-container-1105663526116278402>5/10/2023 1:12â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yeah, I&#39;d also appreciate <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">binary_length</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105663818597679124 class=chatlog__message-container data-message-id=1105663818597679124><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:13â€¯AM"><a href=#chatlog__message-container-1105663818597679124>5/10/2023 1:13â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>kk.  Got it</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105663975049400383 class=chatlog__message-container data-message-id=1105663975049400383><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:13â€¯AM"><a href=#chatlog__message-container-1105663975049400383>5/10/2023 1:13â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>can make a more complete list of &quot;nice to have&quot; functions at some point</span></div></div></div></div><div id=chatlog__message-container-1105664053323509850 class=chatlog__message-container data-message-id=1105664053323509850><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:14â€¯AM">1:14â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>basically want to move as much of my logic as possible out of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">tf.data</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105664288582013048 class=chatlog__message-container data-message-id=1105664288582013048><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:15â€¯AM"><a href=#chatlog__message-container-1105664288582013048>5/10/2023 1:15â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><img
    loading="lazy"
    class="chatlog__emoji chatlog__emoji--large"
    alt="ðŸ‘"
    title="thumbsup"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg"></span></div></div></div></div><div id=chatlog__message-container-1105664441242107984 class=chatlog__message-container data-message-id=1105664441242107984><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 1:15â€¯AM">1:15â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We can totally do a bunch of Opencv functions as well</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105666225448693860 class=chatlog__message-container data-message-id=1105666225448693860><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:22â€¯AM"><a href=#chatlog__message-container-1105666225448693860>5/10/2023 1:22â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i guess you&#39;d add some more general compute expressions for adding/updating columns?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105669480471875644 class=chatlog__message-container data-message-id=1105669480471875644><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 1:35â€¯AM"><a href=#chatlog__message-container-1105669480471875644>5/10/2023 1:35â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yes that&#39;s true. we could support all underneath runtime support (DataFusion), and need to figure out some mechanism to make more heavy compute expression to be optional / pluggable, to prevent feature bloat of lance core format. 

Would be interesting to figure out  where  we show draw the line as <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance core</code> vs <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance plugin</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105993420553601054 class=chatlog__message-container data-message-id=1105993420553601054><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 11:02â€¯PM"><a href=#chatlog__message-container-1105993420553601054>5/10/2023 11:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">TypeError: cannot pickle &#39;_lib._FragmentMetadata&#39; object</code></span></div></div></div></div><div id=chatlog__message-container-1105993638321848381 class=chatlog__message-container data-message-id=1105993638321848381><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 11:03â€¯PM">11:03â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>attempting to serialize the output of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance.fragment.LanceFragment.create</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105994234596691980 class=chatlog__message-container data-message-id=1105994234596691980><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 11:06â€¯PM"><a href=#chatlog__message-container-1105994234596691980>5/10/2023 11:06â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><img
    loading="lazy"
    class="chatlog__emoji chatlog__emoji--large"
    alt="ðŸ‘€"
    title="eyes"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105994348081987724 class=chatlog__message-container data-message-id=1105994348081987724><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 11:06â€¯PM"><a href=#chatlog__message-container-1105994348081987724>5/10/2023 11:06â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I think this is the final blocker on running distributed dataset conversion</span></div></div></div></div><div id=chatlog__message-container-1105994379329548341 class=chatlog__message-container data-message-id=1105994379329548341><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 11:06â€¯PM">11:06â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I have the rest of the plumbing assembled</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105994575593619557 class=chatlog__message-container data-message-id=1105994575593619557><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 11:07â€¯PM"><a href=#chatlog__message-container-1105994575593619557>5/10/2023 11:07â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>lemme ask <span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span> who is pickle wizard</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105996639589634079 class=chatlog__message-container data-message-id=1105996639589634079><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 11:15â€¯PM"><a href=#chatlog__message-container-1105996639589634079>5/10/2023 11:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>At a conf rn but Iâ€™ll take a look tonight. Rust data structures arenâ€™t natively picklable. So weâ€™ll just need to either save some state in python or implement  it in pyo3.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105997463518728194 class=chatlog__message-container data-message-id=1105997463518728194><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 11:19â€¯PM"><a href=#chatlog__message-container-1105997463518728194>5/10/2023 11:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I am not attached to using pickle here</span></div></div></div></div><div id=chatlog__message-container-1105997601272238182 class=chatlog__message-container data-message-id=1105997601272238182><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 10, 2023 11:19â€¯PM">11:19â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>just need some kind of serialization so that I can use the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">LanceFragment.create</code> + <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">LanceDataset._commit</code> API</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105998286294372352 class=chatlog__message-container data-message-id=1105998286294372352><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 11:22â€¯PM"><a href=#chatlog__message-container-1105998286294372352>5/10/2023 11:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>it is ok, we can make it pickable by EOD. i need to run some family duty now.  is it ok to get this done by EOD today?  <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">FragmentMetadata</code> internal state is just a protobuf struct. should be straightforward</span> <span class=chatlog__edited-timestamp title="Wednesday, May 10, 2023 11:22â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1105998517723463741 class=chatlog__message-container data-message-id=1105998517723463741><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Wednesday, May 10, 2023 11:23â€¯PM"><a href=#chatlog__message-container-1105998517723463741>5/10/2023 11:23â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yeah np</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1106091709475074128 class=chatlog__message-container data-message-id=1106091709475074128><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Thursday, May 11, 2023 5:33â€¯AM"><a href=#chatlog__message-container-1106091709475074128>5/11/2023 5:33â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="theseriousadult">@jack</span> 0.4.9 is up, fixed fragment pickling , and exposed Fragment::schema()</span></div></div></div></div><div id=chatlog__message-container-1106091759089500250 class=chatlog__message-container data-message-id=1106091759089500250><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, May 11, 2023 5:33â€¯AM">5:33â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>pls give a try when you have time</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1106233517890875393 class=chatlog__message-container data-message-id=1106233517890875393><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Thursday, May 11, 2023 2:57â€¯PM"><a href=#chatlog__message-container-1106233517890875393>5/11/2023 2:57â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>will do, thanks for quick turnaround!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1106251683224371291 class=chatlog__message-container data-message-id=1106251683224371291><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1106091709475074128')"> <span class="chatlog__markdown-mention" title="theseriousadult">@jack</span> 0.4.9 is up, fixed fragment pickling , and exposed Fragment::schema() </span></div></div><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Thursday, May 11, 2023 4:09â€¯PM"><a href=#chatlog__message-container-1106251683224371291>5/11/2023 4:09â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>seems like it&#39;s working so far!</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=muscle><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ’ª src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f4aa.svg loading=lazy> <span class=chatlog__reaction-count>2</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1106264840277860402 class=chatlog__message-container data-message-id=1106264840277860402><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/353691560090664982/9a2912e0e6fba1b9a9451c26f94b0259.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=theseriousadult data-user-id=353691560090664982>jack</span> <span class=chatlog__timestamp title="Thursday, May 11, 2023 5:01â€¯PM"><a href=#chatlog__message-container-1106264840277860402>5/11/2023 5:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yep it works, wrote a bunch of fragments then committed the dataset without passing any state from the writing process to the committing process</span></div></div></div></div><div id=chatlog__message-container-1106264907495788654 class=chatlog__message-container data-message-id=1106264907495788654><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, May 11, 2023 5:01â€¯PM">5:01â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>and resulting dataset iterates just like it should</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=partying_face><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ¥³ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f973.svg loading=lazy> <span class=chatlog__reaction-count>2</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110273942616297573 class=chatlog__message-container data-message-id=1110273942616297573><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Monday, May 22, 2023 6:32â€¯PM"><a href=#chatlog__message-container-1110273942616297573>5/22/2023 6:32â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It seems like <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">offset</code> is broken when using the vector index?
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">    results = ds.to_table(
        columns=columns,
        filter=filters,
        # uncommenting the following line fails silently
        # and returns zero results
        # offset=0,
        nearest={
            &quot;column&quot;: &quot;vector&quot;,
            &quot;q&quot;: query,
            &quot;k&quot;: topk,
            &quot;nprobes&quot;: nprobes,
            &quot;refine_factor&quot;: rf,
            &quot;use_index&quot;: use_index,
        },
    )</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110274675063406723 class=chatlog__message-container data-message-id=1110274675063406723><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=chrisemoody>chrisemoody</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1110273942616297573')"> It seems like <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">offset</code> is broken when using the vector index?
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">    results = ds.to_table(
        columns=columns,
        filter=filters,
        # uncommenting the following line fails silently
        # and returns zero results
        # offset=0,
        nearest={
            &quot;column&quot;: &quot;vector&quot;,
            &quot;q&quot;: query,
            &quot;k&quot;: topk,
            &quot;nprobes&quot;: nprobes,
            &quot;refine_factor&quot;: rf,
            &quot;use_index&quot;: use_index,
        },
    )</code> </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Monday, May 22, 2023 6:35â€¯PM"><a href=#chatlog__message-container-1110274675063406723>5/22/2023 6:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Oh, I see, you need to specify a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">limit</code>. Confusing. Can I suggest: this should probably raise  an error when <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">offset</code> is specified but <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">limit</code> is not.</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110276013860069496 class=chatlog__message-container data-message-id=1110276013860069496><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=chrisemoody>chrisemoody</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1110274675063406723')"> Oh, I see, you need to specify a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">limit</code>. Confusing. Can I suggest: this should probably raise  an error when <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">offset</code> is specified but <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">limit</code> is not. </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Monday, May 22, 2023 6:40â€¯PM"><a href=#chatlog__message-container-1110276013860069496>5/22/2023 6:40â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks for the pointing that out. I agree it should probably error. Right now it just uses a default limit of zero, which isn&#39;t very useful!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110276290180812870 class=chatlog__message-container data-message-id=1110276290180812870><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1110276013860069496')"> Thanks for the pointing that out. I agree it should probably error. Right now it just uses a default limit of zero, which isn&#39;t very useful! </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Monday, May 22, 2023 6:41â€¯PM"><a href=#chatlog__message-container-1110276290180812870>5/22/2023 6:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yep! Setting limit=0 by default looks more like &#39;silently failing&#39;</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110276613905584188 class=chatlog__message-container data-message-id=1110276613905584188><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Monday, May 22, 2023 6:42â€¯PM"><a href=#chatlog__message-container-1110276613905584188>5/22/2023 6:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Tracking here: <a href="https://github.com/eto-ai/lance/issues/891">https://github.com/eto-ai/lance/issues/891</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/eto-ai/lance/issues/891><div class="chatlog__markdown chatlog__markdown-preserve">Return error if offset is set but not limit &#183; Issue #891 &#183; eto-ai/l...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Right now we default to limit zero if offset is set, but that&#39;s not very useful. lance/rust/src/dataset/scanner.rs Line 596 in 8902a74 *self.offset.as_ref().unwrap_or(&amp;0) as usize,</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/WJQSfUrRBfg5zVYQhZSJS2erbI1aa9G89v29z4SemX4/https/opengraph.githubassets.com/ff4eb82d5e3975d672366577f130c158d4bc63b745ee8532b95594a8c380071f/eto-ai/lance/issues/891> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/WJQSfUrRBfg5zVYQhZSJS2erbI1aa9G89v29z4SemX4/https/opengraph.githubassets.com/ff4eb82d5e3975d672366577f130c158d4bc63b745ee8532b95594a8c380071f/eto-ai/lance/issues/891 alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110337070330822727 class=chatlog__message-container data-message-id=1110337070330822727><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Monday, May 22, 2023 10:43â€¯PM"><a href=#chatlog__message-container-1110337070330822727>5/22/2023 10:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> FYI we solved that issue by instead allowing you to pass an offset without any limit, in case all you wanted was to skip some rows. Is that something you want to do, or are you setting limit anyways?</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=ðŸ«¡><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ«¡ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1fae1.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110348916815302687 class=chatlog__message-container data-message-id=1110348916815302687><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1110337070330822727')"> <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> FYI we solved that issue by instead allowing you to pass an offset without any limit, in case all you wanted was to skip some rows. Is that something you want to do, or are you setting limit anyways? </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Monday, May 22, 2023 11:30â€¯PM"><a href=#chatlog__message-container-1110348916815302687>5/22/2023 11:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>That works!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110369862427082824 class=chatlog__message-container data-message-id=1110369862427082824><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 12:53â€¯AM"><a href=#chatlog__message-container-1110369862427082824>5/23/2023 12:53â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the fix is released <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=heart_eyes_cat><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ˜» src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f63b.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110425949989773333 class=chatlog__message-container data-message-id=1110425949989773333><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 4:36â€¯AM"><a href=#chatlog__message-container-1110425949989773333>5/23/2023 4:36â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m trying to paginate through search results, but I&#39;m getting a bug with the same row appearing in consecutive pages. For example:

<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ds.to_table(columns=[&#39;id&#39;], offset=0, limit=100, nearest=dict(column=&#39;vector&#39;, q=query, k=100)</code>

contains a few rows from the next page:

<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ds.to_table(columns=[&#39;id&#39;], offset=100, limit=100, nearest=dict(column=&#39;vector&#39;, q=query, k=200)</code>

I suspect this is because <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">nearest</code> is doing a partial sort; e.g it finds the top k=100 but doesn&#39;t sort within that. How should I make pagination work?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110591377126981712 class=chatlog__message-container data-message-id=1110591377126981712><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 3:33â€¯PM"><a href=#chatlog__message-container-1110591377126981712>5/23/2023 3:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It seems to be a bug. Letâ€™s look into it today</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110604453003931759 class=chatlog__message-container data-message-id=1110604453003931759><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1110591377126981712')"> It seems to be a bug. Letâ€™s look into it today </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 4:25â€¯PM"><a href=#chatlog__message-container-1110604453003931759>5/23/2023 4:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks! Let me know if i can help in repro&#39;ing it</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110609034987442287 class=chatlog__message-container data-message-id=1110609034987442287><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 4:43â€¯PM"><a href=#chatlog__message-container-1110609034987442287>5/23/2023 4:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>looked into it a bit more. This is more a current restriction on our I/O path.  So for IVF_PQ index, it does a merge sort, first, it find top-k in each partition (of nprobs), and later it does a merge sort of the k vectors from each of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">nprobs</code> partitions.

When you set k=100 and later k=200, they will result in different sorted order among partitions. Even so if <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">refine_factor</code> is set.

A quick workaround would be set <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">k</code> the same when you do pagenations.  <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span>  

let us know if setting k as the same will occur much higher latency, we need do some design in I/O exec plan to counter that.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110609662262390804 class=chatlog__message-container data-message-id=1110609662262390804><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1110609034987442287')"> looked into it a bit more. This is more a current restriction on our I/O path.  So for IVF_PQ index, it does a merge sort, first, it find top-k in each partition (of nprobs), and later it does a merge sort of the k vectors from each of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">nprobs</code> partitions.

When you set k=100 and later k=200, they will result in different sorted order among partitions. Even so if <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">refine_factor</code> is set.

A quick workaround would be set <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">k</code> the same when you do pagenations.  <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span>  

let us know if setting k as the same will occur much higher latency, we need do some design in I/O exec plan to counter that. </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 4:46â€¯PM"><a href=#chatlog__message-container-1110609662262390804>5/23/2023 4:46â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hmm, i can&#39;t really set the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">k</code> to be large enough in advance because it is driving an infinite scroll loop, so <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">k</code> gets progressively bigger, with no real bound.

but maybe for now I&#39;ll just set k to 50% higher than the request and hope i don&#39;t see too many individual repeats</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110611505243754497 class=chatlog__message-container data-message-id=1110611505243754497><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 4:53â€¯PM"><a href=#chatlog__message-container-1110611505243754497>5/23/2023 4:53â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>we will figure out some fix in long term</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110617410257551450 class=chatlog__message-container data-message-id=1110617410257551450><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 5:17â€¯PM"><a href=#chatlog__message-container-1110617410257551450>5/23/2023 5:17â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Long term fix should prolly be pushing the offset parameter into the KNN/ANN exec node</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1110623578040307793 class=chatlog__message-container data-message-id=1110623578040307793><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Tuesday, May 23, 2023 5:41â€¯PM"><a href=#chatlog__message-container-1110623578040307793>5/23/2023 5:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>That would be awesome!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1111053492128333875 class=chatlog__message-container data-message-id=1111053492128333875><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/780980166976602174/f62bb84529b812e284f007f50304a104.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gjreda data-user-id=780980166976602174>gjreda</span> <span class=chatlog__timestamp title="Wednesday, May 24, 2023 10:09â€¯PM"><a href=#chatlog__message-container-1111053492128333875>5/24/2023 10:09â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi all - heads up that link the in &quot;About&quot; section on the right side bar is broken: <a href="https://github.com/lancedb/lance">https://github.com/lancedb/lance</a></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1111053737327337493 class=chatlog__message-container data-message-id=1111053737327337493><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 24, 2023 10:10â€¯PM"><a href=#chatlog__message-container-1111053737327337493>5/24/2023 10:10â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ah, we moved the repo this morning. it seems the github page was not moved</span></div></div></div></div><div id=chatlog__message-container-1111053828150792313 class=chatlog__message-container data-message-id=1111053828150792313><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 24, 2023 10:11â€¯PM">10:11â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>moved <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">eto-ai/lance</code> to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lancedb/lance</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1111053908006150286 class=chatlog__message-container data-message-id=1111053908006150286><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/780980166976602174/f62bb84529b812e284f007f50304a104.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gjreda data-user-id=780980166976602174>gjreda</span> <span class=chatlog__timestamp title="Wednesday, May 24, 2023 10:11â€¯PM"><a href=#chatlog__message-container-1111053908006150286>5/24/2023 10:11â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ahh makes sense</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1111054055163314227 class=chatlog__message-container data-message-id=1111054055163314227><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, May 24, 2023 10:12â€¯PM"><a href=#chatlog__message-container-1111054055163314227>5/24/2023 10:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://lancedb.github.io/lance/">https://lancedb.github.io/lance/</a> accessible here</span></div></div></div></div><div id=chatlog__message-container-1111054093713162290 class=chatlog__message-container data-message-id=1111054093713162290><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 24, 2023 10:12â€¯PM">10:12â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>lemme update the link in About</span></div></div></div></div><div id=chatlog__message-container-1111054240396353567 class=chatlog__message-container data-message-id=1111054240396353567><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, May 24, 2023 10:12â€¯PM">10:12â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>thanks for reporting to us <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™"
    title="pray"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg"></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114212176488562718 class=chatlog__message-container data-message-id=1114212176488562718><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/229087573669052418/8de2846e83ce16cc6a2ed46ff1b6aa23.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.cvr data-user-id=229087573669052418>cvr</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 3:21â€¯PM"><a href=#chatlog__message-container-1114212176488562718>6/2/2023 3:21â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>randomly get this error here</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1114212176253685851/image.png?ex=6989fb73&amp;is=6988a9f3&amp;hm=9d8afb4000bc287f296979e058bf4d84148603538bdfccc2b90a1756d6df5f7d&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1114212176253685851/image.png?ex=6989fb73&amp;is=6988a9f3&amp;hm=9d8afb4000bc287f296979e058bf4d84148603538bdfccc2b90a1756d6df5f7d&amp;" alt="Image attachment" title="Image: image.png (81.29 KB)" loading=lazy> </a></div></div></div></div><div id=chatlog__message-container-1114212279928492135 class=chatlog__message-container data-message-id=1114212279928492135><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, June 2, 2023 3:21â€¯PM">3:21â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>seems to happen indeterministically, while processing large files of embeddings and adding them to the db</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114219218410426529 class=chatlog__message-container data-message-id=1114219218410426529><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=majestic_raccoon_31617 data-user-id=1073376390075908126>gc</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 3:49â€¯PM"><a href=#chatlog__message-container-1114219218410426529>6/2/2023 3:49â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>approximately how many records are you adding on each chunk?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114219420861087745 class=chatlog__message-container data-message-id=1114219420861087745><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/229087573669052418/8de2846e83ce16cc6a2ed46ff1b6aa23.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.cvr data-user-id=229087573669052418>cvr</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 3:50â€¯PM"><a href=#chatlog__message-container-1114219420861087745>6/2/2023 3:50â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>500</span></div></div></div></div><div id=chatlog__message-container-1114219678903058542 class=chatlog__message-container data-message-id=1114219678903058542><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, June 2, 2023 3:51â€¯PM">3:51â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>but i add the total amounts, so I actually add 500*n at once</span></div></div></div></div><div id=chatlog__message-container-1114219829407256637 class=chatlog__message-container data-message-id=1114219829407256637><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, June 2, 2023 3:51â€¯PM">3:51â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>some are as many as 63 chunks, while others are as little as 3 chunks and it fails at the smaller one which is why it seems indeterministic</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114220412348412034 class=chatlog__message-container data-message-id=1114220412348412034><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=majestic_raccoon_31617 data-user-id=1073376390075908126>gc</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 3:54â€¯PM"><a href=#chatlog__message-container-1114220412348412034>6/2/2023 3:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>interesting. is the anything you can share about the data model? the fields, their types and so on</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114221085181890603 class=chatlog__message-container data-message-id=1114221085181890603><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/229087573669052418/8de2846e83ce16cc6a2ed46ff1b6aa23.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.cvr data-user-id=229087573669052418>cvr</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 3:56â€¯PM"><a href=#chatlog__message-container-1114221085181890603>6/2/2023 3:56â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>sure <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">const data = paragraphs.map((paragraph) =&gt; ({
      vector: paragraph.embedding,
      id: paragraph.refcode_short,
      content: paragraph.content,
      longId: paragraph.refcode_long,
    }));</code> where <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight"> type Data = {vector: number[], id: string, content: string, longId: string }</code></span></div></div></div></div><div id=chatlog__message-container-1114221163514691685 class=chatlog__message-container data-message-id=1114221163514691685><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, June 2, 2023 3:57â€¯PM">3:57â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the vectors are from OpenAI text-ada-002 model</span></div></div></div></div><div id=chatlog__message-container-1114221246465450154 class=chatlog__message-container data-message-id=1114221246465450154><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, June 2, 2023 3:57â€¯PM">3:57â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the content varies in length, but is generally a few kbs</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114222540366291046 class=chatlog__message-container data-message-id=1114222540366291046><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=majestic_raccoon_31617 data-user-id=1073376390075908126>gc</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 4:02â€¯PM"><a href=#chatlog__message-container-1114222540366291046>6/2/2023 4:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>that&#39;s a pretty simple data model, let me try to reproduce it</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114222667713761362 class=chatlog__message-container data-message-id=1114222667713761362><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 4:03â€¯PM"><a href=#chatlog__message-container-1114222667713761362>6/2/2023 4:03â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vector</code> ever missing or empty?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114223048153890987 class=chatlog__message-container data-message-id=1114223048153890987><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/229087573669052418/8de2846e83ce16cc6a2ed46ff1b6aa23.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.cvr data-user-id=229087573669052418>cvr</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 4:04â€¯PM"><a href=#chatlog__message-container-1114223048153890987>6/2/2023 4:04â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>no, there are failsafes that interrupt the process if the embedding ever fails</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114234240347930674 class=chatlog__message-container data-message-id=1114234240347930674><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=majestic_raccoon_31617 data-user-id=1073376390075908126>gc</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 4:49â€¯PM"><a href=#chatlog__message-container-1114234240347930674>6/2/2023 4:49â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title=".cvr">@cvr</span> I created a gist that inserts ~ 6GB  of data in batches, but was unable to reproduce the issue: <a href="https://gist.github.com/gsilvestrin/b04d5a4688af5197652ea4fd0bfe8465">https://gist.github.com/gsilvestrin/b04d5a4688af5197652ea4fd0bfe8465</a></span></div></div></div></div><div id=chatlog__message-container-1114234936602415217 class=chatlog__message-container data-message-id=1114234936602415217><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, June 2, 2023 4:51â€¯PM">4:51â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>but if I try to insert a record with a 0 length vector, then I see the error message &quot;&#39;&lt;unnamed&gt;&#39; panicked at &#39;attempt to divide by zero&#39;,&quot; We should improve our error message here, but the most likely scenario is that a record has a missing / 0-length vector</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114334265979699303 class=chatlog__message-container data-message-id=1114334265979699303><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 11:26â€¯PM"><a href=#chatlog__message-container-1114334265979699303>6/2/2023 11:26â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m building a Lance index right now, but I don&#39;t know how long to keep it running. You can see that it uses ~50 cores for three hours, but the for the last three hours I haven&#39;t gotten any logs. The memory is slowly climbing (not a problem) but I&#39;m worried that if it hits the 24 hour mark the index build will fail. Do y&#39;all think this is worth keeping going? Would be nice to get more frequent feedback to know what its progress is, and that it is at least alive and well</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1114334266139103262/image.png?ex=698a6d28&amp;is=69891ba8&amp;hm=c971b534d86417bfbcb687fa03f1cb82d328c253aa5db284bd9cbb6cd4d212b6&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1114334266139103262/image.png?ex=698a6d28&amp;is=69891ba8&amp;hm=c971b534d86417bfbcb687fa03f1cb82d328c253aa5db284bd9cbb6cd4d212b6&amp;" alt="Image attachment" title="Image: image.png (189.77 KB)" loading=lazy> </a></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1114334266462056488/image.png?ex=698a6d28&amp;is=69891ba8&amp;hm=054df9b17d0d3dda5a545a7988ce2d8fb1202c1f9386637aba610e64e53b4ca3&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1114334266462056488/image.png?ex=698a6d28&amp;is=69891ba8&amp;hm=054df9b17d0d3dda5a545a7988ce2d8fb1202c1f9386637aba610e64e53b4ca3&amp;" alt="Image attachment" title="Image: image.png (334.5 KB)" loading=lazy> </a></div></div></div></div><div id=chatlog__message-container-1114334433105956944 class=chatlog__message-container data-message-id=1114334433105956944><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, June 2, 2023 11:27â€¯PM">11:27â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>How long would y&#39;all expect a IVF4096PQ192 index to build with 30Mx1600D vectors on 50 cores?</span> <span class=chatlog__edited-timestamp title="Friday, June 2, 2023 11:27â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114334611351277640 class=chatlog__message-container data-message-id=1114334611351277640><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/250905565566468096/3b22e019f5d0af3ded36462597628156.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chopsjx data-user-id=250905565566468096>chop</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 11:27â€¯PM"><a href=#chatlog__message-container-1114334611351277640>6/2/2023 11:27â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Tracking this request here: <a href="https://github.com/lancedb/lance/issues/855">https://github.com/lancedb/lance/issues/855</a> hopefully we can get to this soon!</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/855><div class="chatlog__markdown chatlog__markdown-preserve">Add logging for index generation &#183; Issue #855 &#183; lancedb/lance</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">We currently don&#39;t have a verbose mode where you can log out ongoing status during index generation. For very large datasets/parameters where indexing takes a long time, it is a black box</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/ixrTsX1GNDlHR7ODAvDxg7uqWUUor2tqpbfh0S-7Aeo/https/opengraph.githubassets.com/75d58d96a6e68ed77764ac41019d7ef0d1f6412f859f1bc593a7876dbc621f4b/lancedb/lance/issues/855> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/ixrTsX1GNDlHR7ODAvDxg7uqWUUor2tqpbfh0S-7Aeo/https/opengraph.githubassets.com/75d58d96a6e68ed77764ac41019d7ef0d1f6412f859f1bc593a7876dbc621f4b/lancedb/lance/issues/855 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114337832052461629 class=chatlog__message-container data-message-id=1114337832052461629><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Friday, June 2, 2023 11:40â€¯PM"><a href=#chatlog__message-container-1114337832052461629>6/2/2023 11:40â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> i have not build such a big index on one machine before. what was your last success run on another scale, we might be able to get an estimation giving the time complexity as <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">O(IVF ^ 2 + PQ)</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114594739719778354 class=chatlog__message-container data-message-id=1114594739719778354><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/250905565566468096/3b22e019f5d0af3ded36462597628156.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=chopsjx>chop</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1114334611351277640')"> Tracking this request here: <a href="https://github.com/lancedb/lance/issues/855">https://github.com/lancedb/lance/issues/855</a> hopefully we can get to this soon! </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, June 3, 2023 4:41â€¯PM"><a href=#chatlog__message-container-1114594739719778354>6/3/2023 4:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thank you! Will help a ton</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114595003189182505 class=chatlog__message-container data-message-id=1114595003189182505><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1114337832052461629')"> <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> i have not build such a big index on one machine before. what was your last success run on another scale, we might be able to get an estimation giving the time complexity as <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">O(IVF ^ 2 + PQ)</code> </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, June 3, 2023 4:42â€¯PM"><a href=#chatlog__message-container-1114595003189182505>6/3/2023 4:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ok thatâ€™s useful! It ended up taking about 12 hours total.  Re: scaling, how does it scale with dataset size? Hopefully linear? Eg if i double the number of vectors itâ€™ll take maybe 24 hours?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1114600006163370034 class=chatlog__message-container data-message-id=1114600006163370034><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Saturday, June 3, 2023 5:02â€¯PM"><a href=#chatlog__message-container-1114600006163370034>6/3/2023 5:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the major factor will be the IVF because we do sampling of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">IVF * 256</code> rows to run kmeans. , dimension also comes to play as it is linear to calculate the distance between a pair of vectors, <span class="chatlog__markdown-mention" title="chebbychefneq">@Rob Meng</span> is looking into some kmean optimizations in the coming weeks.  Also PQ will decide how many subsect kmeans to run . So more PQ more time</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1115272254348071043 class=chatlog__message-container data-message-id=1115272254348071043><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1114600006163370034')"> the major factor will be the IVF because we do sampling of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">IVF * 256</code> rows to run kmeans. , dimension also comes to play as it is linear to calculate the distance between a pair of vectors, <span class="chatlog__markdown-mention" title="chebbychefneq">@Rob Meng</span> is looking into some kmean optimizations in the coming weeks.  Also PQ will decide how many subsect kmeans to run . So more PQ more time </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Monday, June 5, 2023 1:33â€¯PM"><a href=#chatlog__message-container-1115272254348071043>6/5/2023 1:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Would it be possible to both set and retrieve the IVF means? That could allow me to save and reuse  the means from a previous index build. Also could let me experiment with trying GPU-based kmeans. Both would let me accelerate the train index step</span> <span class=chatlog__edited-timestamp title="Monday, June 5, 2023 1:34â€¯PM">(edited)</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1115302463277367506 class=chatlog__message-container data-message-id=1115302463277367506><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Monday, June 5, 2023 3:33â€¯PM"><a href=#chatlog__message-container-1115302463277367506>6/5/2023 3:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yea it sounds a good workaround. Let me create an issue and plan on it today</span></div></div></div></div><div id=chatlog__message-container-1115302566985728000 class=chatlog__message-container data-message-id=1115302566985728000><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, June 5, 2023 3:34â€¯PM">3:34â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Short answer is yes ofc <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ«¡"
    title="ðŸ«¡"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1fae1.svg"></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=tada><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸŽ‰ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f389.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1115517206168604672 class=chatlog__message-container data-message-id=1115517206168604672><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/452689824646823937/9772e252c687b7ca65de083c259c22b8.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=leozc data-user-id=452689824646823937>leozc</span> <span class=chatlog__timestamp title="Tuesday, June 6, 2023 5:47â€¯AM"><a href=#chatlog__message-container-1115517206168604672>6/6/2023 5:47â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Can <span class="chatlog__markdown-mention" title="lei.xu">@lei</span> help on repo this? I am blocked by the segfault issue.
<a href="https://github.com/lancedb/lancedb/issues/127">https://github.com/lancedb/lancedb/issues/127</a> <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™‚"
    title="slight_smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f642.svg"></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/127><div class="chatlog__markdown chatlog__markdown-preserve">DuckDB crashed when reading the database &#183; Issue #127 &#183; lancedb/lan...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Please see the code in <a href="https://github.com/leozc/lanceGraph/blob/main/testme.py">https://github.com/leozc/lanceGraph/blob/main/testme.py</a> python testme.py # create the db python testme.py # read the DB &lt;-- crashed in duckdb Tried and tested on different...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/mwGtmnYCbHGKQgtR-OAZ-9FogrFNDq1yqlKDjG3cYbI/https/opengraph.githubassets.com/6f268bc9675158edfa14ef6e8eddd3d8a2f3446d812e0b685367f8fc9a427bda/lancedb/lancedb/issues/127> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/mwGtmnYCbHGKQgtR-OAZ-9FogrFNDq1yqlKDjG3cYbI/https/opengraph.githubassets.com/6f268bc9675158edfa14ef6e8eddd3d8a2f3446d812e0b685367f8fc9a427bda/lancedb/lancedb/issues/127 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116001750835527760 class=chatlog__message-container data-message-id=1116001750835527760><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/844187556006723585/3533e954aaedc64015f7352ab0c51058.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=maxlin0507 data-user-id=844187556006723585>MaxLin</span> <span class=chatlog__timestamp title="Wednesday, June 7, 2023 1:52â€¯PM"><a href=#chatlog__message-container-1116001750835527760>6/7/2023 1:52â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://lancedb.github.io/lancedb/integrations/">https://lancedb.github.io/lancedb/integrations/</a></span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1116001750877474866/image.png?ex=6989e69f&amp;is=6988951f&amp;hm=015592d148d26e903866fb40816632ea0ed0f44f1e7d3952ddb3c96b6a07c842&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1116001750877474866/image.png?ex=6989e69f&amp;is=6988951f&amp;hm=015592d148d26e903866fb40816632ea0ed0f44f1e7d3952ddb3c96b6a07c842&amp;" alt="Image attachment" title="Image: image.png (108.72 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116027100525240391 class=chatlog__message-container data-message-id=1116027100525240391><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Wednesday, June 7, 2023 3:33â€¯PM"><a href=#chatlog__message-container-1116027100525240391>6/7/2023 3:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Whatâ€™s the error that you get?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116028691332485151 class=chatlog__message-container data-message-id=1116028691332485151><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/844187556006723585/3533e954aaedc64015f7352ab0c51058.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=maxlin0507 data-user-id=844187556006723585>MaxLin</span> <span class=chatlog__timestamp title="Wednesday, June 7, 2023 3:39â€¯PM"><a href=#chatlog__message-container-1116028691332485151>6/7/2023 3:39â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the db is hosted on the GCS, and I process the sample code, then the ERROR message: 
OSError: LanceError(Index): KMeans: can not train 256 centroids with 2 vectors, choose a smaller K (&lt; 2) instead</span> <span class=chatlog__edited-timestamp title="Wednesday, June 7, 2023 3:39â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116031377314414715 class=chatlog__message-container data-message-id=1116031377314414715><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Wednesday, June 7, 2023 3:50â€¯PM"><a href=#chatlog__message-container-1116031377314414715>6/7/2023 3:50â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yeah sorry thatâ€™s a problem with our documentation. In the example it only has 2 vectors which is too small of a dataset to train the index. For that dataset you donâ€™t need to create an index.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116033808928604190 class=chatlog__message-container data-message-id=1116033808928604190><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/844187556006723585/3533e954aaedc64015f7352ab0c51058.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=maxlin0507 data-user-id=844187556006723585>MaxLin</span> <span class=chatlog__timestamp title="Wednesday, June 7, 2023 3:59â€¯PM"><a href=#chatlog__message-container-1116033808928604190>6/7/2023 3:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ok</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116212502116700221 class=chatlog__message-container data-message-id=1116212502116700221><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/844187556006723585/3533e954aaedc64015f7352ab0c51058.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=maxlin0507 data-user-id=844187556006723585>MaxLin</span> <span class=chatlog__timestamp title="Thursday, June 8, 2023 3:49â€¯AM"><a href=#chatlog__message-container-1116212502116700221>6/8/2023 3:49â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>when execute:
pip install tantivy@git+<a href="https://github.com/quickwit-oss/tantivy-py#164adc87e1a033117001cf70e38c82a53014d985">https://github.com/quickwit-oss/tantivy-py#164adc87e1a033117001cf70e38c82a53014d985</a></span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1116212502229954590/image.png?ex=698a0226&amp;is=6988b0a6&amp;hm=53bffac14d9538f2a41ed17985959a94001bc2525cb88f7954abe59087e69ecc&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1116212502229954590/image.png?ex=698a0226&amp;is=6988b0a6&amp;hm=53bffac14d9538f2a41ed17985959a94001bc2525cb88f7954abe59087e69ecc&amp;" alt="Image attachment" title="Image: image.png (133.99 KB)" loading=lazy> </a></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/quickwit-oss/tantivy-py><div class="chatlog__markdown chatlog__markdown-preserve">GitHub - quickwit-oss/tantivy-py: Python bindings for Tantivy</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Python bindings for Tantivy. Contribute to quickwit-oss/tantivy-py development by creating an account on GitHub.</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/sPJS3u6d95Hb8ooaleNvPmcWdpsj8Mrimqw2FSpVQEE/https/opengraph.githubassets.com/52bd1aabb2e4c10a07ce3a9824750f50a13cda633ebf391a8e38d42014d21338/quickwit-oss/tantivy-py> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/sPJS3u6d95Hb8ooaleNvPmcWdpsj8Mrimqw2FSpVQEE/https/opengraph.githubassets.com/52bd1aabb2e4c10a07ce3a9824750f50a13cda633ebf391a8e38d42014d21338/quickwit-oss/tantivy-py alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116213164724457472 class=chatlog__message-container data-message-id=1116213164724457472><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, June 8, 2023 3:52â€¯AM"><a href=#chatlog__message-container-1116213164724457472>6/8/2023 3:52â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>does just <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pip install tantivy</code> work? what OS / arch are you on?</span></div></div></div></div><div id=chatlog__message-container-1116213243501883423 class=chatlog__message-container data-message-id=1116213243501883423><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, June 8, 2023 3:52â€¯AM">3:52â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>tantivy-py doesn&#39;t have wheels for a bunch of the platforms unfortunately</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116220769433817099 class=chatlog__message-container data-message-id=1116220769433817099><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Thursday, June 8, 2023 4:22â€¯AM"><a href=#chatlog__message-container-1116220769433817099>6/8/2023 4:22â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i have to build tantivy from source</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div><div id=chatlog__message-container-1116220832528728126 class=chatlog__message-container data-message-id=1116220832528728126><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, June 8, 2023 4:23â€¯AM">4:23â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the wheels haven&#39;t been updated in ages unfortunately</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116222965579788288 class=chatlog__message-container data-message-id=1116222965579788288><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, June 8, 2023 4:31â€¯AM"><a href=#chatlog__message-container-1116222965579788288>6/8/2023 4:31â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Oh man, do we need to fork Tantivy just to ship the whls <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ˜‚"
    title="joy"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f602.svg"></span></div></div></div></div><div id=chatlog__message-container-1116223134572499015 class=chatlog__message-container data-message-id=1116223134572499015><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, June 8, 2023 4:32â€¯AM">4:32â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>That particular sha I pinned to had wheels for macOS arm64 and also Linux x86 as I recall</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116328770970853437 class=chatlog__message-container data-message-id=1116328770970853437><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/844187556006723585/3533e954aaedc64015f7352ab0c51058.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=maxlin0507 data-user-id=844187556006723585>MaxLin</span> <span class=chatlog__timestamp title="Thursday, June 8, 2023 11:31â€¯AM"><a href=#chatlog__message-container-1116328770970853437>6/8/2023 11:31â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><img
    loading="lazy"
    class="chatlog__emoji chatlog__emoji--large"
    alt="ðŸ«¡"
    title="ðŸ«¡"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1fae1.svg"><img
    loading="lazy"
    class="chatlog__emoji chatlog__emoji--large"
    alt="ðŸ«¡"
    title="ðŸ«¡"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1fae1.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1116424031508377755 class=chatlog__message-container data-message-id=1116424031508377755><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/343264775339245568/cc97fc25c9e0472a319f25c10736f5f4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=timcarambat data-user-id=343264775339245568>Tim Carambat</span> <span class=chatlog__timestamp title="Thursday, June 8, 2023 5:50â€¯PM"><a href=#chatlog__message-container-1116424031508377755>6/8/2023 5:50â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey yall, fellow YC company here looking to add support for LanceDB. Using the JS <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vectordb</code> (^0.1.4) and getting an issue when booting up. Looks like for this machine i need <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">x86_64-apple-darwin.node</code> (SRC: <a href="https://github.com/lancedb/lancedb/blob/a56b65db84eccc3a904acda4b7431507de8b8511/node/native.js#L21)">https://github.com/lancedb/lancedb/blob/a56b65db84eccc3a904acda4b7431507de8b8511/node/native.js#L21)</a>

but looks like all i have in <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">dist</code> is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">aarch64-apple-darwin</code> and <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">x86_64-unknown-linux-gnu</code>. Just did a clean install and I am on Node 18</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1117999060201242765 class=chatlog__message-container data-message-id=1117999060201242765><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.tullie data-user-id=703245629559668758>tullie</span> <span class=chatlog__timestamp title="Tuesday, June 13, 2023 2:09â€¯AM"><a href=#chatlog__message-container-1117999060201242765>6/13/2023 2:09â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;ve been seeing: 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">&quot;LanceError(IO): Unary operator &#39;Minus&#39; is not supported&quot;</code>
 When using a where clause with a negative value
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">.where(&#39;feature = -0.51&#39;)</code>
Is this a bug or do I have the wrong syntax?</span> <span class=chatlog__edited-timestamp title="Tuesday, June 13, 2023 2:09â€¯AM">(edited)</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1118022664813039626 class=chatlog__message-container data-message-id=1118022664813039626><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=.tullie>tullie</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1117999060201242765')"> I&#39;ve been seeing: 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">&quot;LanceError(IO): Unary operator &#39;Minus&#39; is not supported&quot;</code>
 When using a where clause with a negative value
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">.where(&#39;feature = -0.51&#39;)</code>
Is this a bug or do I have the wrong syntax? </span> <span class=chatlog__reply-edited-timestamp title="Tuesday, June 13, 2023 2:09â€¯AM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, June 13, 2023 3:42â€¯AM"><a href=#chatlog__message-container-1118022664813039626>6/13/2023 3:42â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This looks like a bug. Tracking here: <a href="https://github.com/lancedb/lance/issues/972">https://github.com/lancedb/lance/issues/972</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/972><div class="chatlog__markdown chatlog__markdown-preserve">Cannot filter on negative numbers &#183; Issue #972 &#183; lancedb/lance</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">import lance import pyarrow as pa import numpy as np tab = pa.table({&quot;x&quot;: [-1.0, 1.0, 0, np.nan, np.inf, -np.inf]}) dataset = lance.write_dataset(tab, &quot;lance_values&quot;) dataset.sc...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/umvBmHDTnAphInL8erKuRHAAN8ay_CaTvmuULWLrZ54/https/opengraph.githubassets.com/37991a3a6c16f9840331f8debddb83be2bab1eab7343bb08fc52ef8153f06ff6/lancedb/lance/issues/972> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/umvBmHDTnAphInL8erKuRHAAN8ay_CaTvmuULWLrZ54/https/opengraph.githubassets.com/37991a3a6c16f9840331f8debddb83be2bab1eab7343bb08fc52ef8153f06ff6/lancedb/lance/issues/972 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1118024071603568690 class=chatlog__message-container data-message-id=1118024071603568690><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, June 13, 2023 3:48â€¯AM">3:48â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>As a workaround, you can write the negative number as a string and cast it in the expression (only works on the latest version of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pylance</code> / <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lancedb</code>):
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">.where(&quot;feature = cast(&#39;-0.51&#39; as float)&quot;)</code></span> <span class=chatlog__edited-timestamp title="Tuesday, June 13, 2023 3:50â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1118278752162562238 class=chatlog__message-container data-message-id=1118278752162562238><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1118024071603568690')"> As a workaround, you can write the negative number as a string and cast it in the expression (only works on the latest version of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pylance</code> / <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lancedb</code>):
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">.where(&quot;feature = cast(&#39;-0.51&#39; as float)&quot;)</code> </span> <span class=chatlog__reply-edited-timestamp title="Tuesday, June 13, 2023 3:50â€¯AM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author title=.tullie data-user-id=703245629559668758>tullie</span> <span class=chatlog__timestamp title="Tuesday, June 13, 2023 8:40â€¯PM"><a href=#chatlog__message-container-1118278752162562238>6/13/2023 8:40â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ahh good to know re the workaround. This will work for us. Where&#39;s the best place to see the docs for this syntax btw?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1118279435817324594 class=chatlog__message-container data-message-id=1118279435817324594><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, June 13, 2023 8:43â€¯PM"><a href=#chatlog__message-container-1118279435817324594>6/13/2023 8:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://lancedb.github.io/lance/read_and_write.html#filter-push-down">https://lancedb.github.io/lance/read_and_write.html#filter-push-down</a></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121138028728037470 class=chatlog__message-container data-message-id=1121138028728037470><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.tullie data-user-id=703245629559668758>tullie</span> <span class=chatlog__timestamp title="Wednesday, June 21, 2023 6:02â€¯PM"><a href=#chatlog__message-container-1121138028728037470>6/21/2023 6:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We&#39;ve been seeing these errors occasionally:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">  File &quot;/usr/local/lib/python3.9/site-packages/lancedb/table.py&quot;, line 127, in create_index
    self._dataset.create_index(
  File &quot;/usr/local/lib/python3.9/site-packages/lance/dataset.py&quot;, line 553, in create_index
    self._ds.create_index(column, index_type, name, metric, kwargs)
pyo3_runtime.PanicException: called `Result::unwrap()` on an `Err` value: IO { message: &quot;task 349 panicked&quot; }</code>
This is a fatal bug as it brings down the whole python runtime (i.e. unable to catch the exception). 
1. What are we doing to make this happen? How can we avoid/fix it?
2. Is it possible to fail gracefully from these kind of errors? If we could catch the PanicException we could just not build the index for this case, but that doesn&#39;t seem to be possible right now.

Note because we have many varied dimensions and dataset sizes it&#39;s hard for us to know in advanced what subvectors and partitions to use, which I suspect is why we&#39;re hitting edge cases here. This is the current code we use to compute these parameters but would love any suggestions for improvements:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">if len(index_data) &gt; 10000:
      # It&#39;s suggested that each partition should have around 3-5k vectors.
      num_partitions = max(len(seen_index_data) // 2**12, 1)

      # The number of sub vectors must be a multiple of embedding_cols. We
      # choose the highest multiple that is not itself. To make the most of 
      # SIMD alignment the subvectors must satisfy:
      #  (embedding_cols / subvectors) % 4 == 0 
      num_sub_vectors = embedding_cols
      for i in range(embedding_cols - 1, 0, -1):
          if (embedding_cols / i) % 4 == 0:
              num_sub_vectors = i
              break</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121145421222391930 class=chatlog__message-container data-message-id=1121145421222391930><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, June 21, 2023 6:31â€¯PM"><a href=#chatlog__message-container-1121145421222391930>6/21/2023 6:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title=".tullie">@tullie</span> could you provide a number of # of entries in the dataset, what is the number of sub-vectors, num_partitons ?</span></div></div></div></div><div id=chatlog__message-container-1121145470513844337 class=chatlog__message-container data-message-id=1121145470513844337><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, June 21, 2023 6:31â€¯PM">6:31â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>we can try to repro from ourside and let you know</span></div></div></div></div><div id=chatlog__message-container-1121145698902097940 class=chatlog__message-container data-message-id=1121145698902097940><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, June 21, 2023 6:32â€¯PM">6:32â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>also lance version</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121155975198539817 class=chatlog__message-container data-message-id=1121155975198539817><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1121145421222391930')"> <span class="chatlog__markdown-mention" title=".tullie">@tullie</span> could you provide a number of # of entries in the dataset, what is the number of sub-vectors, num_partitons ? </span></div></div><div class=chatlog__header><span class=chatlog__author title=.tullie data-user-id=703245629559668758>tullie</span> <span class=chatlog__timestamp title="Wednesday, June 21, 2023 7:13â€¯PM"><a href=#chatlog__message-container-1121155975198539817>6/21/2023 7:13â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Lance version: v0.1.8
Partitions: 4
Sub vectors: 125
Num vectors: 18836 
Vector dimension: 375</span> <span class=chatlog__edited-timestamp title="Wednesday, June 21, 2023 7:14â€¯PM">(edited)</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121217210988367953 class=chatlog__message-container data-message-id=1121217210988367953><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Wednesday, June 21, 2023 11:16â€¯PM"><a href=#chatlog__message-container-1121217210988367953>6/21/2023 11:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title=".tullie">@tullie</span> in these error messages, do you see a line that starts with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">thread &#39;tokio-runtime-worker&#39; panicked at</code>? If there is, knowing that would be extremely helpful in narrowing down where that&#39;s coming from.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121234315146174655 class=chatlog__message-container data-message-id=1121234315146174655><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Thursday, June 22, 2023 12:24â€¯AM"><a href=#chatlog__message-container-1121234315146174655>6/22/2023 12:24â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>FYI Identified one issue that <em>might</em> be what you are running into. <a href="https://github.com/lancedb/lance/pull/1000">https://github.com/lancedb/lance/pull/1000</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/pull/1000><div class="chatlog__markdown chatlog__markdown-preserve">feat: handle NaN values in argmin by wjones127 &#183; Pull Request #1000...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Currently, we panic if NaN is found in the array argmin or argmax operate on.
Example where we can hit this:
import lance
import pyarrow as pa
import pyarrow.compute as pc
import shutil


dims = 37...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/uL7y7AOqOZt8JxInkr6SWo2fQd4FMoVImqSbVWJm1g8/https/opengraph.githubassets.com/12dad6da418634f29ee9388c97e2ab4137dd47da7d53283ffe77724d78e496ae/lancedb/lance/pull/1000> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/uL7y7AOqOZt8JxInkr6SWo2fQd4FMoVImqSbVWJm1g8/https/opengraph.githubassets.com/12dad6da418634f29ee9388c97e2ab4137dd47da7d53283ffe77724d78e496ae/lancedb/lance/pull/1000 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121258043687047291 class=chatlog__message-container data-message-id=1121258043687047291><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1121217210988367953')"> <span class="chatlog__markdown-mention" title=".tullie">@tullie</span> in these error messages, do you see a line that starts with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">thread &#39;tokio-runtime-worker&#39; panicked at</code>? If there is, knowing that would be extremely helpful in narrowing down where that&#39;s coming from. </span></div></div><div class=chatlog__header><span class=chatlog__author title=.tullie data-user-id=703245629559668758>tullie</span> <span class=chatlog__timestamp title="Thursday, June 22, 2023 1:59â€¯AM"><a href=#chatlog__message-container-1121258043687047291>6/22/2023 1:59â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yes that&#39;s there, apologies missed this when copying it over</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121259185489838111 class=chatlog__message-container data-message-id=1121259185489838111><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1121234315146174655')"> FYI Identified one issue that <em>might</em> be what you are running into. <a href="https://github.com/lancedb/lance/pull/1000">https://github.com/lancedb/lance/pull/1000</a> </span></div></div><div class=chatlog__header><span class=chatlog__author title=.tullie data-user-id=703245629559668758>tullie</span> <span class=chatlog__timestamp title="Thursday, June 22, 2023 2:03â€¯AM"><a href=#chatlog__message-container-1121259185489838111>6/22/2023 2:03â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Okay perfect, thanks for the quick response on this, hopefully it is the issue we&#39;re running into</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121300082420101210 class=chatlog__message-container data-message-id=1121300082420101210><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=.tullie>tullie</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1121258043687047291')"> Yes that&#39;s there, apologies missed this when copying it over </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Thursday, June 22, 2023 4:46â€¯AM"><a href=#chatlog__message-container-1121300082420101210>6/22/2023 4:46â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>What&#39;s on the rest of that line for your error message? That&#39;s the important part I&#39;m looking for to confirm I found the same issue</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121486004847648949 class=chatlog__message-container data-message-id=1121486004847648949><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1121300082420101210')"> What&#39;s on the rest of that line for your error message? That&#39;s the important part I&#39;m looking for to confirm I found the same issue </span></div></div><div class=chatlog__header><span class=chatlog__author title=.tullie data-user-id=703245629559668758>tullie</span> <span class=chatlog__timestamp title="Thursday, June 22, 2023 5:04â€¯PM"><a href=#chatlog__message-container-1121486004847648949>6/22/2023 5:04â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>So there&#39;s a few error messages and the tokio-runtime-worker&#39; panicked is definitely one i&#39;ve seen before. This is the most recent one I just pulled:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;called `Option::unwrap()` on a `None` value&#39;, /home/runner/work/lance/lance/rust/src/arrow/kernels.rs:61:56
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
pyo3_runtime.PanicException: called `Option::unwrap()` on a `None` value</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1121512910867398666 class=chatlog__message-container data-message-id=1121512910867398666><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Thursday, June 22, 2023 6:51â€¯PM"><a href=#chatlog__message-container-1121512910867398666>6/22/2023 6:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Okay that confirms it; The error is the same one I was able to reproduce. Thanks for providing that!</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=muscle><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ’ª src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f4aa.svg loading=lazy> <span class=chatlog__reaction-count>2</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1126485241389912145 class=chatlog__message-container data-message-id=1126485241389912145><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/689048335138684962/3634298291186d60c5700219e976a378.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=olcay069 data-user-id=689048335138684962>olcay069</span> <span class=chatlog__timestamp title="Thursday, July 6, 2023 12:10â€¯PM"><a href=#chatlog__message-container-1126485241389912145>7/6/2023 12:10â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, it seems that creating an index in python using 0.5.3 isn&#39;t working? I&#39;ve 10k items in a table but still get an error:

<div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">Code:
tbl = db.create_table(&quot;my_table&quot;, data=[{&quot;vector&quot;: [3.1, 4.1], &quot;item&quot;: &quot;foo&quot;, &quot;price&quot;: 10.0}])
data = []
for i in range(10000):
    data.append({&quot;vector&quot;: [0.0031, 0.0102], &quot;item&quot;: &quot;foo&quot;, &quot;price&quot;: 10.0})
tbl.add(data)
tbl.create_index(metric=&quot;cosine&quot;, num_partitions=100, num_sub_vectors=96)</div></div></span> <span class=chatlog__edited-timestamp title="Thursday, July 6, 2023 12:22â€¯PM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1126485260004245544 class=chatlog__message-container data-message-id=1126485260004245544><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, July 6, 2023 12:10â€¯PM">12:10â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Error:
---------------------------------------------------------------------------
OSError                                   Traceback (most recent call last)
Cell In[36], line 1
----&gt; 1 tbl.create_index(metric=&quot;cosine&quot;, num_partitions=100, num_sub_vectors=96)

File ~\AppData\Roaming\Python\Python38\site-packages\lancedb\table.py:200, in LanceTable.create_index(self, metric, num_partitions, num_sub_vectors)
    185 def create_index(self, metric=&quot;L2&quot;, num_partitions=256, num_sub_vectors=96):
    186     &quot;&quot;&quot;Create an index on the table.
    187 
    188     Parameters
   (...)
    198         Default is 96.
    199     &quot;&quot;&quot;
--&gt; 200     self._dataset.create_index(
    201         column=VECTOR_COLUMN_NAME,
    202         index_type=&quot;IVF_PQ&quot;,
    203         metric=metric,
    204         num_partitions=num_partitions,
    205         num_sub_vectors=num_sub_vectors,
    206     )
    207     self._reset_dataset()

File ~\AppData\Roaming\Python\Python38\site-packages\lance\dataset.py:614, in LanceDataset.create_index(self, column, index_type, name, metric, replace, num_partitions, ivf_centroids, num_sub_vectors, **kwargs)
    610         kwargs[&quot;ivf_centroids&quot;] = ivf_centroids_batch
    612 kwargs[&quot;replace&quot;] = replace
--&gt; 614 self._ds.create_index(column, index_type, name, metric, kwargs)
    615 return LanceDataset(self.uri)

OSError: LanceError(Index): Ivf::compute_residual: argmin failed. Failed to find minimum of PrimitiveArray
[
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  ...80 elements...,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
  NaN,
]</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1126575287463846041 class=chatlog__message-container data-message-id=1126575287463846041><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, July 6, 2023 6:07â€¯PM"><a href=#chatlog__message-container-1126575287463846041>7/6/2023 6:07â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="olcay069">@olcay069</span> thanks for the bug report. Here the vectors are 2D so it can&#39;t be divided into 96 subvectors. We&#39;ll add more documentation and guardrails on that, but for a dataset of that size you don&#39;t even need to create an index, the distance computations in Lance has SIMD optimizations so a plain KNN query should finish in single digit milliseconds</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1126578575739453590 class=chatlog__message-container data-message-id=1126578575739453590><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/689048335138684962/3634298291186d60c5700219e976a378.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1126575287463846041')"> <span class="chatlog__markdown-mention" title="olcay069">@olcay069</span> thanks for the bug report. Here the vectors are 2D so it can&#39;t be divided into 96 subvectors. We&#39;ll add more documentation and guardrails on that, but for a dataset of that size you don&#39;t even need to create an index, the distance computations in Lance has SIMD optimizations so a plain KNN query should finish in single digit milliseconds </span></div></div><div class=chatlog__header><span class=chatlog__author title=olcay069 data-user-id=689048335138684962>olcay069</span> <span class=chatlog__timestamp title="Thursday, July 6, 2023 6:21â€¯PM"><a href=#chatlog__message-container-1126578575739453590>7/6/2023 6:21â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>thanks for the quick reply. yes, initially it was but it gets slower the more items i add to the table. i will have another look at see if I can notice anything.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1126587181109100595 class=chatlog__message-container data-message-id=1126587181109100595><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, July 6, 2023 6:55â€¯PM"><a href=#chatlog__message-container-1126587181109100595>7/6/2023 6:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>If youâ€™re adding one row at a time that results in lots of small files. Best is inserting all rows in one go, the performance difference will be very substantial</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1126606699436974202 class=chatlog__message-container data-message-id=1126606699436974202><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/689048335138684962/3634298291186d60c5700219e976a378.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1126587181109100595')"> If youâ€™re adding one row at a time that results in lots of small files. Best is inserting all rows in one go, the performance difference will be very substantial </span></div></div><div class=chatlog__header><span class=chatlog__author title=olcay069 data-user-id=689048335138684962>olcay069</span> <span class=chatlog__timestamp title="Thursday, July 6, 2023 8:12â€¯PM"><a href=#chatlog__message-container-1126606699436974202>7/6/2023 8:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yes, right. noticed that too. btw, is there some maintenance function that can sort of &quot;clean up&quot; those files and make it more compact and speedy?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1126607017562349618 class=chatlog__message-container data-message-id=1126607017562349618><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Thursday, July 6, 2023 8:14â€¯PM"><a href=#chatlog__message-container-1126607017562349618>7/6/2023 8:14â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>we are looking into that <a href="https://github.com/lancedb/lance/issues/934">https://github.com/lancedb/lance/issues/934</a> For now, it is easier to read it out full and write back again.</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/934><div class="chatlog__markdown chatlog__markdown-preserve"><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Fragment::optimize() / compact()</code> to regenerate the fragment &#183; Iss...</div></a></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/EQGxD7n4RJElQumCPSzvZYgW45IexHDwl4v6Q7Em6F4/https/opengraph.githubassets.com/4d5885fe54045d24ef43dd00207ca7244e46355cb11ce6215b66ca7da1745b65/lancedb/lance/issues/934> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/EQGxD7n4RJElQumCPSzvZYgW45IexHDwl4v6Q7Em6F4/https/opengraph.githubassets.com/4d5885fe54045d24ef43dd00207ca7244e46355cb11ce6215b66ca7da1745b65/lancedb/lance/issues/934 alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1126607098462089257 class=chatlog__message-container data-message-id=1126607098462089257><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, July 6, 2023 8:14â€¯PM"><a href=#chatlog__message-container-1126607098462089257>7/6/2023 8:14â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hehe, Lei beat me to it <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™‚"
    title="slight_smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f642.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1126608307801571449 class=chatlog__message-container data-message-id=1126608307801571449><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/689048335138684962/3634298291186d60c5700219e976a378.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=olcay069 data-user-id=689048335138684962>olcay069</span> <span class=chatlog__timestamp title="Thursday, July 6, 2023 8:19â€¯PM"><a href=#chatlog__message-container-1126608307801571449>7/6/2023 8:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><img
    loading="lazy"
    class="chatlog__emoji chatlog__emoji--large"
    alt="ðŸ˜„"
    title="smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f604.svg"></span></div></div></div></div><div id=chatlog__message-container-1126608319956668496 class=chatlog__message-container data-message-id=1126608319956668496><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, July 6, 2023 8:19â€¯PM">8:19â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>thanks</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1127822996812333127 class=chatlog__message-container data-message-id=1127822996812333127><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/712525835718098955/1e5e218dac047adbaf0407950a2eb40e.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=philipk19238 data-user-id=712525835718098955>philipk19238</span> <span class=chatlog__timestamp title="Monday, July 10, 2023 4:45â€¯AM"><a href=#chatlog__message-container-1127822996812333127>7/10/2023 4:45â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Calling connection.create_table with no data still raises an error.</span></div></div></div></div><div id=chatlog__message-container-1127823369425924218 class=chatlog__message-container data-message-id=1127823369425924218><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, July 10, 2023 4:47â€¯AM">4:47â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This line of code specifically: <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-python">if data is not None:
            tbl = LanceTable.create(
                self,
                name,
                data,
                schema,
                mode=mode,
                on_bad_vectors=on_bad_vectors,
                fill_value=fill_value,
            )
        else:
            tbl = LanceTable.open(self, name)
        return tbl</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1127824124585181215 class=chatlog__message-container data-message-id=1127824124585181215><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Monday, July 10, 2023 4:50â€¯AM"><a href=#chatlog__message-container-1127824124585181215>7/10/2023 4:50â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="philipk19238">@philipk19238</span> we have not released the fix yet. lemme do a release tonight</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=heart><img class="chatlog__emoji chatlog__emoji--small" alt=â¤ï¸ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/2764.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1127826174140231742 class=chatlog__message-container data-message-id=1127826174140231742><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Monday, July 10, 2023 4:58â€¯AM"><a href=#chatlog__message-container-1127826174140231742>7/10/2023 4:58â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lancedb/releases/tag/v0.1.10-python">https://github.com/lancedb/lancedb/releases/tag/v0.1.10-python</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/releases/tag/v0.1.10-python><div class="chatlog__markdown chatlog__markdown-preserve">Release v0.1.10 Python release: Create empty database &#183; lancedb/lan...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">What&#39;s Changed

Set default to error instead of drop by @changhiskhan in #259
Allow creation of an empty table by @changhiskhan in #254
[docs] dynamic docs generation and deployment by @unkn-wn...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/XJbzjk9-HyLv24nIEV38D-E8f8ZOgtrHfqq2lTzJ2QU/https/opengraph.githubassets.com/1c34897efc7265deb43f6832ef2844f463d8a4ebb4113cc5a9d2d21988534ded/lancedb/lancedb/releases/tag/v0.1.10-python> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/XJbzjk9-HyLv24nIEV38D-E8f8ZOgtrHfqq2lTzJ2QU/https/opengraph.githubassets.com/1c34897efc7265deb43f6832ef2844f463d8a4ebb4113cc5a9d2d21988534ded/lancedb/lancedb/releases/tag/v0.1.10-python alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1127826352482046104 class=chatlog__message-container data-message-id=1127826352482046104><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/712525835718098955/1e5e218dac047adbaf0407950a2eb40e.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=philipk19238 data-user-id=712525835718098955>philipk19238</span> <span class=chatlog__timestamp title="Monday, July 10, 2023 4:59â€¯AM"><a href=#chatlog__message-container-1127826352482046104>7/10/2023 4:59â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thank you!</span></div></div></div></div><div id=chatlog__message-container-1127826637577273405 class=chatlog__message-container data-message-id=1127826637577273405><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, July 10, 2023 5:00â€¯AM">5:00â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m not sure if this fixes the issue though. The classmethod of table allows instantiation of an empty table but creating the table through connection.create_table still errors out due to the check for empty data.</span></div></div></div></div><div id=chatlog__message-container-1127826711543816202 class=chatlog__message-container data-message-id=1127826711543816202><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, July 10, 2023 5:00â€¯AM">5:00â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Maybe easier way would be to remove the check and have table.create do the checking instead</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1128023373167996928 class=chatlog__message-container data-message-id=1128023373167996928><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/804392812631818340/67e1f20e2c8a49ab5814bc85907d5b98.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=dnsco data-user-id=804392812631818340>dnsco</span> <span class=chatlog__timestamp title="Monday, July 10, 2023 6:02â€¯PM"><a href=#chatlog__message-container-1128023373167996928>7/10/2023 6:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m getting a <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Lance Error: Append with different schema: original=[...] new=[...]&quot;</code> but both schemas are the same</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1128025990635995207 class=chatlog__message-container data-message-id=1128025990635995207><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/804392812631818340/67e1f20e2c8a49ab5814bc85907d5b98.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=dnsco data-user-id=804392812631818340>dnsco</span> <span class=chatlog__timestamp title="Monday, July 10, 2023 6:12â€¯PM"><a href=#chatlog__message-container-1128025990635995207>7/10/2023 6:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I see now that schema has #[derive(PartialEq)] should we need to have the same metadata in a schema to append?</span></div></div></div></div><div id=chatlog__message-container-1128027037794308126 class=chatlog__message-container data-message-id=1128027037794308126><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, July 10, 2023 6:16â€¯PM">6:16â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lance/issues/1048">https://github.com/lancedb/lance/issues/1048</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/1048><div class="chatlog__markdown chatlog__markdown-preserve">Cannot append with different schema metadata &#183; Issue #1048 &#183; lanced...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">I&#39;m trying to create something that batches up minutes of data in arrow batches and then ingests into lance, I&#39;m getting a `<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Error::SchemaMistach</code> error, the fields are the same, but the ...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/ZTLGTR09u1ssNG-Pi9YWTmAWYX47dMdFtdaXhyfNbmQ/https/opengraph.githubassets.com/3685e570e128fea4eb27a42bad7142ee62ae7cd5133a1e414158636f75d18897/lancedb/lance/issues/1048> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/ZTLGTR09u1ssNG-Pi9YWTmAWYX47dMdFtdaXhyfNbmQ/https/opengraph.githubassets.com/3685e570e128fea4eb27a42bad7142ee62ae7cd5133a1e414158636f75d18897/lancedb/lance/issues/1048 alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1128035226329821204 class=chatlog__message-container data-message-id=1128035226329821204><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/804392812631818340/67e1f20e2c8a49ab5814bc85907d5b98.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=dnsco>dnsco</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1128025990635995207')"> I see now that schema has #[derive(PartialEq)] should we need to have the same metadata in a schema to append? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Monday, July 10, 2023 6:49â€¯PM"><a href=#chatlog__message-container-1128035226329821204>7/10/2023 6:49â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks for reporting this. I think we have a quick fix for this: <a href="https://github.com/lancedb/lance/pull/1051">https://github.com/lancedb/lance/pull/1051</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/pull/1051><div class="chatlog__markdown chatlog__markdown-preserve">fix: don&#39;t compare metadata when checking schema in append by wjone...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Fixes #1048</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/8dwT7waBcggk_HMpc3ZVtwjeDh5XqP_uKz4KFqY-b70/https/opengraph.githubassets.com/42b3c292d9b801c7a2b8f98861d7124f3a5b1082e86dd54ae5f4bad186c8ba9f/lancedb/lance/pull/1051> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/8dwT7waBcggk_HMpc3ZVtwjeDh5XqP_uKz4KFqY-b70/https/opengraph.githubassets.com/42b3c292d9b801c7a2b8f98861d7124f3a5b1082e86dd54ae5f4bad186c8ba9f/lancedb/lance/pull/1051 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1128098405948858418 class=chatlog__message-container data-message-id=1128098405948858418><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/804392812631818340/67e1f20e2c8a49ab5814bc85907d5b98.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1128035226329821204')"> Thanks for reporting this. I think we have a quick fix for this: <a href="https://github.com/lancedb/lance/pull/1051">https://github.com/lancedb/lance/pull/1051</a> </span></div></div><div class=chatlog__header><span class=chatlog__author title=dnsco data-user-id=804392812631818340>dnsco</span> <span class=chatlog__timestamp title="Monday, July 10, 2023 11:00â€¯PM"><a href=#chatlog__message-container-1128098405948858418>7/10/2023 11:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>we have an issue with dictionaries having different offsets and lengths even though the values are the same</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1131653942640644168 class=chatlog__message-container data-message-id=1131653942640644168><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/609059381673197569/213ef2483b1cd0b088dbd340961aabdb.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=abrinz data-user-id=609059381673197569>abrinz</span> <span class=chatlog__timestamp title="Thursday, July 20, 2023 6:28â€¯PM"><a href=#chatlog__message-container-1131653942640644168>7/20/2023 6:28â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ‘‹"
    title="wave"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44b.svg">  Hi. I&#39;m trying to experiment with LanceDB in a Kaggle notebook. It pip installs properly, but when I import the module I get an error related to the pyarrow version.  
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ValueError: pyarrow.lib.IpcWriteOptions size changed, may indicate binary incompatibility. Expected 88 from C header, got 72 from PyObject</code>
I&#39;ve tried upgrading pyarrow to the latest version with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pip install -U pyarrow</code> but that did not solve the problem.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1131654517012836382 class=chatlog__message-container data-message-id=1131654517012836382><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Thursday, July 20, 2023 6:31â€¯PM"><a href=#chatlog__message-container-1131654517012836382>7/20/2023 6:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Could you share which PyArrow version you have installed?</span></div></div></div></div><div id=chatlog__message-container-1131656008394080359 class=chatlog__message-container data-message-id=1131656008394080359><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, July 20, 2023 6:36â€¯PM">6:36â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It seems like this might be an incompatibility with another package: <a href="https://github.com/huggingface/datasets/issues/5923">https://github.com/huggingface/datasets/issues/5923</a>
From that thread, it sounds like PyArrow 11 should work, if that is indeed the same issue as yours.</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/huggingface/datasets/issues/5923><div class="chatlog__markdown chatlog__markdown-preserve">Cannot import datasets - ValueError: pyarrow.lib.IpcWriteOptions si...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Describe the bug When trying to import datasets, I get a pyarrow ValueError: Traceback (most recent call last): File &quot;/Users/edward/test/test.py&quot;, line 1, in import datasets File &quot;/U...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/2BhWHAzvf-nB_wIyu0-6bpQZR3WXTQ_UFlICdXzLGl4/https/opengraph.githubassets.com/ddc3901d0aac37594b4817eb71f0ba2738231f7a8db1a6514d850cf6edfa8fe9/huggingface/datasets/issues/5923> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/2BhWHAzvf-nB_wIyu0-6bpQZR3WXTQ_UFlICdXzLGl4/https/opengraph.githubassets.com/ddc3901d0aac37594b4817eb71f0ba2738231f7a8db1a6514d850cf6edfa8fe9/huggingface/datasets/issues/5923 alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1131686633666789519 class=chatlog__message-container data-message-id=1131686633666789519><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/609059381673197569/213ef2483b1cd0b088dbd340961aabdb.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=abrinz data-user-id=609059381673197569>abrinz</span> <span class=chatlog__timestamp title="Thursday, July 20, 2023 8:38â€¯PM"><a href=#chatlog__message-container-1131686633666789519>7/20/2023 8:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It has something to do with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pip install lancedb</code> upgrading Kaggle&#39;s preinstalled pyarrow from <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">9.0.0</code> to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">12.0.1</code>. 

I tried downgrading pyarrow back to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">9.0.0</code> after installing lancedb but that didn&#39;t work. However I was able to accomplish the same thing with the following workaround. 

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">!pip install pylance --no-deps
!pip install lancedb --no-deps 
!pip install attr ratelimiter retry</code>

The lancedb quickstart example works after this, though there may be other issues running on an unsupported version of pyarrow.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1131687704803950592 class=chatlog__message-container data-message-id=1131687704803950592><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Thursday, July 20, 2023 8:42â€¯PM"><a href=#chatlog__message-container-1131687704803950592>7/20/2023 8:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yes, our current minimum PyArrow version is 10.0.0</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1133539770753089536 class=chatlog__message-container data-message-id=1133539770753089536><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Tuesday, July 25, 2023 11:22â€¯PM"><a href=#chatlog__message-container-1133539770753089536>7/25/2023 11:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>&quot;vector column is missing&quot; error when attempting to create a table using an OpenAI embedding function as exemplified here: <a href="https://github.com/lancedb/lancedb/blob/main/node/examples/js-openai/index.js">https://github.com/lancedb/lancedb/blob/main/node/examples/js-openai/index.js</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/blob/main/node/examples/js-openai/index.js><div class="chatlog__markdown chatlog__markdown-preserve">lancedb/node/examples/js-openai/index.js at main &#183; lancedb/lancedb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Developer-friendly, serverless vector database for AI applications. Easily add long-term memory to your LLM apps! - lancedb/lancedb</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/-71V6ZBVjR-kqaZQGP-SdU4d8no2ery3Hz_3ohwwG_M/https/opengraph.githubassets.com/48b837437888d0066e46d1fba47e8340930ade84908a93f70155fc1301e4cb5f/lancedb/lancedb> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/-71V6ZBVjR-kqaZQGP-SdU4d8no2ery3Hz_3ohwwG_M/https/opengraph.githubassets.com/48b837437888d0066e46d1fba47e8340930ade84908a93f70155fc1301e4cb5f/lancedb/lancedb alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1133836552330563746 class=chatlog__message-container data-message-id=1133836552330563746><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=majestic_raccoon_31617 data-user-id=1073376390075908126>gc</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, July 26, 2023 7:01â€¯PM"> <a href=#chatlog__message-container-1133836552330563746>7/26/2023 7:01â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134678908340547654 class=chatlog__message-container data-message-id=1134678908340547654><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 2:48â€¯AM"><a href=#chatlog__message-container-1134678908340547654>7/29/2023 2:48â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Is anyone actively using the table.countRows function? I&#39;m getting strange counts from it, that don&#39;t match the number of files in the corresponding .lance folder in my S3 bucket. Known issue?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134742629469405274 class=chatlog__message-container data-message-id=1134742629469405274><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 7:02â€¯AM"><a href=#chatlog__message-container-1134742629469405274>7/29/2023 7:02â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>count rows should return the number of total rows in the table, which is different from the number of files. Each .lance data file can contain a configurable number of rows</span></div></div></div></div><div id=chatlog__message-container-1134742855500439552 class=chatlog__message-container data-message-id=1134742855500439552><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, July 29, 2023 7:02â€¯AM">7:02â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>One way to verify is if your table is small enough you can try to read it into memory using table.to_lance().to_table() and see if you get the same number of rows</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134869154776764488 class=chatlog__message-container data-message-id=1134869154776764488><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1134742855500439552')"> One way to verify is if your table is small enough you can try to read it into memory using table.to_lance().to_table() and see if you get the same number of rows </span></div></div><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 3:24â€¯PM"><a href=#chatlog__message-container-1134869154776764488>7/29/2023 3:24â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Is that available via the javascript API?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134869352668221470 class=chatlog__message-container data-message-id=1134869352668221470><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1134742629469405274')"> count rows should return the number of total rows in the table, which is different from the number of files. Each .lance data file can contain a configurable number of rows </span></div></div><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 3:25â€¯PM"><a href=#chatlog__message-container-1134869352668221470>7/29/2023 3:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Should there be at least as many rows as files? For example, if there are more files than rows, would that necessarily signify a problem?</span> <span class=chatlog__edited-timestamp title="Saturday, July 29, 2023 3:26â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134892827856359565 class=chatlog__message-container data-message-id=1134892827856359565><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=lincolncannon>Lincoln Cannon</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1134869352668221470')"> Should there be at least as many rows as files? For example, if there are more files than rows, would that necessarily signify a problem? </span> <span class=chatlog__reply-edited-timestamp title="Saturday, July 29, 2023 3:26â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 4:58â€¯PM"><a href=#chatlog__message-container-1134892827856359565>7/29/2023 4:58â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yes # files &gt;= # rows</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134896173786861568 class=chatlog__message-container data-message-id=1134896173786861568><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1134892827856359565')"> Yes # files &gt;= # rows </span></div></div><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 5:12â€¯PM"><a href=#chatlog__message-container-1134896173786861568>7/29/2023 5:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hmm. Did you mean the opposite? As I understand your statement, it would be okay to have 1000 files and 10 rows. Is that right?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134900473007190057 class=chatlog__message-container data-message-id=1134900473007190057><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 5:29â€¯PM"><a href=#chatlog__message-container-1134900473007190057>7/29/2023 5:29â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Sorry typo # rows &gt;= # files</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134900588719653026 class=chatlog__message-container data-message-id=1134900588719653026><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1134900473007190057')"> Sorry typo # rows &gt;= # files </span></div></div><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 5:29â€¯PM"><a href=#chatlog__message-container-1134900588719653026>7/29/2023 5:29â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks for clarifying. So I&#39;m seeing cases where the number of files is greater than the number of rows.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134900740142420208 class=chatlog__message-container data-message-id=1134900740142420208><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 5:30â€¯PM"><a href=#chatlog__message-container-1134900740142420208>7/29/2023 5:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Oh interesting</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134900742591881336 class=chatlog__message-container data-message-id=1134900742591881336><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 5:30â€¯PM"><a href=#chatlog__message-container-1134900742591881336>7/29/2023 5:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>... at least greater than the number of rows reported by countRows()</span></div></div></div></div><div id=chatlog__message-container-1134901020439347342 class=chatlog__message-container data-message-id=1134901020439347342><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, July 29, 2023 5:31â€¯PM">5:31â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>For example, right now I have 2 files in a LanceDB database on S3. But countRows() is reporting 0.</span></div></div></div></div><div id=chatlog__message-container-1134901127926775908 class=chatlog__message-container data-message-id=1134901127926775908><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, July 29, 2023 5:31â€¯PM">5:31â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>And during previous tests, I&#39;ve had hundreds of files with a report around, say, 90 rows.</span> <span class=chatlog__edited-timestamp title="Saturday, July 29, 2023 5:36â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134907085574918245 class=chatlog__message-container data-message-id=1134907085574918245><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 5:55â€¯PM"><a href=#chatlog__message-container-1134907085574918245>7/29/2023 5:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Can you help me repro it? How did you generate the data? Or is the dataset shareable?</span></div></div></div></div><div id=chatlog__message-container-1134907239447154829 class=chatlog__message-container data-message-id=1134907239447154829><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, July 29, 2023 5:56â€¯PM">5:56â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>One other thing you can do (if you can) is use the python api to read all of the data and also check count rows</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134907457064419488 class=chatlog__message-container data-message-id=1134907457064419488><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=lincolncannon>Lincoln Cannon</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1134901020439347342')"> For example, right now I have 2 files in a LanceDB database on S3. But countRows() is reporting 0. </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 5:57â€¯PM"><a href=#chatlog__message-container-1134907457064419488>7/29/2023 5:57â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>When you say 2 files do you mean 2 *.lance files under the data directory? Or two files under the dataset directory?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134919110875168869 class=chatlog__message-container data-message-id=1134919110875168869><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1134907457064419488')"> When you say 2 files do you mean 2 *.lance files under the data directory? Or two files under the dataset directory? </span></div></div><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 6:43â€¯PM"><a href=#chatlog__message-container-1134919110875168869>7/29/2023 6:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>There are two .lance files in the &quot;data&quot; folder. And countRows() was returning zero. I just ran countRows() again, and it&#39;s now returning 5, which should be correct. I&#39;m wondering now if there&#39;s a latency problem when the LanceDB database is stored in S3.</span></div></div></div></div><div id=chatlog__message-container-1134919332162437200 class=chatlog__message-container data-message-id=1134919332162437200><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, July 29, 2023 6:44â€¯PM">6:44â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>The dataset is not shareable. But its structure is ordinary text paragraphs -- one paragraph per embedding.</span> <span class=chatlog__edited-timestamp title="Saturday, July 29, 2023 6:44â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134922024989499613 class=chatlog__message-container data-message-id=1134922024989499613><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 6:54â€¯PM"><a href=#chatlog__message-container-1134922024989499613>7/29/2023 6:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Shouldnâ€™t be latency related. Were you also writing directly to S3? It might be possible that you started with an empty table and then added data but the table metadata still had the empty table cached (if you were doing all that in the same session). If thatâ€™s the case, would you mind filing a GitHub issue and Iâ€™ll look into it more?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1134923649074352338 class=chatlog__message-container data-message-id=1134923649074352338><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1134922024989499613')"> Shouldnâ€™t be latency related. Were you also writing directly to S3? It might be possible that you started with an empty table and then added data but the table metadata still had the empty table cached (if you were doing all that in the same session). If thatâ€™s the case, would you mind filing a GitHub issue and Iâ€™ll look into it more? </span></div></div><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, July 29, 2023 7:01â€¯PM"><a href=#chatlog__message-container-1134923649074352338>7/29/2023 7:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>That sounds like a possibility. I started noticing the problem when attempting multiple asynchronous concurrent adds.</span> <span class=chatlog__edited-timestamp title="Saturday, July 29, 2023 7:01â€¯PM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1134924077467971585 class=chatlog__message-container data-message-id=1134924077467971585><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, July 29, 2023 7:03â€¯PM">7:03â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Happy to open a GitHub issue, although I&#39;m a little foggy on how to describe the problem in a helpful way at this point.</span></div></div></div></div><div id=chatlog__message-container-1134925627670155275 class=chatlog__message-container data-message-id=1134925627670155275><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, July 29, 2023 7:09â€¯PM">7:09â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Done. Hopefully this works. <a href="https://github.com/lancedb/lancedb/issues/379">https://github.com/lancedb/lancedb/issues/379</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/379><div class="chatlog__markdown chatlog__markdown-preserve">countRows() becomes inaccurate &#183; Issue #379 &#183; lancedb/lancedb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">The problem occurs in an AWS environment, using javascript Lambda and Dockerfile for execution, and S3 for storage. I try to run the lambda multiple times concurrently or serially to add embeddings...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/mzoXFoesW47l-F_acbA6W1y0NUrPtsafxSE_F564fio/https/opengraph.githubassets.com/fe0ea285b29e859eebd59134c9003e5060d7ec380c2cad1135e314b0e6104f8b/lancedb/lancedb/issues/379> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/mzoXFoesW47l-F_acbA6W1y0NUrPtsafxSE_F564fio/https/opengraph.githubassets.com/fe0ea285b29e859eebd59134c9003e5060d7ec380c2cad1135e314b0e6104f8b/lancedb/lancedb/issues/379 alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1139671380967821514 class=chatlog__message-container data-message-id=1139671380967821514><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title="Deleted User" data-user-id=456226577798135808>Deleted User</span> <span class=chatlog__timestamp title="Friday, August 11, 2023 9:27â€¯PM"><a href=#chatlog__message-container-1139671380967821514>8/11/2023 9:27â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hi guys, I have some crash using lancedb in electron,  the search api call crash with this error, <strong>memory allocation of 5001087310153803133 bytes failed</strong>
Any idea?</span> <span class=chatlog__edited-timestamp title="Friday, August 11, 2023 9:28â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1139675461883002962 class=chatlog__message-container data-message-id=1139675461883002962><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, August 11, 2023 9:43â€¯PM"><a href=#chatlog__message-container-1139675461883002962>8/11/2023 9:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>do you have data / code that you can share to help us repro?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1139817155383283812 class=chatlog__message-container data-message-id=1139817155383283812><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title="Deleted User" data-user-id=456226577798135808>Deleted User</span> <span class=chatlog__timestamp title="Saturday, August 12, 2023 7:06â€¯AM"><a href=#chatlog__message-container-1139817155383283812>8/12/2023 7:06â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yes, sure</span></div></div></div></div><div id=chatlog__message-container-1139817464700616725 class=chatlog__message-container data-message-id=1139817464700616725><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, August 12, 2023 7:07â€¯AM">7:07â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>we launch a child process with this:
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline"> const serverProcess = fork(__dirname + &#39;/server/index.js&#39;, [])</code>
and then the crash code is this:
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">
const db = await lancedb.connect(uri);
    const table = await db.openTable(&quot;vectors&quot;, embedding);
    const results = await table.search(query).nprobes(1).execute()
    return results
</code>
crash in the search</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1140675670184300564 class=chatlog__message-container data-message-id=1140675670184300564><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy><div class=chatlog__reply-author title="Deleted User">Deleted User</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1139817155383283812')"> yes, sure </span></div></div><div class=chatlog__header><span class=chatlog__author title=majestic_raccoon_31617 data-user-id=1073376390075908126>gc</span> <span class=chatlog__timestamp title="Monday, August 14, 2023 3:57â€¯PM"><a href=#chatlog__message-container-1140675670184300564>8/14/2023 3:57â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m working on a fix for the electron issue, tracking in <a href="https://github.com/lancedb/lancedb/issues/382">https://github.com/lancedb/lancedb/issues/382</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/382><div class="chatlog__markdown chatlog__markdown-preserve">[Typescript] Vector search crashes in Electron environment without ...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">From discord When I run identical code in typescript and then the same code in electron, populating the database works perfectly as does getting length, adding, etc. For some reason queryâ€”for ident...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/1fvqV2OMx8VzSidiEdl08SX93-LAeraNH0frvA0jIE4/https/opengraph.githubassets.com/c62256e2fe523c04d355bcf79f6fd8e6f9ca79c8e0da676728e7cfb2df1c662b/lancedb/lancedb/issues/382> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/1fvqV2OMx8VzSidiEdl08SX93-LAeraNH0frvA0jIE4/https/opengraph.githubassets.com/c62256e2fe523c04d355bcf79f6fd8e6f9ca79c8e0da676728e7cfb2df1c662b/lancedb/lancedb/issues/382 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1141969374752813119 class=chatlog__message-container data-message-id=1141969374752813119><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/762121560446074890/1853d315ea9c70b5c31680c99d251271.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=_.prashant data-user-id=762121560446074890>Prashant</span> <span class=chatlog__timestamp title="Friday, August 18, 2023 5:38â€¯AM"><a href=#chatlog__message-container-1141969374752813119>8/18/2023 5:38â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I am really new to web dev. I am trying to use @lancedb with langchain in my nextjs app (13). And I am getting errors while implementing a simple example. So, does this not work in this situation?

Got 2 errors specifically: 

first to get a markdown loader, resolves that by adding it to the webpack config/ next config

Then got another one. I have attached both the screenshots. 

<span class="chatlog__markdown-mention" title="lei.xu">@lei</span></span> <span class=chatlog__edited-timestamp title="Friday, August 18, 2023 5:39â€¯AM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1141969620924907522 class=chatlog__message-container data-message-id=1141969620924907522><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, August 18, 2023 5:39â€¯AM">5:39â€¯AM</div></div><div class=chatlog__message-primary><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1141969620463521823/Screen_Shot_2023-08-18_at_11.09.11_AM.png?ex=698a1bd6&amp;is=6988ca56&amp;hm=7343d20e4bfc07237cd057a79c8e3d78444fc00634b2a51576a7e43e70270316&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1141969620463521823/Screen_Shot_2023-08-18_at_11.09.11_AM.png?ex=698a1bd6&amp;is=6988ca56&amp;hm=7343d20e4bfc07237cd057a79c8e3d78444fc00634b2a51576a7e43e70270316&amp;" alt="Image attachment" title="Image: Screen_Shot_2023-08-18_at_11.09.11_AM.png (64.35 KB)" loading=lazy> </a></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1141969620748738620/Screen_Shot_2023-08-18_at_11.09.21_AM.png?ex=698a1bd6&amp;is=6988ca56&amp;hm=5598cadb220c1e8990bcb0be62896022dab1f1eaee18138e7aad90cbbc968b53&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1141969620748738620/Screen_Shot_2023-08-18_at_11.09.21_AM.png?ex=698a1bd6&amp;is=6988ca56&amp;hm=5598cadb220c1e8990bcb0be62896022dab1f1eaee18138e7aad90cbbc968b53&amp;" alt="Image attachment" title="Image: Screen_Shot_2023-08-18_at_11.09.21_AM.png (55.81 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1141970311793872988 class=chatlog__message-container data-message-id=1141970311793872988><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Friday, August 18, 2023 5:42â€¯AM"><a href=#chatlog__message-container-1141970311793872988>8/18/2023 5:42â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="majestic_raccoon_31617">@gc</span> ?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1141970598323572736 class=chatlog__message-container data-message-id=1141970598323572736><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1032079688887189556/9d9cd1c2872874160d9f8e2f6dd766a5.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/762121560446074890/1853d315ea9c70b5c31680c99d251271.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=_.prashant>Prashant</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1141969374752813119')"> I am really new to web dev. I am trying to use @lancedb with langchain in my nextjs app (13). And I am getting errors while implementing a simple example. So, does this not work in this situation?

Got 2 errors specifically: 

first to get a markdown loader, resolves that by adding it to the webpack config/ next config

Then got another one. I have attached both the screenshots. 

<span class="chatlog__markdown-mention" title="lei.xu">@lei</span> </span> <span class=chatlog__reply-edited-timestamp title="Friday, August 18, 2023 5:39â€¯AM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=ayushexel data-user-id=1032079688887189556>AyushC</span> <span class=chatlog__timestamp title="Friday, August 18, 2023 5:43â€¯AM"><a href=#chatlog__message-container-1141970598323572736>8/18/2023 5:43â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>You&#39;ll need to use a loader for .node file. Please see our nextjs/vercel template example. It has the extra steps listed here - <a href="https://github.com/lancedb/lancedb-vercel-chatbot#lancedb-on-nextjs-and-vercel">https://github.com/lancedb/lancedb-vercel-chatbot#lancedb-on-nextjs-and-vercel</a>
I&#39;ll add these to our docs as well</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=sparkling_heart><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ’– src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f496.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div><div class=chatlog__reaction title=ðŸ«¡><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ«¡ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1fae1.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1141975154931544089 class=chatlog__message-container data-message-id=1141975154931544089><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=_.prashant data-user-id=762121560446074890>Prashant</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, August 18, 2023 6:01â€¯AM"> <a href=#chatlog__message-container-1141975154931544089>8/18/2023 6:01â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1144281113670467754 class=chatlog__message-container data-message-id=1144281113670467754><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title="Deleted User" data-user-id=456226577798135808>Deleted User</span> <span class=chatlog__timestamp title="Thursday, August 24, 2023 2:44â€¯PM"><a href=#chatlog__message-container-1144281113670467754>8/24/2023 2:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi guys,
I&#39;m facing this error when I open a table to add data. I created the issue in github.

I created the table like this and added data:
const table = await db.createTable(&#39;vectors&#39;, data)

The when I open the table to add more data is when I get the error:
const tbl = await db.openTable(&quot;vectors&quot;); await tbl.add(data)
I even try using a embedding function on the create and open table.

(node:84671) UnhandledPromiseRejectionWarning: Error: LanceDBError: Append with different schema: original=Field(id=0, name=vector, type=fixed_size_list:float:1536)
Field(id=1, name=path, type=string)
Field(id=2, name=fileName, type=string)
Field(id=3, name=format, type=string)
Field(id=4, name=chunk, type=string)
Field(id=5, name=createdAt, type=string)
Field(id=6, name=updatedAt, type=string)
 new=Field(id=0, name=vector, type=fixed_size_list:float:1536)
Field(id=1, name=path, type=string)
Field(id=2, name=fileName, type=string)
Field(id=3, name=format, type=string)
Field(id=4, name=chunk, type=string)
Field(id=5, name=updatedAt, type=string)

(node:84671) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">--unhandled-rejections=strict</code> (see <a href="https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode)">https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode)</a>. (rejection id: 4)
Regards
Victor</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1144380348478799904 class=chatlog__message-container data-message-id=1144380348478799904><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, August 24, 2023 9:18â€¯PM"><a href=#chatlog__message-container-1144380348478799904>8/24/2023 9:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>can you add that just before updatedAt to the incoming batch and try again?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1144963948450435102 class=chatlog__message-container data-message-id=1144963948450435102><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/71892307636400128/4ba4f19fca3988f29452a6b184cf0a0b.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.barker data-user-id=71892307636400128>Barker</span> <span class=chatlog__timestamp title="Saturday, August 26, 2023 11:57â€¯AM"><a href=#chatlog__message-container-1144963948450435102>8/26/2023 11:57â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey folks, I&#39;m experimenting with Lance and having a small issue. I have a very large pd DataFrame that it fails to save on my 32GB M1 Pro. I get a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">SIGSEGV</code>.
For scale, around 16M rows. turns out to be 2.2GB <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.parquet</code> file with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">gzip</code>. Works with smaller shards.</span> <span class=chatlog__edited-timestamp title="Saturday, August 26, 2023 11:59â€¯AM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1144964103702597682 class=chatlog__message-container data-message-id=1144964103702597682><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, August 26, 2023 11:58â€¯AM">11:58â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>(I&#39;m aware that Lance supports appending but I wanted to test it purely as a drop-in replacement)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1144993514002849902 class=chatlog__message-container data-message-id=1144993514002849902><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1144380348478799904')"> can you add that just before updatedAt to the incoming batch and try again? </span></div></div><div class=chatlog__header><span class=chatlog__author title="Deleted User" data-user-id=456226577798135808>Deleted User</span> <span class=chatlog__timestamp title="Saturday, August 26, 2023 1:55â€¯PM"><a href=#chatlog__message-container-1144993514002849902>8/26/2023 1:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m sorry, I have an error. I will delete the issue.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1145019313435201686 class=chatlog__message-container data-message-id=1145019313435201686><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/71892307636400128/4ba4f19fca3988f29452a6b184cf0a0b.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=.barker>Barker</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1144963948450435102')"> Hey folks, I&#39;m experimenting with Lance and having a small issue. I have a very large pd DataFrame that it fails to save on my 32GB M1 Pro. I get a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">SIGSEGV</code>.
For scale, around 16M rows. turns out to be 2.2GB <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.parquet</code> file with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">gzip</code>. Works with smaller shards. </span> <span class=chatlog__reply-edited-timestamp title="Saturday, August 26, 2023 11:59â€¯AM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, August 26, 2023 3:37â€¯PM"><a href=#chatlog__message-container-1145019313435201686>8/26/2023 3:37â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks for the bug report. Do you see any error messages or stack traces? Could you share the data? If not how about the schema?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1145023889446027304 class=chatlog__message-container data-message-id=1145023889446027304><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/71892307636400128/4ba4f19fca3988f29452a6b184cf0a0b.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1145019313435201686')"> Thanks for the bug report. Do you see any error messages or stack traces? Could you share the data? If not how about the schema? </span></div></div><div class=chatlog__header><span class=chatlog__author title=.barker data-user-id=71892307636400128>Barker</span> <span class=chatlog__timestamp title="Saturday, August 26, 2023 3:56â€¯PM"><a href=#chatlog__message-container-1145023889446027304>8/26/2023 3:56â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey, I&#39;m away from my dev machine at the moment, but I can share the schema and code itself.
I create the df with the following dtypes:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-python">OUTPUT_DTYPES: dict = {
    &#39;paper_id&#39;: &#39;uint32&#39;,
    &#39;section&#39;: &#39;string&#39;,
    &#39;single_text&#39;: &#39;string&#39;,
    &#39;multi_text&#39;: &#39;string&#39;,
    &#39;single_challenge_score&#39;: &#39;float32&#39;,
    &#39;single_direction_score&#39;: &#39;float32&#39;,
    &#39;multi_challenge_score&#39;: &#39;float32&#39;,
    &#39;multi_direction_score&#39;: &#39;float32&#39;
}

# And this is the code I use to generate it
batch_df: pd.DataFrame = pd.DataFrame({k: pd.Series(dtype=t) for k, t in OUTPUT_DTYPES.items()})
# This df ends up having around 16M rows</code>
After I&#39;m done concatenating from all shards, this is the original way I saved the file:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-python"># This line crashes with the pyarrow engine!
batch_df.to_parquet(batch_output_path, engine=&quot;fastparquet&quot;, compression=&quot;gzip&quot;, index=False)</code>
And when using lance I swap it with
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-python">lance.write_dataset(batch_df, batch_output_path)</code></span> <span class=chatlog__edited-timestamp title="Saturday, August 26, 2023 3:58â€¯PM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1145024157319442522 class=chatlog__message-container data-message-id=1145024157319442522><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, August 26, 2023 3:57â€¯PM">3:57â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;ve created a separate branch to append each shard normally (instead of one massive dataset) and it works perfectly fine. It&#39;s the large df that makes it crash</span></div></div></div></div><div id=chatlog__message-container-1145024353814200370 class=chatlog__message-container data-message-id=1145024353814200370><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, August 26, 2023 3:57â€¯PM">3:57â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I can DM you the entire code if you&#39;d like</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1145031320238555239 class=chatlog__message-container data-message-id=1145031320238555239><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, August 26, 2023 4:25â€¯PM"><a href=#chatlog__message-container-1145031320238555239>8/26/2023 4:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Got it thanks. Probably the data is more helpful than the code. Can you share that? One other thing I can think of is the length of text. If itâ€™s very long, try using a large string column (arrow type) as a workaround?</span></div></div></div></div><div id=chatlog__message-container-1145031409791143936 class=chatlog__message-container data-message-id=1145031409791143936><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, August 26, 2023 4:26â€¯PM">4:26â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>If DM is easier happy to chat</span></div></div></div></div><div id=chatlog__message-container-1145032276514701332 class=chatlog__message-container data-message-id=1145032276514701332><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, August 26, 2023 4:29â€¯PM">4:29â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>You can try using pyarrow.Table.from_pandas(df, schema)</span></div></div></div></div><div id=chatlog__message-container-1145032586679291934 class=chatlog__message-container data-message-id=1145032586679291934><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, August 26, 2023 4:30â€¯PM">4:30â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Also try reducing the max_rows_per_file</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1145353167450673222 class=chatlog__message-container data-message-id=1145353167450673222><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/71892307636400128/4ba4f19fca3988f29452a6b184cf0a0b.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.barker data-user-id=71892307636400128>Barker</span> <span class=chatlog__timestamp title="Sunday, August 27, 2023 1:44â€¯PM"><a href=#chatlog__message-container-1145353167450673222>8/27/2023 1:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Small update: I&#39;m next to my dev machine. I&#39;ve tried reducing <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">max_rows_per_file</code> from <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">1024 * 1024</code> incrementally down to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">256 * 256</code> and it didn&#39;t work.
Later on I tried the second approach of converting to the pyarrow table with large strings. It works, and allows saving the table both as <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.parquet</code> using pyarrow and lance. The conversion from pandas to pyarrow takes a bit of time, though.</span></div></div></div></div><div id=chatlog__message-container-1145353346581024808 class=chatlog__message-container data-message-id=1145353346581024808><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Sunday, August 27, 2023 1:45â€¯PM">1:45â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-python">table: pa.Table = pa.Table.from_pandas(batch_df, SCHEMA,    preserve_index=False)

del batch_df
gc.collect()

lance.write_dataset(table, batch_output_path, mode=&quot;overwrite&quot;)</code></span> <span class=chatlog__edited-timestamp title="Sunday, August 27, 2023 1:45â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1145355978477416560 class=chatlog__message-container data-message-id=1145355978477416560><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/71892307636400128/4ba4f19fca3988f29452a6b184cf0a0b.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.barker data-user-id=71892307636400128>Barker</span> <span class=chatlog__timestamp title="Sunday, August 27, 2023 1:55â€¯PM"><a href=#chatlog__message-container-1145355978477416560>8/27/2023 1:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>The large strings contain on average ~260 characters, with some going as high as 500</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1145432837789593670 class=chatlog__message-container data-message-id=1145432837789593670><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Sunday, August 27, 2023 7:01â€¯PM"><a href=#chatlog__message-container-1145432837789593670>8/27/2023 7:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title=".barker">@Barker</span> is your <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">max_rows_per_group</code> bigger than 256 * 256?  The current behavior of lance is to write each groups in the given size, and only stops writing once the already written data has more than <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">max_rows_per_file</code> .

Using large string does indicate some bugs  if your string value is just 500 bytes.  I am looking into it</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1145445803138224138 class=chatlog__message-container data-message-id=1145445803138224138><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/71892307636400128/4ba4f19fca3988f29452a6b184cf0a0b.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1145432837789593670')"> <span class="chatlog__markdown-mention" title=".barker">@Barker</span> is your <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">max_rows_per_group</code> bigger than 256 * 256?  The current behavior of lance is to write each groups in the given size, and only stops writing once the already written data has more than <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">max_rows_per_file</code> .

Using large string does indicate some bugs  if your string value is just 500 bytes.  I am looking into it </span></div></div><div class=chatlog__header><span class=chatlog__author title=.barker data-user-id=71892307636400128>Barker</span> <span class=chatlog__timestamp title="Sunday, August 27, 2023 7:52â€¯PM"><a href=#chatlog__message-container-1145445803138224138>8/27/2023 7:52â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yep, I&#39;ve done the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pa.large_string</code> thing with the default <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">1024 * 1024</code>
and thanks for your work mate</span> <span class=chatlog__edited-timestamp title="Sunday, August 27, 2023 7:52â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1145820374290939904 class=chatlog__message-container data-message-id=1145820374290939904><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/791064729291456563/fdc37127d5fed3d0e44608ef14b6ca7f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=zafirov_ data-user-id=791064729291456563>z4f1r0v</span> <span class=chatlog__timestamp title="Monday, August 28, 2023 8:41â€¯PM"><a href=#chatlog__message-container-1145820374290939904>8/28/2023 8:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Opening <a href="https://lancedb.github.io/lancedb/python/python/Database">https://lancedb.github.io/lancedb/python/python/Database</a>, I see this</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1145820374391599184/Screenshot_2023-08-28_at_22.40.57.png?ex=698a4661&amp;is=6988f4e1&amp;hm=4c4d82f6028231b3caba2f02c6d6be808dbfa95d1f427a8258399bcc51c4b2fa&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1145820374391599184/Screenshot_2023-08-28_at_22.40.57.png?ex=698a4661&amp;is=6988f4e1&amp;hm=4c4d82f6028231b3caba2f02c6d6be808dbfa95d1f427a8258399bcc51c4b2fa&amp;" alt="Image attachment" title="Image: Screenshot_2023-08-28_at_22.40.57.png (42.13 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147369196905320499 class=chatlog__message-container data-message-id=1147369196905320499><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:15â€¯AM"><a href=#chatlog__message-container-1147369196905320499>9/2/2023 3:15â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>File c:\Python311\Lib\site-packages\pandas\core\indexes\base.py:3653, in Index.get_loc(self, key)
   3652 try:
-&gt; 3653     return self._engine.get_loc(casted_key)
   3654 except KeyError as err:

File c:\Python311\Lib\site-packages\pandas_libs\index.pyx:147, in pandas._libs.index.IndexEngine.get_loc()

File c:\Python311\Lib\site-packages\pandas_libs\index.pyx:176, in pandas._libs.index.IndexEngine.get_loc()

File pandas_libs\hashtable_class_helper.pxi:7080, in pandas._libs.hashtable.PyObjectHashTable.get_item()

File pandas_libs\hashtable_class_helper.pxi:7088, in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: &#39;score&#39;

The above exception was the direct cause of the following exception:

KeyError                                  Traceback (most recent call last)
Cell In[34], line 1
----&gt; 1 response = query_engine.query(&quot;What is p53?&quot;)
      2 print(response)

File c:\Python311\Lib\site-packages\llama_index\indices\query\base.py:23, in BaseQueryEngine.query(self, str_or_query_bundle)
...
   3658     #  InvalidIndexError. Otherwise we fall through and re-raise
   3659     #  the TypeError.
   3660     self._check_indexing_error(key)</span></div></div></div></div><div id=chatlog__message-container-1147369432620998717 class=chatlog__message-container data-message-id=1147369432620998717><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:16â€¯AM">3:16â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>may i  know why has this issue when dong indexretive</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147369837136445550 class=chatlog__message-container data-message-id=1147369837136445550><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:18â€¯AM"><a href=#chatlog__message-container-1147369837136445550>9/2/2023 3:18â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yeah, <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">score</code> was renamed <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_distance</code>. Would you please file a github issue for lancedb and llama_index repo? One of us will update it as soon as possible</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147370013418868827 class=chatlog__message-container data-message-id=1147370013418868827><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:18â€¯AM"><a href=#chatlog__message-container-1147370013418868827>9/2/2023 3:18â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>any temporary solution now</span></div></div></div></div><div id=chatlog__message-container-1147370172198428703 class=chatlog__message-container data-message-id=1147370172198428703><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:19â€¯AM">3:19â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lancedb/issues/469">https://github.com/lancedb/lancedb/issues/469</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/469><div class="chatlog__markdown chatlog__markdown-preserve">score issue &#183; Issue #469 &#183; lancedb/lancedb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">File c:\Python311\Lib\site-packages\pandas\core\indexes\base.py:3653, in Index.get_loc(self, key) 3652 try: -&gt; 3653 return self._engine.get_loc(casted_key) 3654 except KeyError as err: File c:\P...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/iQ-ASCz_yDdMjaqsjeTuAB_OrpmdlsDrAf6HLS8O4Qw/https/opengraph.githubassets.com/ab3bb6ce738ab23ae00c44da243b1e64d16aed6531231b95bae62cef5ab24733/lancedb/lancedb/issues/469> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/iQ-ASCz_yDdMjaqsjeTuAB_OrpmdlsDrAf6HLS8O4Qw/https/opengraph.githubassets.com/ab3bb6ce738ab23ae00c44da243b1e64d16aed6531231b95bae62cef5ab24733/lancedb/lancedb/issues/469 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1147371835445493780 class=chatlog__message-container data-message-id=1147371835445493780><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:26â€¯AM">3:26â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/jerryjliu/llama_index/issues/7520">https://github.com/jerryjliu/llama_index/issues/7520</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/jerryjliu/llama_index/issues/7520><div class="chatlog__markdown chatlog__markdown-preserve">[Question]: LanceDBVectorStore issue &#183; Issue #7520 &#183; jerryjliu/llam...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Question Validation I have searched both the documentation and discord for an answer. Question File c:\Python311\Lib\site-packages\pandas\core\indexes\base.py:3653, in Index.get_loc(self, key) 3652...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/-li3_6Nw9OrEI3dCQtq6AsKY-gbYIw0nZNB-frXMmzE/https/opengraph.githubassets.com/ee2bc552b4295e5f9d8b710ef75fb81778828ac41cdc6157001bc83df528bb95/jerryjliu/llama_index/issues/7520> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/-li3_6Nw9OrEI3dCQtq6AsKY-gbYIw0nZNB-frXMmzE/https/opengraph.githubassets.com/ee2bc552b4295e5f9d8b710ef75fb81778828ac41cdc6157001bc83df528bb95/jerryjliu/llama_index/issues/7520 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147372013472731156 class=chatlog__message-container data-message-id=1147372013472731156><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:26â€¯AM"><a href=#chatlog__message-container-1147372013472731156>9/2/2023 3:26â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>workarounds:</span></div></div></div></div><div id=chatlog__message-container-1147372110927368274 class=chatlog__message-container data-message-id=1147372110927368274><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:27â€¯AM">3:27â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>1. change the LlamaIndex code to use the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_distance</code> column instead of the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">score</code> column</span></div></div></div></div><div id=chatlog__message-container-1147372209753571381 class=chatlog__message-container data-message-id=1147372209753571381><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:27â€¯AM">3:27â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>2. Use the LanceDB API directly instead of through LlamaIndex</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147372686759166024 class=chatlog__message-container data-message-id=1147372686759166024><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:29â€¯AM"><a href=#chatlog__message-container-1147372686759166024>9/2/2023 3:29â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>change the LlamaIndex code to use the _distance column instead of the score column  , change which function</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147373087352950784 class=chatlog__message-container data-message-id=1147373087352950784><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:31â€¯AM"><a href=#chatlog__message-container-1147373087352950784>9/2/2023 3:31â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py#L160C1-L161C1">https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py#L160C1-L161C1</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py><div class="chatlog__markdown chatlog__markdown-preserve">llama_index/llama_index/vector_stores/lancedb.py at 31666919f43ed99...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LlamaIndex (GPT Index) is a data framework for your LLM applications - jerryjliu/llama_index</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/HL15k1hNjoB2jy9SZAKQ3WGAFoYkgYbHDbVGv3E6m2o/https/opengraph.githubassets.com/b1d22f0ee29fa401a0ad2a0a2052f6153a3d8b72e1e2ff5974ea5c22c5c31f75/jerryjliu/llama_index> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/HL15k1hNjoB2jy9SZAKQ3WGAFoYkgYbHDbVGv3E6m2o/https/opengraph.githubassets.com/b1d22f0ee29fa401a0ad2a0a2052f6153a3d8b72e1e2ff5974ea5c22c5c31f75/jerryjliu/llama_index alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1147373158249279499 class=chatlog__message-container data-message-id=1147373158249279499><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:31â€¯AM">3:31â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>results[&quot;score&quot;] -&gt; results[&quot;_distance&quot;]</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147375059481149500 class=chatlog__message-container data-message-id=1147375059481149500><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:38â€¯AM"><a href=#chatlog__message-container-1147375059481149500>9/2/2023 3:38â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>may i know why it takes so long</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1147375059229483139/image.png?ex=6989ff8b&amp;is=6988ae0b&amp;hm=12fae937f58b00ca713a0bce344663b45276507db7fda45c9088f975d289e9a6&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1147375059229483139/image.png?ex=6989ff8b&amp;is=6988ae0b&amp;hm=12fae937f58b00ca713a0bce344663b45276507db7fda45c9088f975d289e9a6&amp;" alt="Image attachment" title="Image: image.png (17.25 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147375267111784458 class=chatlog__message-container data-message-id=1147375267111784458><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:39â€¯AM"><a href=#chatlog__message-container-1147375267111784458>9/2/2023 3:39â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>how big is your dataset?</span></div></div></div></div><div id=chatlog__message-container-1147375319863529553 class=chatlog__message-container data-message-id=1147375319863529553><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:39â€¯AM">3:39â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>and did you create an ANN index?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147375449501077594 class=chatlog__message-container data-message-id=1147375449501077594><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:40â€¯AM"><a href=#chatlog__message-container-1147375449501077594>9/2/2023 3:40â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>98  mb</span></div></div></div></div><div id=chatlog__message-container-1147375499828531220 class=chatlog__message-container data-message-id=1147375499828531220><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:40â€¯AM">3:40â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>no, how to create ann index</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147375570330583072 class=chatlog__message-container data-message-id=1147375570330583072><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:40â€¯AM"><a href=#chatlog__message-container-1147375570330583072>9/2/2023 3:40â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>how many vectors I mean</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147375655378493510 class=chatlog__message-container data-message-id=1147375655378493510><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:41â€¯AM"><a href=#chatlog__message-container-1147375655378493510>9/2/2023 3:41â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>how to see the number of vector</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147375882990801006 class=chatlog__message-container data-message-id=1147375882990801006><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:42â€¯AM"><a href=#chatlog__message-container-1147375882990801006>9/2/2023 3:42â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m not super familiar with LlamaIndex API, so i don&#39;t know if they support introspection APIs</span></div></div></div></div><div id=chatlog__message-container-1147375886568521848 class=chatlog__message-container data-message-id=1147375886568521848><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:42â€¯AM">3:42â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>but</span></div></div></div></div><div id=chatlog__message-container-1147375897977045142 class=chatlog__message-container data-message-id=1147375897977045142><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:42â€¯AM">3:42â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py#L135">https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py#L135</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py><div class="chatlog__markdown chatlog__markdown-preserve">llama_index/llama_index/vector_stores/lancedb.py at 31666919f43ed99...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LlamaIndex (GPT Index) is a data framework for your LLM applications - jerryjliu/llama_index</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/HL15k1hNjoB2jy9SZAKQ3WGAFoYkgYbHDbVGv3E6m2o/https/opengraph.githubassets.com/b1d22f0ee29fa401a0ad2a0a2052f6153a3d8b72e1e2ff5974ea5c22c5c31f75/jerryjliu/llama_index> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/HL15k1hNjoB2jy9SZAKQ3WGAFoYkgYbHDbVGv3E6m2o/https/opengraph.githubassets.com/b1d22f0ee29fa401a0ad2a0a2052f6153a3d8b72e1e2ff5974ea5c22c5c31f75/jerryjliu/llama_index alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1147375914133495918 class=chatlog__message-container data-message-id=1147375914133495918><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:42â€¯AM">3:42â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>if you can get the table out</span></div></div></div></div><div id=chatlog__message-container-1147375945460748348 class=chatlog__message-container data-message-id=1147375945460748348><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:42â€¯AM">3:42â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>just do len(lance_table) should tell you</span></div></div></div></div><div id=chatlog__message-container-1147376002704625755 class=chatlog__message-container data-message-id=1147376002704625755><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:42â€¯AM">3:42â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>but at 98mb it should be a very small dataset</span></div></div></div></div><div id=chatlog__message-container-1147376074192334858 class=chatlog__message-container data-message-id=1147376074192334858><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:42â€¯AM">3:42â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>so I don&#39;t think the time taken has anything to do with the vector search part?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147376450203291690 class=chatlog__message-container data-message-id=1147376450203291690><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:44â€¯AM"><a href=#chatlog__message-container-1147376450203291690>9/2/2023 3:44â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>how to get the table out</span></div></div></div></div><div id=chatlog__message-container-1147376599193362492 class=chatlog__message-container data-message-id=1147376599193362492><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:44â€¯AM">3:44â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>vector_store = LanceDBVectorStore1(uri=&quot;sample_data/&quot;)\</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147376754734923786 class=chatlog__message-container data-message-id=1147376754734923786><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:45â€¯AM"><a href=#chatlog__message-container-1147376754734923786>9/2/2023 3:45â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>see this line that opens the table: <a href="https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py#L135">https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py#L135</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/jerryjliu/llama_index/blob/31666919f43ed99d62ca5865fd6327892c45a949/llama_index/vector_stores/lancedb.py><div class="chatlog__markdown chatlog__markdown-preserve">llama_index/llama_index/vector_stores/lancedb.py at 31666919f43ed99...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LlamaIndex (GPT Index) is a data framework for your LLM applications - jerryjliu/llama_index</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/HL15k1hNjoB2jy9SZAKQ3WGAFoYkgYbHDbVGv3E6m2o/https/opengraph.githubassets.com/b1d22f0ee29fa401a0ad2a0a2052f6153a3d8b72e1e2ff5974ea5c22c5c31f75/jerryjliu/llama_index> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/HL15k1hNjoB2jy9SZAKQ3WGAFoYkgYbHDbVGv3E6m2o/https/opengraph.githubassets.com/b1d22f0ee29fa401a0ad2a0a2052f6153a3d8b72e1e2ff5974ea5c22c5c31f75/jerryjliu/llama_index alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1147377444018454638 class=chatlog__message-container data-message-id=1147377444018454638><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:48â€¯AM">3:48â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Given that your dataset is only 98mb, it would be very unlikely that vector search takes that long. i&#39;m not familiar enough with LlamaIndex to properly give you help on the other things that LlamaIndex does. Is there a LlamaIndex discord/slack that provides support? They would probably know better how to isolate it</span></div></div></div></div><div id=chatlog__message-container-1147377516722532453 class=chatlog__message-container data-message-id=1147377516722532453><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:48â€¯AM">3:48â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>though to make sure</span></div></div></div></div><div id=chatlog__message-container-1147377611413143652 class=chatlog__message-container data-message-id=1147377611413143652><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 3:48â€¯AM">3:48â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>you could probably manually create a lancedb table with the same data and run a vector search query to see the timing</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147377698717573150 class=chatlog__message-container data-message-id=1147377698717573150><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:49â€¯AM"><a href=#chatlog__message-container-1147377698717573150>9/2/2023 3:49â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>how to do it</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147377820918612088 class=chatlog__message-container data-message-id=1147377820918612088><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:49â€¯AM"><a href=#chatlog__message-container-1147377820918612088>9/2/2023 3:49â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://lancedb.github.io/lancedb/basic/#how-to-create-a-table">https://lancedb.github.io/lancedb/basic/#how-to-create-a-table</a></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147379914245427261 class=chatlog__message-container data-message-id=1147379914245427261><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 3:58â€¯AM"><a href=#chatlog__message-container-1147379914245427261>9/2/2023 3:58â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>may i know how to get the len</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1147379914014720070/image.png?ex=698a0410&amp;is=6988b290&amp;hm=3ce9924d9bcfdf982a399f22c00d4dbb33fb75ea99f95585da4510c920704b54&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1147379914014720070/image.png?ex=698a0410&amp;is=6988b290&amp;hm=3ce9924d9bcfdf982a399f22c00d4dbb33fb75ea99f95585da4510c920704b54&amp;" alt="Image attachment" title="Image: image.png (15.78 KB)" loading=lazy> </a></div></div></div></div><div id=chatlog__message-container-1147380449996447845 class=chatlog__message-container data-message-id=1147380449996447845><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 4:00â€¯AM">4:00â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>only 6349</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1147380449816104980/image.png?ex=698a0490&amp;is=6988b310&amp;hm=91db2c94d420574d16c9c3e4d05bb16f897bb30dee23aa8a02b42d95eb6b373a&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1147380449816104980/image.png?ex=698a0490&amp;is=6988b310&amp;hm=91db2c94d420574d16c9c3e4d05bb16f897bb30dee23aa8a02b42d95eb6b373a&amp;" alt="Image attachment" title="Image: image.png (7.66 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147381451948560524 class=chatlog__message-container data-message-id=1147381451948560524><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:04â€¯AM"><a href=#chatlog__message-container-1147381451948560524>9/2/2023 4:04â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">len(tbl)</code> is sufficient, but what you did is fine</span></div></div></div></div><div id=chatlog__message-container-1147381494533324900 class=chatlog__message-container data-message-id=1147381494533324900><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 4:04â€¯AM">4:04â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>do you know how many dimensions is your vector?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147381524606496859 class=chatlog__message-container data-message-id=1147381524606496859><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:04â€¯AM"><a href=#chatlog__message-container-1147381524606496859>9/2/2023 4:04â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>1536</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147381684132663354 class=chatlog__message-container data-message-id=1147381684132663354><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:05â€¯AM"><a href=#chatlog__message-container-1147381684132663354>9/2/2023 4:05â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ok, so if you do <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">tbl.search(np.random.randn(1536)).limit(3).to_df()</code> how much time does that take?</span> <span class=chatlog__edited-timestamp title="Saturday, September 2, 2023 4:09â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147382428365762592 class=chatlog__message-container data-message-id=1147382428365762592><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:08â€¯AM"><a href=#chatlog__message-container-1147382428365762592>9/2/2023 4:08â€¯AM</a></span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1147382428055388160/image.png?ex=698a0668&amp;is=6988b4e8&amp;hm=50fe9a56e7c91cbe041425e666eb87e8e7b8819f4457a36708cac90e78ceecd3&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1147382428055388160/image.png?ex=698a0668&amp;is=6988b4e8&amp;hm=50fe9a56e7c91cbe041425e666eb87e8e7b8819f4457a36708cac90e78ceecd3&amp;" alt="Image attachment" title="Image: image.png (19.55 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147382687737327708 class=chatlog__message-container data-message-id=1147382687737327708><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:09â€¯AM"><a href=#chatlog__message-container-1147382687737327708>9/2/2023 4:09â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>sorry <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">to_df()</code></span></div></div></div></div><div id=chatlog__message-container-1147382711254782017 class=chatlog__message-container data-message-id=1147382711254782017><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 4:09â€¯AM">4:09â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>not <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">to_pandas()</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147383724783190097 class=chatlog__message-container data-message-id=1147383724783190097><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:13â€¯AM"><a href=#chatlog__message-container-1147383724783190097>9/2/2023 4:13â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>0.7s</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147383900344168498 class=chatlog__message-container data-message-id=1147383900344168498><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:13â€¯AM"><a href=#chatlog__message-container-1147383900344168498>9/2/2023 4:13â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ok so we&#39;ve proven that the vector search part cannot be taking up 4m</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147383971903197225 class=chatlog__message-container data-message-id=1147383971903197225><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:14â€¯AM"><a href=#chatlog__message-container-1147383971903197225>9/2/2023 4:14â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yes</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147384116631838860 class=chatlog__message-container data-message-id=1147384116631838860><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:14â€¯AM"><a href=#chatlog__message-container-1147384116631838860>9/2/2023 4:14â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>all the other stuff is happening outside of LanceDB. So i&#39;m not sure why it takes so long</span></div></div></div></div><div id=chatlog__message-container-1147384192733294682 class=chatlog__message-container data-message-id=1147384192733294682><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 4:15â€¯AM">4:15â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>could it be possible that calling openai api is taking a long time?</span></div></div></div></div><div id=chatlog__message-container-1147384328188334090 class=chatlog__message-container data-message-id=1147384328188334090><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 4:15â€¯AM">4:15â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>also, what kind of system are you running this notebook on? On my system I generally see 0.001s for search at that scale</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147384384069058560 class=chatlog__message-container data-message-id=1147384384069058560><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:15â€¯AM"><a href=#chatlog__message-container-1147384384069058560>9/2/2023 4:15â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>win</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147388709973532763 class=chatlog__message-container data-message-id=1147388709973532763><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 4:33â€¯AM"><a href=#chatlog__message-container-1147388709973532763>9/2/2023 4:33â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>any way can do index research with your tool</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147411445265481822 class=chatlog__message-container data-message-id=1147411445265481822><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 6:03â€¯AM"><a href=#chatlog__message-container-1147411445265481822>9/2/2023 6:03â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Index research? Can you elaborate a bit more?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147411574638776360 class=chatlog__message-container data-message-id=1147411574638776360><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 6:03â€¯AM"><a href=#chatlog__message-container-1147411574638776360>9/2/2023 6:03â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>query_engine = new_index.as_query_engine(
    )</span></div></div></div></div><div id=chatlog__message-container-1147411606205104199 class=chatlog__message-container data-message-id=1147411606205104199><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 6:04â€¯AM">6:04â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>like this with llamaindex</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147414829267689563 class=chatlog__message-container data-message-id=1147414829267689563><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=caonima9047 data-user-id=464248818720833547>cc</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 6:16â€¯AM"><a href=#chatlog__message-container-1147414829267689563>9/2/2023 6:16â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>you example cant be ran on colab</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1147414829418696765/image.png?ex=698a2495&amp;is=6988d315&amp;hm=b6678ee2cd54530a6281d7db1b53bad369464fa7d6e0336d3a6d0570bf41f79c&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1147414829418696765/image.png?ex=698a2495&amp;is=6988d315&amp;hm=b6678ee2cd54530a6281d7db1b53bad369464fa7d6e0336d3a6d0570bf41f79c&amp;" alt="Image attachment" title="Image: image.png (76.69 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147604228790042776 class=chatlog__message-container data-message-id=1147604228790042776><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 2, 2023 6:49â€¯PM"><a href=#chatlog__message-container-1147604228790042776>9/2/2023 6:49â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>looks like the data is empty</span></div></div></div></div><div id=chatlog__message-container-1147604251191808112 class=chatlog__message-container data-message-id=1147604251191808112><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 2, 2023 6:49â€¯PM">6:49â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>what are you passing in as input</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147929070118641774 class=chatlog__message-container data-message-id=1147929070118641774><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/635507634342068228/10b4f881ceeef234f556cbd1dc05f739.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=cat_ethos data-user-id=635507634342068228>catethos</span> <span class=chatlog__timestamp title="Sunday, September 3, 2023 4:20â€¯PM"><a href=#chatlog__message-container-1147929070118641774>9/3/2023 4:20â€¯PM</a></span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1147929069539819640/IMG_8133.png?ex=698a0941&amp;is=6988b7c1&amp;hm=8e68c799a2c00c785063a556a0236147bd893de453d30f9aeaf30594df8484d1&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1147929069539819640/IMG_8133.png?ex=698a0941&amp;is=6988b7c1&amp;hm=8e68c799a2c00c785063a556a0236147bd893de453d30f9aeaf30594df8484d1&amp;" alt="Image attachment" title="Image: IMG_8133.png (153.99 KB)" loading=lazy> </a></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1147929069862801569/IMG_8134.png?ex=698a0941&amp;is=6988b7c1&amp;hm=07b72c35548a6bb3f36f8680f59fda0fe6a217f288167bf882cbe7e668dcdbb8&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1147929069862801569/IMG_8134.png?ex=698a0941&amp;is=6988b7c1&amp;hm=07b72c35548a6bb3f36f8680f59fda0fe6a217f288167bf882cbe7e668dcdbb8&amp;" alt="Image attachment" title="Image: IMG_8134.png (63.51 KB)" loading=lazy> </a></div></div></div></div><div id=chatlog__message-container-1147929356929355920 class=chatlog__message-container data-message-id=1147929356929355920><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Sunday, September 3, 2023 4:21â€¯PM">4:21â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>using Pydantic, i cannot specify the default value of the the vector field</span></div></div></div></div><div id=chatlog__message-container-1147929452689506314 class=chatlog__message-container data-message-id=1147929452689506314><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Sunday, September 3, 2023 4:21â€¯PM">4:21â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>is it expected ?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1147970418142085170 class=chatlog__message-container data-message-id=1147970418142085170><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Sunday, September 3, 2023 7:04â€¯PM"><a href=#chatlog__message-container-1147970418142085170>9/3/2023 7:04â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Would you mind filing a GitHub issue for that. I think default value for this custom type is untested and thereâ€™s likely some rough edges on the implementation. If you happen to have a more detailed stack trace thatâ€™s helpful. Also the pydantic version youâ€™re using</span></div></div></div></div><div id=chatlog__message-container-1147970429596745899 class=chatlog__message-container data-message-id=1147970429596745899><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Sunday, September 3, 2023 7:04â€¯PM">7:04â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1148167398227181629 class=chatlog__message-container data-message-id=1148167398227181629><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/689455295382290577/48af246caf9ca0fd62c048f291564a50.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=cristi2599 data-user-id=689455295382290577>Cristi</span> <span class=chatlog__timestamp title="Monday, September 4, 2023 8:07â€¯AM"><a href=#chatlog__message-container-1148167398227181629>9/4/2023 8:07â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi guys,

I have a problem. Locally I have the x64 architecture and on the server arm. When I deploy it I get this error: 

ERROR Uncaught Exception {&quot;errorType&quot;:&quot;Error&quot;,&quot;errorMessage&quot;:&quot;vectordb: failed to load native library.\n You may need to run <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">npm install @lancedb/vectordb-linux-arm64-gnu</code>.\n\n If that does not work, please file a bug report at <a href="https://github.com/lancedb/lancedb/issues\n">https://github.com/lancedb/lancedb/issues\n</a> \n Source error: Error: Cannot find module &#39;@lancedb/vectordb-linux-arm64-gnu&#39;\nRequire stack:\n- /var/task/node_modules/vectordb/native.js\n- /var/task/node_modules/vectordb/dist/query.js\n- /var/task/node_modules/vectordb/dist/remote/index.js\n- /var/task/node_modules/vectordb/dist/index.js&quot;,&quot;stack&quot;:[&quot;Error: vectordb: failed to load native library.&quot;,&quot; You may need to run <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">npm install @lancedb/vectordb-linux-arm64-gnu</code>.&quot;,&quot;&quot;,&quot; If that does not work, please file a bug report at <a href="https://github.com/lancedb/lancedb/issues">https://github.com/lancedb/lancedb/issues</a>&quot;,&quot; &quot;,&quot; Source error: Error: Cannot find module &#39;@lancedb/vectordb-linux-arm64-gnu&#39;&quot;,&quot;Require stack:&quot;,&quot;- /var/task/node_modules/vectordb/native.js&quot;,&quot;- /var/task/node_modules/vectordb/dist/query.js&quot;,&quot;- /var/task/node_modules/vectordb/dist/remote/index.js&quot;,&quot;- /var/task/node_modules/vectordb/dist/index.js&quot;,&quot; at Object.&lt;anonymous&gt; (/var/task/node_modules/vectordb/native.js:27:15)&quot;,&quot; at Module._compile (node:internal/modules/cjs/loader:1256:14)&quot;,&quot; at Module._extensions..js (node:internal/modules/cjs/loader:1310:10)&quot;,&quot; at Module.load (node:internal/modules/cjs/loader:1119:32)&quot;,&quot; at Module._load (node:internal/modules/cjs/loader:960:12)&quot;,&quot; at Module.require (node:internal/modules/cjs/loader:1143:19)&quot;,&quot; at require (node:internal/modules/cjs/helpers:110:18)&quot;,&quot; at Object.&lt;anonymous&gt; (/var/task/node_modules/vectordb/dist/query.js:28:25)&quot;,&quot; at Module._compile (node:internal/modules/cjs/loader:1256:14)&quot;,&quot; at Module._extensions..js (node:internal/modules/cjs/loader:1310:10)&quot;]}</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/n><div class="chatlog__markdown chatlog__markdown-preserve">Issues &#183; lancedb/lancedb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Developer-friendly, serverless vector database for AI applications. Easily add long-term memory to your LLM apps! - Issues &#183; lancedb/lancedb</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/RfbHvxtjFLlHuQicO7m-44W80Hc-GaEZOOiXsmPQr9c/https/opengraph.githubassets.com/e5a7eaa0e880ca8812ab1af2ad39098ce100850f6075177be952c4b8bf79bad1/lancedb/lancedb> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/RfbHvxtjFLlHuQicO7m-44W80Hc-GaEZOOiXsmPQr9c/https/opengraph.githubassets.com/e5a7eaa0e880ca8812ab1af2ad39098ce100850f6075177be952c4b8bf79bad1/lancedb/lancedb alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1148167427738316831 class=chatlog__message-container data-message-id=1148167427738316831><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, September 4, 2023 8:07â€¯AM">8:07â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>when I give the specified command, it gives me the following answer:

PS C:\Users\Home\Desktop\discord_bot_test\server&gt; npm install @lancedb/vectordb-linux-arm64-gnu
npm ERR! code EBADPLATFORM
npm ERR! notsup Unsupported platform for @lancedb/vectordb-linux-arm64-gnu@0.2.4: wanted {&quot;os&quot;:&quot;linux&quot;,&quot;cpu&quot;:&quot;arm64&quot;} (current: {&quot;os&quot;:&quot;win32&quot;,&quot;cpu&quot;:&quot;x64&quot;})
npm ERR! notsup Valid os:   linux
npm ERR! notsup Actual os:  win32
npm ERR! notsup Valid cpu:  arm64
npm ERR! notsup Actual cpu: x64

npm ERR! A complete log of this run can be found in: C:\Users\Home\AppData\Local\npm-cache_logs\2023-09-04T08_04_08_548Z-debug-0.log

Can someone help me?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1148168359825911830 class=chatlog__message-container data-message-id=1148168359825911830><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1032079688887189556/9d9cd1c2872874160d9f8e2f6dd766a5.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=ayushexel data-user-id=1032079688887189556>AyushC</span> <span class=chatlog__timestamp title="Monday, September 4, 2023 8:11â€¯AM"><a href=#chatlog__message-container-1148168359825911830>9/4/2023 8:11â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>By deploying you mean creating a prod build/ bundling using webpack? If so, you&#39;ll need to exclude the .node package. See - <a href="https://lancedb.github.io/lancedb/basic/#note-bundling-vectordb-apps-with-webpack">https://lancedb.github.io/lancedb/basic/#note-bundling-vectordb-apps-with-webpack</a></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1148169165685936140 class=chatlog__message-container data-message-id=1148169165685936140><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/689455295382290577/48af246caf9ca0fd62c048f291564a50.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=cristi2599 data-user-id=689455295382290577>Cristi</span> <span class=chatlog__timestamp title="Monday, September 4, 2023 8:14â€¯AM"><a href=#chatlog__message-container-1148169165685936140>9/4/2023 8:14â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I don&#39;t use webpack, I simply have a different architecture. I use <a href="https://github.com/Genez-io/genezio">https://github.com/Genez-io/genezio</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/Genez-io/genezio><div class="chatlog__markdown chatlog__markdown-preserve">GitHub - Genez-io/genezio: The easiest way to write and host a serv...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">The easiest way to write and host a serverless application - GitHub - Genez-io/genezio: The easiest way to write and host a serverless application</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/OMDnmjbNKfKVxtEA-t2Bf-lXCv_oZYkmfSIq3sNblVk/https/opengraph.githubassets.com/460b271010a26bf0c068e8678c27be6f80c35eacc75441e6d789a33433058328/Genez-io/genezio> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/OMDnmjbNKfKVxtEA-t2Bf-lXCv_oZYkmfSIq3sNblVk/https/opengraph.githubassets.com/460b271010a26bf0c068e8678c27be6f80c35eacc75441e6d789a33433058328/Genez-io/genezio alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1148173153248489496 class=chatlog__message-container data-message-id=1148173153248489496><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=ayushexel data-user-id=1032079688887189556>AyushC</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, September 4, 2023 8:30â€¯AM"> <a href=#chatlog__message-container-1148173153248489496>9/4/2023 8:30â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1148303739099283466 class=chatlog__message-container data-message-id=1148303739099283466><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/635507634342068228/10b4f881ceeef234f556cbd1dc05f739.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=cat_ethos>catethos</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1147929070118641774')"> <em>Click to see attachment</em> <span>ðŸ–¼ï¸</span> </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Monday, September 4, 2023 5:09â€¯PM"><a href=#chatlog__message-container-1148303739099283466>9/4/2023 5:09â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This is due our implementation is missing some details. Filed <a href="https://github.com/lancedb/lancedb/issues/473">https://github.com/lancedb/lancedb/issues/473</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/473><div class="chatlog__markdown chatlog__markdown-preserve">[Python] Pydantic vector field does not take default value &#183; Issue ...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Problem Statement We have provide a vector field for Pydantic based models. However the vector field does not take default value as others default fields.</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/ULKFICVLD6kKGwedxhtASvMuoZIS7vMMbEJfHoJ4oSc/https/opengraph.githubassets.com/25483bb62d82b0f8667fb862b315885d6b0d67d836ac26eb5651c69b4c17beb5/lancedb/lancedb/issues/473> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/ULKFICVLD6kKGwedxhtASvMuoZIS7vMMbEJfHoJ4oSc/https/opengraph.githubassets.com/25483bb62d82b0f8667fb862b315885d6b0d67d836ac26eb5651c69b4c17beb5/lancedb/lancedb/issues/473 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1148304582523498556 class=chatlog__message-container data-message-id=1148304582523498556><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/635507634342068228/10b4f881ceeef234f556cbd1dc05f739.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1148303739099283466')"> This is due our implementation is missing some details. Filed <a href="https://github.com/lancedb/lancedb/issues/473">https://github.com/lancedb/lancedb/issues/473</a> </span></div></div><div class=chatlog__header><span class=chatlog__author title=cat_ethos data-user-id=635507634342068228>catethos</span> <span class=chatlog__timestamp title="Monday, September 4, 2023 5:12â€¯PM"><a href=#chatlog__message-container-1148304582523498556>9/4/2023 5:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>currently my workaround is &#39;from lancedb.pydantic import vector as Vector&#39; then it works even with default value</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1148305899899863094 class=chatlog__message-container data-message-id=1148305899899863094><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Monday, September 4, 2023 5:17â€¯PM"><a href=#chatlog__message-container-1148305899899863094>9/4/2023 5:17â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hmm, that&#39;s interesting that is it just a Cap vs lower case thing.   We will add some tests and update doc then</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1148319971802370063 class=chatlog__message-container data-message-id=1148319971802370063><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, September 4, 2023 6:13â€¯PM"> <a href=#chatlog__message-container-1148319971802370063>9/4/2023 6:13â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1149689848844791819 class=chatlog__message-container data-message-id=1149689848844791819><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=ramvenka data-user-id=1148597577713975357>Ram Kumar</span> <span class=chatlog__timestamp title="Friday, September 8, 2023 12:57â€¯PM"><a href=#chatlog__message-container-1149689848844791819>9/8/2023 12:57â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>The vec_to_table function fails if the input data has a length of 1. The error message is not clear about the reason for the failure, so it is not obvious that it is due to the length of the data. It is not clear if this is intentional or not.</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1149689848664428594/Screen_Shot_2023-09-08_at_5.53.39_AM.png?ex=698a825c&amp;is=698930dc&amp;hm=cfd97f65463fa3367cc996a1f0e6f3296d90424609f583bccf3fa1f7c425c4ae&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1149689848664428594/Screen_Shot_2023-09-08_at_5.53.39_AM.png?ex=698a825c&amp;is=698930dc&amp;hm=cfd97f65463fa3367cc996a1f0e6f3296d90424609f583bccf3fa1f7c425c4ae&amp;" alt="Image attachment" title="Image: Screen_Shot_2023-09-08_at_5.53.39_AM.png (65.05 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1149708993774764112 class=chatlog__message-container data-message-id=1149708993774764112><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, September 8, 2023 2:13â€¯PM"><a href=#chatlog__message-container-1149708993774764112>9/8/2023 2:13â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>What was the error message?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1149730792285675540 class=chatlog__message-container data-message-id=1149730792285675540><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, September 8, 2023 3:39â€¯PM"><a href=#chatlog__message-container-1149730792285675540>9/8/2023 3:39â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m not sure I&#39;m getting the same error:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight"># works
x = lance.vector.vec_to_table([[1]])
# works
x = lance.vector.vec_to_table({&quot;x&quot;: [1]})
# works
lance.vector.vec_to_table(np.array([[1]]))</code>

I do get some potentially confusing errors if the input is a 1d array (or an empty 2d array):

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight"># object of type &#39;...&#39; has no len()
lance.vector.vec_to_table([1])
lance.vector.vec_to_table(np.array([1]))
# StopIteration
lance.vector.vec_to_table({})
lance.vector.vec_to_table(np.array([]))</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1149744799952420934 class=chatlog__message-container data-message-id=1149744799952420934><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1149708993774764112')"> What was the error message? </span></div></div><div class=chatlog__header><span class=chatlog__author title=ramvenka data-user-id=1148597577713975357>Ram Kumar</span> <span class=chatlog__timestamp title="Friday, September 8, 2023 4:35â€¯PM"><a href=#chatlog__message-container-1149744799952420934>9/8/2023 4:35â€¯PM</a></span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1149744799742689322/Screen_Shot_2023-09-08_at_9.34.43_AM.png?ex=698a0cc9&amp;is=6988bb49&amp;hm=ede6a21066533a925dfceb8cdb04addf2255717087ad8d579a6a0e65d3ea41a7&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1149744799742689322/Screen_Shot_2023-09-08_at_9.34.43_AM.png?ex=698a0cc9&amp;is=6988bb49&amp;hm=ede6a21066533a925dfceb8cdb04addf2255717087ad8d579a6a0e65d3ea41a7&amp;" alt="Image attachment" title="Image: Screen_Shot_2023-09-08_at_9.34.43_AM.png (118.14 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1149745624904900660 class=chatlog__message-container data-message-id=1149745624904900660><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, September 8, 2023 4:38â€¯PM"><a href=#chatlog__message-container-1149745624904900660>9/8/2023 4:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>mind printing <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">question_embeddings</code>  ?</span></div></div></div></div><div id=chatlog__message-container-1149745752621457428 class=chatlog__message-container data-message-id=1149745752621457428><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, September 8, 2023 4:39â€¯PM">4:39â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>seems like it&#39;s passing in [float] instead of [[float]] ?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1149745903532527777 class=chatlog__message-container data-message-id=1149745903532527777><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, September 8, 2023 4:39â€¯PM"><a href=#chatlog__message-container-1149745903532527777>9/8/2023 4:39â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We could maybe convert [float] to a table with 1 row</span></div></div></div></div><div id=chatlog__message-container-1149745993529696267 class=chatlog__message-container data-message-id=1149745993529696267><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, September 8, 2023 4:40â€¯PM">4:40â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We can certainly improve the error in this case</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1149746644166910022 class=chatlog__message-container data-message-id=1149746644166910022><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, September 8, 2023 4:42â€¯PM"><a href=#chatlog__message-container-1149746644166910022>9/8/2023 4:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yeah for sure</span></div></div></div></div><div id=chatlog__message-container-1149747699634163712 class=chatlog__message-container data-message-id=1149747699634163712><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, September 8, 2023 4:46â€¯PM">4:46â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="ramvenka">@Ram Kumar</span> appreciate the reports. Would you mind filing a github issue: <a href="https://github.com/lancedb/lance/issues">https://github.com/lancedb/lance/issues</a> so we don&#39;t lose track of it?</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues><div class="chatlog__markdown chatlog__markdown-preserve">Issues &#183; lancedb/lance</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Modern columnar data format for ML and LLMs implemented in Rust. Convert from parquet in 2 lines of code for 100x faster random access, vector index, and data versioning. Compatible with Pandas, Du...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/PnYFpFHeTiJc9AN2n6emsQNZQasY5dAdfadTFDhiD58/https/opengraph.githubassets.com/239305165c80935326da17f5243c92dde82cbe72313d59f3d9aafc588c55afe3/lancedb/lance> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/PnYFpFHeTiJc9AN2n6emsQNZQasY5dAdfadTFDhiD58/https/opengraph.githubassets.com/239305165c80935326da17f5243c92dde82cbe72313d59f3d9aafc588c55afe3/lancedb/lance alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div><div id=chatlog__message-container-1149747704231116841 class=chatlog__message-container data-message-id=1149747704231116841><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, September 8, 2023 4:46â€¯PM">4:46â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>thanks!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1152970328704831658 class=chatlog__message-container data-message-id=1152970328704831658><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/635507634342068228/10b4f881ceeef234f556cbd1dc05f739.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=cat_ethos data-user-id=635507634342068228>catethos</span> <span class=chatlog__timestamp title="Sunday, September 17, 2023 2:12â€¯PM"><a href=#chatlog__message-container-1152970328704831658>9/17/2023 2:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>call the &#39;create_fts_index&#39; twice will double the index instead of replacing it, i.e. i would get twice of the same row when i do the search</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1153025790770954352 class=chatlog__message-container data-message-id=1153025790770954352><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/635507634342068228/10b4f881ceeef234f556cbd1dc05f739.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=cat_ethos>catethos</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1152970328704831658')"> call the &#39;create_fts_index&#39; twice will double the index instead of replacing it, i.e. i would get twice of the same row when i do the search </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Sunday, September 17, 2023 5:52â€¯PM"><a href=#chatlog__message-container-1153025790770954352>9/17/2023 5:52â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thatâ€™s a bug. Thanks for the heads up</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1153414604102311946 class=chatlog__message-container data-message-id=1153414604102311946><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, September 18, 2023 7:37â€¯PM"><a href=#chatlog__message-container-1153414604102311946>9/18/2023 7:37â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="andrew.aisr">@andrew.aisr</span> this is the bug fix (thanks to <span class="chatlog__markdown-mention" title="chebbychefneq">@Rob Meng</span> ) <a href="https://github.com/lancedb/lancedb/pull/500">https://github.com/lancedb/lancedb/pull/500</a> we&#39;ll make a release this week with the fix</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/pull/500><div class="chatlog__markdown chatlog__markdown-preserve">refactor connection string processing by chebbyChefNEQ &#183; Pull Reque...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">in #486 connect started converting path into uri. However, the PR didn&#39;t handle relative path and appended file:// to relative path.
This PR changes the parsing strat to be more rational. If a ...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/GaBKt7XtTQbRgsiJGq0H06ZezmpprqLP9_1zINY8FGA/https/opengraph.githubassets.com/ffc1affb3fa5f38dbae4784e36d5c14512b47f3cacb138cef43e5fd6eb3a429e/lancedb/lancedb/pull/500> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/GaBKt7XtTQbRgsiJGq0H06ZezmpprqLP9_1zINY8FGA/https/opengraph.githubassets.com/ffc1affb3fa5f38dbae4784e36d5c14512b47f3cacb138cef43e5fd6eb3a429e/lancedb/lancedb/pull/500 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1153916242307076156 class=chatlog__message-container data-message-id=1153916242307076156><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/311055455248056320/65f2e4b9b2c48c82a6caba7d52cc7df4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=vlozg data-user-id=311055455248056320>VLoZg</span> <span class=chatlog__timestamp title="Wednesday, September 20, 2023 4:51â€¯AM"><a href=#chatlog__message-container-1153916242307076156>9/20/2023 4:51â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, I&#39;ve stumbled upon a bug while using Lance with DuckDB that&#39;s causing issues when trying to read Lance datasets after merging with columns from DuckDB.

Error message: 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ArrowInvalid: C Data interface error: Io error: Execution error: External error: Execution error: LanceError(Arrow): Invalid argument error: column types must match schema types, expected List(Field { name: &quot;l&quot;, data_type: Float64, nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} }) but found List(Field { name: &quot;item&quot;, data_type: Float64, nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} }) at column index 0</code>

Library version: Lance 0.7.5, DuckDB 0.8.1

Here&#39;s what I did:
<ul><li>Have a DuckDB query that produced a table with column of type <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">DOUBLE[]</code> (which equivalent to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">list_(float64())</code> in Arrow type)</li><li>Merge the query result with Lance dataset using <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">RecordBatchReader</code> (using <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.fetch_arrow_reader()</code> from DuckDB relation)</li><li>Try to read Lance dataset, either via DuckDB query or simply call <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ds.to_table()</code>

I noticed that ListType column produced by DuckDB is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">list&lt;l: double&gt;</code>, while ListType created by Arrow by default is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">list&lt;item: double&gt;</code>. I&#39;m wondering if it&#39;s possible to have a fix that ignore this discrepancy, as lists logically have one data type across their elements, and there is no field name associated with list items.</li></ul></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1153918896156463114 class=chatlog__message-container data-message-id=1153918896156463114><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/311055455248056320/65f2e4b9b2c48c82a6caba7d52cc7df4.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=vlozg>VLoZg</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1153916242307076156')"> Hi, I&#39;ve stumbled upon a bug while using Lance with DuckDB that&#39;s causing issues when trying to read Lance datasets after merging with columns from DuckDB.

Error message: 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ArrowInvalid: C Data interface error: Io error: Execution error: External error: Execution error: LanceError(Arrow): Invalid argument error: column types must match schema types, expected List(Field { name: &quot;l&quot;, data_type: Float64, nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} }) but found List(Field { name: &quot;item&quot;, data_type: Float64, nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} }) at column index 0</code>

Library version: Lance 0.7.5, DuckDB 0.8.1

Here&#39;s what I did:
<ul><li>Have a DuckDB query that produced a table with column of type <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">DOUBLE[]</code> (which equivalent to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">list_(float64())</code> in Arrow type)</li><li>Merge the query result with Lance dataset using <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">RecordBatchReader</code> (using <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.fetch_arrow_reader()</code> from DuckDB relation)</li><li>Try to read Lance dataset, either via DuckDB query or simply call <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ds.to_table()</code>

I noticed that ListType column produced by DuckDB is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">list&lt;l: double&gt;</code>, while ListType created by Arrow by default is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">list&lt;item: double&gt;</code>. I&#39;m wondering if it&#39;s possible to have a fix that ignore this discrepancy, as lists logically have one data type across their elements, and there is no field name associated with list items.</li></ul> </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Wednesday, September 20, 2023 5:01â€¯AM"><a href=#chatlog__message-container-1153918896156463114>9/20/2023 5:01â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">I&#39;m wondering if it&#39;s possible to have a fix that ignore this discrepancy, as lists logically have one data type across their elements, and there is no field name associated with list items.
</div></div>Yes, ideally we should be able to ignore this field name. The error comes from upstream in arrow-rs, so we&#39;ll likely have to push a fix up there.</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=raised_hands><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™Œ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64c.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154788430216187944 class=chatlog__message-container data-message-id=1154788430216187944><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Friday, September 22, 2023 2:36â€¯PM"><a href=#chatlog__message-container-1154788430216187944>9/22/2023 2:36â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Should the s3+ddb protocol be working via the JavaScript API? I&#39;m getting this error: &quot;Unsupported URI scheme: s3+ddb.&quot;</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154793966273843271 class=chatlog__message-container data-message-id=1154793966273843271><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=lincolncannon>Lincoln Cannon</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1154788430216187944')"> Should the s3+ddb protocol be working via the JavaScript API? I&#39;m getting this error: &quot;Unsupported URI scheme: s3+ddb.&quot; </span></div></div><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Friday, September 22, 2023 2:58â€¯PM"><a href=#chatlog__message-container-1154793966273843271>9/22/2023 2:58â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Never mind. Needed to install a newer version of the API. Sorry.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154794475705598092 class=chatlog__message-container data-message-id=1154794475705598092><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, September 22, 2023 3:00â€¯PM"><a href=#chatlog__message-container-1154794475705598092>9/22/2023 3:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Glad you got your problem resolved!</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154796567233036379 class=chatlog__message-container data-message-id=1154796567233036379><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1154794475705598092')"> Glad you got your problem resolved! </span></div></div><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Friday, September 22, 2023 3:09â€¯PM"><a href=#chatlog__message-container-1154796567233036379>9/22/2023 3:09â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>But I&#39;ve bumped into another problem. I probably just don&#39;t have the URI formatted correctly?

URI:

s3+ddb://lancedb.lincolncannon.co/LincolnCannonText/dev?ddbTableName=LincolnCannonLLCLanceDB-dev

Error:

Invalid user input: <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">s3+ddb://</code> scheme and expects exactly one query <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ddbTableName</code></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154802293498196130 class=chatlog__message-container data-message-id=1154802293498196130><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Friday, September 22, 2023 3:32â€¯PM"><a href=#chatlog__message-container-1154802293498196130>9/22/2023 3:32â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I can reproduce that. There must be some bug in the JS SDK.</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154804901210230854 class=chatlog__message-container data-message-id=1154804901210230854><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Friday, September 22, 2023 3:42â€¯PM"><a href=#chatlog__message-container-1154804901210230854>9/22/2023 3:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I think it&#39;s not supported as a stable API yet in the node SDK, but you can do this for now:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">s3://lancedb.lincolncannon.co/LincolnCannonText/dev?engine=ddb&amp;ddbTableName=LincolnCannonLLCLanceDB-dev</code>
cc <span class="chatlog__markdown-mention" title="chebbychefneq">@Rob Meng</span> did I get this right?</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154843916005285999 class=chatlog__message-container data-message-id=1154843916005285999><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/913676166710300702/6b6717abdabca8374840c6ce3c3801d5.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chebbychefneq data-user-id=913676166710300702>Rob Meng</span> <span class=chatlog__timestamp title="Friday, September 22, 2023 6:17â€¯PM"><a href=#chatlog__message-container-1154843916005285999>9/22/2023 6:17â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yep for lancedb ^^ this one should work

the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">s3+ddb</code> scheme is for lance format directly</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154882541749285055 class=chatlog__message-container data-message-id=1154882541749285055><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Friday, September 22, 2023 8:50â€¯PM"><a href=#chatlog__message-container-1154882541749285055>9/22/2023 8:50â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thank you, both.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154966388075675661 class=chatlog__message-container data-message-id=1154966388075675661><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, September 23, 2023 2:24â€¯AM"><a href=#chatlog__message-container-1154966388075675661>9/23/2023 2:24â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Unfortunately, that doesn&#39;t work either. Same error message: 

Invalid user input: <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">s3+ddb://</code> scheme and expects exactly one query <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ddbTableName</code></span></div></div></div></div><div id=chatlog__message-container-1154966809611616326 class=chatlog__message-container data-message-id=1154966809611616326><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, September 23, 2023 2:25â€¯AM">2:25â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Oh. I just noticed that you removed the &quot;ddb&quot; from the protocol in the example you gave me. Overlooked it.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1154972036897194045 class=chatlog__message-container data-message-id=1154972036897194045><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, September 23, 2023 2:46â€¯AM"><a href=#chatlog__message-container-1154972036897194045>9/23/2023 2:46â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>... and that worked -- well, at least it ran without errors.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1155168473018794014 class=chatlog__message-container data-message-id=1155168473018794014><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lincolncannon data-user-id=800391234060943441>Lincoln Cannon</span> <span class=chatlog__timestamp title="Saturday, September 23, 2023 3:47â€¯PM"><a href=#chatlog__message-container-1155168473018794014>9/23/2023 3:47â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yep. It worked! Hundreds of concurrent threads populated data without problems. Great enhancement! Thanks, all.</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=tada><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸŽ‰ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f389.svg loading=lazy> <span class=chatlog__reaction-count>3</span></div><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1155178146983858297 class=chatlog__message-container data-message-id=1155178146983858297><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/800391234060943441/a111219198a4f2b9ddd2211c587a2e65.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=lincolncannon>Lincoln Cannon</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1155168473018794014')"> Yep. It worked! Hundreds of concurrent threads populated data without problems. Great enhancement! Thanks, all. </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, September 23, 2023 4:25â€¯PM"><a href=#chatlog__message-container-1155178146983858297>9/23/2023 4:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hundreds of threads populating data sounds fun! Would love to find out more about your use case.</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=shushing_face><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ¤« src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f92b.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1155949275721768960 class=chatlog__message-container data-message-id=1155949275721768960><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/311055455248056320/65f2e4b9b2c48c82a6caba7d52cc7df4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=vlozg data-user-id=311055455248056320>VLoZg</span> <span class=chatlog__timestamp title="Monday, September 25, 2023 7:29â€¯PM"><a href=#chatlog__message-container-1155949275721768960>9/25/2023 7:29â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, I have just encounter when trying to read dataset after merge.

Error message:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">InvalidInputException: Invalid Input Error: arrow_scan: get_next failed(): Invalid: C Data interface error: Io error: Execution error: External error: Execution error: LanceError(Arrow): Invalid argument error: Need at least 5376 bytes in buffers[0] in array of type Int64, but got 4978</code>
What I have done:
<ul><li>Open lance dataset in S3 via <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance.dataset</code></li><li>Perform vector computation using DuckDB UDF, then merge to dataset. (In the process, there also many times the merge failed due to error in computation)</li><li>When I try to read the dataset afterward, I can only select new column without error. If I try to read old columns, the error message above will appear</li><li>During open lance dataset and merge I didn&#39;t use commit lock (but that shouldn&#39;t be a problem if I was the only one who access the dataset, right?)

When I try precompute vector data and store in local machine, then merge back to a new dataset, the error won&#39;t happened. Have I done anything wrong in the process?</li></ul></span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1155949275428175943/image.png?ex=698a35a7&amp;is=6988e427&amp;hm=114f62a494e576ba6cd7e1fd3cf9036b4858f803df3787d49e33cce9232d00d8&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1155949275428175943/image.png?ex=698a35a7&amp;is=6988e427&amp;hm=114f62a494e576ba6cd7e1fd3cf9036b4858f803df3787d49e33cce9232d00d8&amp;" alt="Image attachment" title="Image: image.png (98.61 KB)" loading=lazy> </a></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1155950964675727501 class=chatlog__message-container data-message-id=1155950964675727501><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/311055455248056320/65f2e4b9b2c48c82a6caba7d52cc7df4.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=vlozg>VLoZg</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1155949275721768960')"> Hi, I have just encounter when trying to read dataset after merge.

Error message:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">InvalidInputException: Invalid Input Error: arrow_scan: get_next failed(): Invalid: C Data interface error: Io error: Execution error: External error: Execution error: LanceError(Arrow): Invalid argument error: Need at least 5376 bytes in buffers[0] in array of type Int64, but got 4978</code>
What I have done:
<ul><li>Open lance dataset in S3 via <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance.dataset</code></li><li>Perform vector computation using DuckDB UDF, then merge to dataset. (In the process, there also many times the merge failed due to error in computation)</li><li>When I try to read the dataset afterward, I can only select new column without error. If I try to read old columns, the error message above will appear</li><li>During open lance dataset and merge I didn&#39;t use commit lock (but that shouldn&#39;t be a problem if I was the only one who access the dataset, right?)

When I try precompute vector data and store in local machine, then merge back to a new dataset, the error won&#39;t happened. Have I done anything wrong in the process?</li></ul> </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Monday, September 25, 2023 7:36â€¯PM"><a href=#chatlog__message-container-1155950964675727501>9/25/2023 7:36â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">During open lance dataset and merge I didn&#39;t use commit lock (but that shouldn&#39;t be a problem if I was the only one who access the dataset, right?)
</div></div>Yeah that won&#39;t be an issue.
<div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">Have I done anything wrong in the process?
</div></div>Are you saying the same steps work locally but not on S3?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158523560927703141 class=chatlog__message-container data-message-id=1158523560927703141><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Monday, October 2, 2023 9:59â€¯PM"><a href=#chatlog__message-container-1158523560927703141>10/2/2023 9:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello
I am new to lancedb
I am experiencing an issue which I don&#39;t know if it is a bug or simply inexperience.
I added some 100 items into a table, but when I query it, I always get the same single row despite that the distance is 0.4, and that I use exactly a vector that is in the table
does anyone else getting similar issue?
thx</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158526197265858641 class=chatlog__message-container data-message-id=1158526197265858641><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, October 2, 2023 10:09â€¯PM"><a href=#chatlog__message-container-1158526197265858641>10/2/2023 10:09â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>would you be able to share your data / code to help us reproduce it?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158853730477805658 class=chatlog__message-container data-message-id=1158853730477805658><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158526197265858641')"> would you be able to share your data / code to help us reproduce it? </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 7:50â€¯PM"><a href=#chatlog__message-container-1158853730477805658>10/3/2023 7:50â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i have like 700 of these lancedb files. each one containing a text and the embeddings vector.

003a3779-7872-437e-a5ec-ad29906b589c.lance
008f7c73-0e2b-47eb-a9fe-780d44fc9d48.lance
009332cd-10ba-4d08-8394-2b396c3baa44.lance
009364f2-9156-4eff-b2d1-29896b6f11e5.lance
0148b0d9-10f9-435c-8eb0-920bd00a60d2.lance
01b18e95-d8ee-43d6-af84-27ef7d78a619.lance
0228aa9b-5a8c-49b2-96af-c63893f08648.lance
022afdbd-57a4-4e51-9ecf-6e234d55e1cf.lance
029c13ae-4ad5-4c9f-a726-eb7f93fd1848.lance
0303af44-83f7-4447-afc7-ae4043727447.lance
03283efa-6bd1-4776-8090-8a613db2d827.lance
033e5d11-3ad6-4d82-8d2d-661f9c5b07ee.lance
038cccc1-e833-467c-888c-dc350e08338c.lance
03932d1a-e07c-48a3-8c9f-0f07b9a4ff77.lance
03d22d2d-07a4-4460-b3df-af3eb2248158.lance
046a4661-fd44-48d2-b1e9-413c90c5740d.lance
04b3d5f5-92c8-4a9b-b94f-544da09a07ba.lance
05477753-143f-4401-b057-24bf8fb40322.lance
05d95ac5-917d-4d8d-9dfd-2efa612a3e24.lance
05dc4182-d95e-4a45-96c6-8a858c8d5992.lance
069366e1-bbf6-4429-912e-9b964b7ea151.lance
070985a0-9e77-4390-8b6a-6977d3adc2b5.lance
07876e7e-9c0f-4d7f-91d4-a27cfa2fc9b6.lance
07b2fd89-2e37-4bf9-a519-884d4ea4968f.lance
07e08f33-6a18-49e6-9179-724ea8ae2ffc.lance
08660a72-a74e-4905-8e79-de022b51c377.lance
08921a9b-7d8d-4230-9fd6-9fef644ae47e.lance
0b265e87-53d7-4d3a-b09f-6e5a813ce4c7.lance
0b7aa88a-d6ce-4ab2-aa2a-a2c247f34148.lance
0ba3d5f1-7c06-4b9c-a7ba-9a7be90cac5e.lance
0bc533ef-279b-4e5e-bcc1-4952e173653a.lance
0bc7af30-d7a7-422f-aa88-4abe486a2e01.lance

I opened one of them and copied the text, then using the same OpenAI service I generated the embeddings of the text then tried to retrieve it
embeddings_model = OpenAIEmbeddings()
embeddings = embeddings_model.embed_documents([text])
result = my_table.search(embeddings[0],vector_column_name=&#39;vector&#39;).metric(&#39;L2&#39;).limit(10).to_df()</span> <span class=chatlog__edited-timestamp title="Tuesday, October 3, 2023 7:54â€¯PM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1158854023047286855 class=chatlog__message-container data-message-id=1158854023047286855><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, October 3, 2023 7:52â€¯PM">7:52â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the result is ONLY one row (despite the limit is 10) and the it does not contain the row from which I took the text, and above all of that the distance is 0.5</span></div></div></div></div><div id=chatlog__message-container-1158854072493932584 class=chatlog__message-container data-message-id=1158854072493932584><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, October 3, 2023 7:52â€¯PM">7:52â€¯PM</div></div><div class=chatlog__message-primary><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1158854072212918413/image.png?ex=698a3af5&amp;is=6988e975&amp;hm=7fddca587b5412ded5ad6ff14a674a6e54ca60fd945cc7ac78fe0bab8e2e4d4f&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1158854072212918413/image.png?ex=698a3af5&amp;is=6988e975&amp;hm=7fddca587b5412ded5ad6ff14a674a6e54ca60fd945cc7ac78fe0bab8e2e4d4f&amp;" alt="Image attachment" title="Image: image.png (15.86 KB)" loading=lazy> </a></div></div></div></div><div id=chatlog__message-container-1158854197597450351 class=chatlog__message-container data-message-id=1158854197597450351><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, October 3, 2023 7:52â€¯PM">7:52â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I don&#39;t know if you are able to get any idea from this</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158858277564719155 class=chatlog__message-container data-message-id=1158858277564719155><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=_.zys._>zys</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158853730477805658')"> i have like 700 of these lancedb files. each one containing a text and the embeddings vector.

003a3779-7872-437e-a5ec-ad29906b589c.lance
008f7c73-0e2b-47eb-a9fe-780d44fc9d48.lance
009332cd-10ba-4d08-8394-2b396c3baa44.lance
009364f2-9156-4eff-b2d1-29896b6f11e5.lance
0148b0d9-10f9-435c-8eb0-920bd00a60d2.lance
01b18e95-d8ee-43d6-af84-27ef7d78a619.lance
0228aa9b-5a8c-49b2-96af-c63893f08648.lance
022afdbd-57a4-4e51-9ecf-6e234d55e1cf.lance
029c13ae-4ad5-4c9f-a726-eb7f93fd1848.lance
0303af44-83f7-4447-afc7-ae4043727447.lance
03283efa-6bd1-4776-8090-8a613db2d827.lance
033e5d11-3ad6-4d82-8d2d-661f9c5b07ee.lance
038cccc1-e833-467c-888c-dc350e08338c.lance
03932d1a-e07c-48a3-8c9f-0f07b9a4ff77.lance
03d22d2d-07a4-4460-b3df-af3eb2248158.lance
046a4661-fd44-48d2-b1e9-413c90c5740d.lance
04b3d5f5-92c8-4a9b-b94f-544da09a07ba.lance
05477753-143f-4401-b057-24bf8fb40322.lance
05d95ac5-917d-4d8d-9dfd-2efa612a3e24.lance
05dc4182-d95e-4a45-96c6-8a858c8d5992.lance
069366e1-bbf6-4429-912e-9b964b7ea151.lance
070985a0-9e77-4390-8b6a-6977d3adc2b5.lance
07876e7e-9c0f-4d7f-91d4-a27cfa2fc9b6.lance
07b2fd89-2e37-4bf9-a519-884d4ea4968f.lance
07e08f33-6a18-49e6-9179-724ea8ae2ffc.lance
08660a72-a74e-4905-8e79-de022b51c377.lance
08921a9b-7d8d-4230-9fd6-9fef644ae47e.lance
0b265e87-53d7-4d3a-b09f-6e5a813ce4c7.lance
0b7aa88a-d6ce-4ab2-aa2a-a2c247f34148.lance
0ba3d5f1-7c06-4b9c-a7ba-9a7be90cac5e.lance
0bc533ef-279b-4e5e-bcc1-4952e173653a.lance
0bc7af30-d7a7-422f-aa88-4abe486a2e01.lance

I opened one of them and copied the text, then using the same OpenAI service I generated the embeddings of the text then tried to retrieve it
embeddings_model = OpenAIEmbeddings()
embeddings = embeddings_model.embed_documents([text])
result = my_table.search(embeddings[0],vector_column_name=&#39;vector&#39;).metric(&#39;L2&#39;).limit(10).to_df() </span> <span class=chatlog__reply-edited-timestamp title="Tuesday, October 3, 2023 7:54â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 8:09â€¯PM"><a href=#chatlog__message-container-1158858277564719155>10/3/2023 8:09â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>That&#39;s interesting. You have called <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">create_index()</code> on this table, correct?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158863797453340824 class=chatlog__message-container data-message-id=1158863797453340824><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 8:30â€¯PM"><a href=#chatlog__message-container-1158863797453340824>10/3/2023 8:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It&#39;s possible the ANN index isn&#39;t performing well. You can see the exact KNN results with:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-python">my_table.to_lance().to_table(nearest={
    &quot;k&quot;: 10,
    &quot;metric&quot;: &quot;L2&quot;,
    &quot;column&quot;: &quot;vector&quot;,
    &quot;q&quot;: embeddings[0],
    &quot;use_index&quot;: False,
})</code>
Does that provide 10 results on your table?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158869073967448124 class=chatlog__message-container data-message-id=1158869073967448124><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158858277564719155')"> That&#39;s interesting. You have called <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">create_index()</code> on this table, correct? </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 8:51â€¯PM"><a href=#chatlog__message-container-1158869073967448124>10/3/2023 8:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>actually I just figured out the reason, but it looks more weird to me, probably because I am new to this.
In order to make things work, meaning got the right result and 10 rows, when adding to the table I had to insert all the data in one array, meaning if I had 10K rows, I had to put them in one array then call my_table.add(rows, mode=&quot;overwrite&quot;)
This will create one lance file in the filesystem, and the query behaves as expected.
If I call my_table.add(some_rows, mode=&quot;overwrite&quot;) many times, I will get several lance files on disk, totaling the number of calls to add()!
but the query does not behave as expected.
You can agree that having to put everything in one array is not practical
what am I doing wrong?</span> <span class=chatlog__edited-timestamp title="Tuesday, October 3, 2023 8:53â€¯PM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1158869234554773655 class=chatlog__message-container data-message-id=1158869234554773655><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, October 3, 2023 8:52â€¯PM">8:52â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>to reply to your question, I am not using index for the time being, I just want to make the thing work then I optimize</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158869987012915310 class=chatlog__message-container data-message-id=1158869987012915310><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 8:55â€¯PM"><a href=#chatlog__message-container-1158869987012915310>10/3/2023 8:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">but the query does not behave as expected.
</div></div>That certainly sounds like some sort of bug.</span></div></div></div></div><div id=chatlog__message-container-1158870289908768819 class=chatlog__message-container data-message-id=1158870289908768819><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, October 3, 2023 8:56â€¯PM">8:56â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Wait, why are you running with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">mode=&quot;overwrite&quot;</code>? don&#39;t you want <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">mode=&quot;append&quot;</code> to add new rows?</span></div></div></div></div><div id=chatlog__message-container-1158870391356403913 class=chatlog__message-container data-message-id=1158870391356403913><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, October 3, 2023 8:57â€¯PM">8:57â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&quot;overwrite&quot;</code> means &quot;delete all rows in the table, then add these rows&quot;</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158870945671430264 class=chatlog__message-container data-message-id=1158870945671430264><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158870391356403913')"> <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&quot;overwrite&quot;</code> means &quot;delete all rows in the table, then add these rows&quot; </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 8:59â€¯PM"><a href=#chatlog__message-container-1158870945671430264>10/3/2023 8:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I thought &quot;overwrite&quot; won&#39;t through an exception if I have the same vector already stored, just like inserting the same key in a relational db?!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158871190841086063 class=chatlog__message-container data-message-id=1158871190841086063><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:00â€¯PM"><a href=#chatlog__message-container-1158871190841086063>10/3/2023 9:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ah no. I just means replace the table with the new data.</span></div></div></div></div><div id=chatlog__message-container-1158871318960283658 class=chatlog__message-container data-message-id=1158871318960283658><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, October 3, 2023 9:00â€¯PM">9:00â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We don&#39;t have upsert implemented yet, but that&#39;s being tracked in <a href="https://github.com/lancedb/lancedb/issues/524">https://github.com/lancedb/lancedb/issues/524</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/524><div class="chatlog__markdown chatlog__markdown-preserve">Support UPSERT in LanceDB &#183; Issue #524 &#183; lancedb/lancedb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Problem Statement Support upsert in LanceDB to allow user update data</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/7Qe5_OKdsxSb8NZ2bCkjuOiUh0i9u0GHxHWQL8p1q0Y/https/opengraph.githubassets.com/c656ea3c0e018d846e84883e3eccb01105aa7e7874dd4f6cabcc494440381ce4/lancedb/lancedb/issues/524> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/7Qe5_OKdsxSb8NZ2bCkjuOiUh0i9u0GHxHWQL8p1q0Y/https/opengraph.githubassets.com/c656ea3c0e018d846e84883e3eccb01105aa7e7874dd4f6cabcc494440381ce4/lancedb/lancedb/issues/524 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158871402733121587 class=chatlog__message-container data-message-id=1158871402733121587><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:01â€¯PM"><a href=#chatlog__message-container-1158871402733121587>10/3/2023 9:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>what happens if I have the same data inserted in the case of &#39;append&#39;?</span> <span class=chatlog__edited-timestamp title="Tuesday, October 3, 2023 9:01â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158871444831338612 class=chatlog__message-container data-message-id=1158871444831338612><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:01â€¯PM"><a href=#chatlog__message-container-1158871444831338612>10/3/2023 9:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>You could call <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.delete(&quot;id = {old_id}&quot;)</code> and then <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.add(new_row, mode=&quot;append&quot;)</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158871516184854559 class=chatlog__message-container data-message-id=1158871516184854559><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158871444831338612')"> You could call <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.delete(&quot;id = {old_id}&quot;)</code> and then <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.add(new_row, mode=&quot;append&quot;)</code> </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:01â€¯PM"><a href=#chatlog__message-container-1158871516184854559>10/3/2023 9:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ok</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158871523092861129 class=chatlog__message-container data-message-id=1158871523092861129><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=_.zys._>zys</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158871402733121587')"> what happens if I have the same data inserted in the case of &#39;append&#39;? </span> <span class=chatlog__reply-edited-timestamp title="Tuesday, October 3, 2023 9:01â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:01â€¯PM"><a href=#chatlog__message-container-1158871523092861129>10/3/2023 9:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Same things as INSERT in SQL, you will have duplicate rows.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158871650717147206 class=chatlog__message-container data-message-id=1158871650717147206><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158871523092861129')"> Same things as INSERT in SQL, you will have duplicate rows. </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:02â€¯PM"><a href=#chatlog__message-container-1158871650717147206>10/3/2023 9:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ook I will give it a try, thank you</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158874031391506514 class=chatlog__message-container data-message-id=1158874031391506514><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158871523092861129')"> Same things as INSERT in SQL, you will have duplicate rows. </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:11â€¯PM"><a href=#chatlog__message-container-1158874031391506514>10/3/2023 9:11â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this is an update. I used &#39;append&#39; instead of &#39;overwrite&#39;, I got hundreds of lance files instead of one, but the query is good. it seems that the &#39;overwrite&quot; makes the last file as the valid one and all the others archive?!
Anyway thank you for the help, much appreciated.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158874524142534697 class=chatlog__message-container data-message-id=1158874524142534697><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:13â€¯PM"><a href=#chatlog__message-container-1158874524142534697>10/3/2023 9:13â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">makes the last file as the valid one and all the others archive
</div></div>Yes, previous versions of the table are saved. You can access them with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.checkout(version)</code>.
In the next release, we&#39;ll have functions that will compact the small files into larger ones and remove old files if you want to free up disk space.</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158875000464490607 class=chatlog__message-container data-message-id=1158875000464490607><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158874524142534697')"> <div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">makes the last file as the valid one and all the others archive
</div></div>Yes, previous versions of the table are saved. You can access them with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.checkout(version)</code>.
In the next release, we&#39;ll have functions that will compact the small files into larger ones and remove old files if you want to free up disk space. </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:15â€¯PM"><a href=#chatlog__message-container-1158875000464490607>10/3/2023 9:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I will benefit from your presence to ask , is there some kind of UI that I can use to manage my DB? just like mysql and postgres visual tools?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158875261312446534 class=chatlog__message-container data-message-id=1158875261312446534><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:16â€¯PM"><a href=#chatlog__message-container-1158875261312446534>10/3/2023 9:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>No, there is not right now. Though it&#39;s an interesting idea</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158875689525706814 class=chatlog__message-container data-message-id=1158875689525706814><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158875261312446534')"> No, there is not right now. Though it&#39;s an interesting idea </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:18â€¯PM"><a href=#chatlog__message-container-1158875689525706814>10/3/2023 9:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>it would be useful to do it, because at the current time if I need something I have to code it. but if there is a UI to check it out, it will be faster and easier</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158884710433439875 class=chatlog__message-container data-message-id=1158884710433439875><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=_.zys._>zys</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158875689525706814')"> it would be useful to do it, because at the current time if I need something I have to code it. but if there is a UI to check it out, it will be faster and easier </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 9:54â€¯PM"><a href=#chatlog__message-container-1158884710433439875>10/3/2023 9:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>One path we could take someday is to add JDBC support which would allow people to use something like <a href="https://squirrel-sql.sourceforge.io/">https://squirrel-sql.sourceforge.io/</a></span></div><div class=chatlog__embed><div class="chatlog__embed-color-pill chatlog__embed-color-pill--default"></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href="https://squirrel-sql.sourceforge.io/"><div class="chatlog__markdown chatlog__markdown-preserve">SQuirreL SQL Client Home Page</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">SQuirreL SQL is an open-source Java SQL Client program for any JDBC compliant database</div></div></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158896542632120370 class=chatlog__message-container data-message-id=1158896542632120370><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158884710433439875')"> One path we could take someday is to add JDBC support which would allow people to use something like <a href="https://squirrel-sql.sourceforge.io/">https://squirrel-sql.sourceforge.io/</a> </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Tuesday, October 3, 2023 10:41â€¯PM"><a href=#chatlog__message-container-1158896542632120370>10/3/2023 10:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Maybe via ADBC?</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=100><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ’¯ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f4af.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158926385348362341 class=chatlog__message-container data-message-id=1158926385348362341><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1158896542632120370')"> Maybe via ADBC? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 12:39â€¯AM"><a href=#chatlog__message-container-1158926385348362341>10/4/2023 12:39â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yep.  I believe there is an ADBC&lt;-&gt;JDBC adapter and, if not, there should be <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™‚"
    title="slight_smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f642.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1158927566531465226 class=chatlog__message-container data-message-id=1158927566531465226><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 12:44â€¯AM"><a href=#chatlog__message-container-1158927566531465226>10/4/2023 12:44â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ADBC all the things</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=fire><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ”¥ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f525.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159117455952707655 class=chatlog__message-container data-message-id=1159117455952707655><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 1:18â€¯PM"><a href=#chatlog__message-container-1159117455952707655>10/4/2023 1:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>While writing in parallel to a Lance Dataset on GCS I&#39;m getting all kinds of assertion errors:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">thread &#39;&lt;unnamed&gt;&#39; panicked at &#39;assertion failed: buf.len() &gt;= msg_len + 4&#39;, /home/runner/work/lance/lance/rust/lance/src/io/object_reader.rs:121:9
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
Traceback (most recent call last):
  File &quot;/pkg/modal/_container_entrypoint.py&quot;, line 374, in handle_input_exception
    yield
  File &quot;/pkg/modal/_container_entrypoint.py&quot;, line 541, in run_input
    value = await res
            ^^^^^^^^^
  File &quot;/root/jobs/products/assets.py&quot;, line 541, in product_vector_lance_worker
    return await process_pipeline(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/root/jobs/products/assets.py&quot;, line 594, in process_pipeline
    await process_pipeine_single_batch.local(
  File &quot;/root/jobs/products/assets.py&quot;, line 666, in process_pipeine_single_batch
    new_data = await func_run(copy(data))
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/tenacity/_asyncio.py&quot;, line 88, in async_wrapped
    return await fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/tenacity/_asyncio.py&quot;, line 47, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/tenacity/__init__.py&quot;, line 314, in iter
    return fut.result()
           ^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/concurrent/futures/_base.py&quot;, line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/concurrent/futures/_base.py&quot;, line 401, in __get_result
    raise self._exception
  File &quot;/usr/local/lib/python3.11/site-packages/tenacity/_asyncio.py&quot;, line 50, in __call__
    result = await fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/root/jobs/products/lance/utils.py&quot;, line 332, in run
    insert_products(self.uri, df)
  File &quot;/usr/local/lib/python3.11/site-packages/tenacity/__init__.py&quot;, line 289, in wrapped_f
    return self(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/tenacity/__init__.py&quot;, line 379, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/site-packages/tenacity/__init__.py&quot;, line 314, in iter
    return fut.result()
           ^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/concurrent/futures/_base.py&quot;, line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File &quot;/usr/local/lib/python3.11/concurrent/futures/_base.py&quot;, line 401, in __get_result
    raise self._exception
  File &quot;/usr/local/lib/python3.11/site-packages/tenacity/__init__.py&quot;, line 382, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File &quot;/root/jobs/utils/env_var_remover.py&quot;, line 30, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File &quot;/root/jobs/products/lance/utils.py&quot;, line 228, in insert_products
    lance.write_dataset(table2, uri, mode=mode)
  File &quot;/usr/local/lib/python3.11/site-packages/lance/dataset.py&quot;, line 1238, in write_dataset
    _write_dataset(reader, uri, params)
pyo3_runtime.PanicException: assertion failed: buf.len() &gt;= msg_len + 4</code>

I thought parallel writes were ok? At least on GCP GS? If I only use a single writer or few writers the panics go away. (But my total dataset is so large that writing slowly causes other problems!)</span> <span class=chatlog__edited-timestamp title="Wednesday, October 4, 2023 2:34â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159157958832304138 class=chatlog__message-container data-message-id=1159157958832304138><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 3:59â€¯PM"><a href=#chatlog__message-container-1159157958832304138>10/4/2023 3:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> , yes parallel writes should work out of the box on GCS, but what you are seeing is worrying. I&#39;ll be looking into this.</span></div></div></div></div><div id=chatlog__message-container-1159158071730384907 class=chatlog__message-container data-message-id=1159158071730384907><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, October 4, 2023 4:00â€¯PM">4:00â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Are there any other assertions beside the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">buf.len() &gt;= msg_len + 4</code> that you are hitting?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159158121692930118 class=chatlog__message-container data-message-id=1159158121692930118><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159158071730384907')"> Are there any other assertions beside the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">buf.len() &gt;= msg_len + 4</code> that you are hitting? </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 4:00â€¯PM"><a href=#chatlog__message-container-1159158121692930118>10/4/2023 4:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>nope, just that one.</span></div></div></div></div><div id=chatlog__message-container-1159158249686319177 class=chatlog__message-container data-message-id=1159158249686319177><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, October 4, 2023 4:01â€¯PM">4:01â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>for what it is worth, if i run exactly the same code, also with 50 parallel workers, but targeting a network file system i do not get these panics. weirdly the network file system is almost 5x slower than hitting GCP GS (but don&#39;t care)</span> <span class=chatlog__edited-timestamp title="Wednesday, October 4, 2023 4:02â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159159082511519795 class=chatlog__message-container data-message-id=1159159082511519795><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 4:04â€¯PM"><a href=#chatlog__message-container-1159159082511519795>10/4/2023 4:04â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>NFS slowness - are you hitting your NFS IO limit?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159164885905723402 class=chatlog__message-container data-message-id=1159164885905723402><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159159082511519795')"> NFS slowness - are you hitting your NFS IO limit? </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 4:27â€¯PM"><a href=#chatlog__message-container-1159164885905723402>10/4/2023 4:27â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ah, perhaps that is the case. i&#39;m using NFS via modal, which is likely shared</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159192228493807647 class=chatlog__message-container data-message-id=1159192228493807647><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159157958832304138')"> Hi <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> , yes parallel writes should work out of the box on GCS, but what you are seeing is worrying. I&#39;ll be looking into this. </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 6:16â€¯PM"><a href=#chatlog__message-container-1159192228493807647>10/4/2023 6:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i was thinking of trying to use the commit_lock mechanism; do you think that could avoid the issue?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159192770339155968 class=chatlog__message-container data-message-id=1159192770339155968><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=chrisemoody>chrisemoody</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159192228493807647')"> i was thinking of trying to use the commit_lock mechanism; do you think that could avoid the issue? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 6:18â€¯PM"><a href=#chatlog__message-container-1159192770339155968>10/4/2023 6:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I haven&#39;t yet found the underlying issue, but I am skeptical right now  <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">commit_lock</code> would help. My current theory is something is going wrong in the conflict resolution path, which happens on write conflicts regardless of what mechanism is used to detect them.</span> <span class=chatlog__edited-timestamp title="Wednesday, October 4, 2023 6:18â€¯PM">(edited)</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159252592061317170 class=chatlog__message-container data-message-id=1159252592061317170><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 10:15â€¯PM"><a href=#chatlog__message-container-1159252592061317170>10/4/2023 10:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>how to use datetime type in a table?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159267768261156914 class=chatlog__message-container data-message-id=1159267768261156914><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159192770339155968')"> I haven&#39;t yet found the underlying issue, but I am skeptical right now  <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">commit_lock</code> would help. My current theory is something is going wrong in the conflict resolution path, which happens on write conflicts regardless of what mechanism is used to detect them. </span> <span class=chatlog__reply-edited-timestamp title="Wednesday, October 4, 2023 6:18â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 11:16â€¯PM"><a href=#chatlog__message-container-1159267768261156914>10/4/2023 11:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>FYI <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> I&#39;ve identified the underlying issue and am working on a fix. It&#39;s something that affects all storage backends, but something about GCS made it easier to trigger. Importantly, the error doesn&#39;t lead to corrupted tables. I&#39;ll let you know when we&#39;ve released a fix.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159267864767893526 class=chatlog__message-container data-message-id=1159267864767893526><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159267768261156914')"> FYI <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> I&#39;ve identified the underlying issue and am working on a fix. It&#39;s something that affects all storage backends, but something about GCS made it easier to trigger. Importantly, the error doesn&#39;t lead to corrupted tables. I&#39;ll let you know when we&#39;ve released a fix. </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 11:16â€¯PM"><a href=#chatlog__message-container-1159267864767893526>10/4/2023 11:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>wonderful. thank you!!!!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159269173353000970 class=chatlog__message-container data-message-id=1159269173353000970><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=_.zys._>zys</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159252592061317170')"> how to use datetime type in a table? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Wednesday, October 4, 2023 11:21â€¯PM"><a href=#chatlog__message-container-1159269173353000970>10/4/2023 11:21â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Is there something in particular you are having trouble with? You should be able to insert <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">datetime</code> objects like this:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">from datetime import datetime
import lancedb

db = lancedb.connect(&quot;./test&quot;)
table = db.create_table(
    &quot;test_table&quot;,
    [{&quot;vector&quot;: [1, 2, 3], &quot;date&quot;: datetime.now(), &quot;string&quot;: &quot;test&quot;}],
)
table.to_pandas()</code>

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">            vector                       date string
0  [1.0, 2.0, 3.0] 2023-10-04 16:20:31.766535   test</code></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159443859751841842 class=chatlog__message-container data-message-id=1159443859751841842><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/532872309485207601/1bd78cacafe49c016aae12e06eb69442.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=tobowers data-user-id=532872309485207601>tobowers</span> <span class=chatlog__timestamp title="Thursday, October 5, 2023 10:55â€¯AM"><a href=#chatlog__message-container-1159443859751841842>10/5/2023 10:55â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>seems like there&#39;s a bug using the nodejs version creating a table without specifying data (I did indeed send in a schema)

<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">     TypeError: Vector constructor expects an Array of Data instances.</code>

I see you have tests for that, which is confusing <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™‚"
    title="slight_smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f642.svg">

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-typescript">const defaultSchema = new Schema([
  new Field(&quot;id&quot;, new Utf8()),
  new Field(&quot;subject&quot;, new Utf8()),
  new Field(&quot;predicate&quot;, new Utf8()),
  new Field(&quot;object&quot;, new Utf8()),
])

const db = await connect(`data/${database}`)
    const tbl = await db.createTable({
      name: table,
      schema,
    })</code></span> <span class=chatlog__edited-timestamp title="Thursday, October 5, 2023 11:01â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159459907104415805 class=chatlog__message-container data-message-id=1159459907104415805><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, October 5, 2023 11:59â€¯AM"><a href=#chatlog__message-container-1159459907104415805>10/5/2023 11:59â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This was an old limitation and should be removed.</span></div></div></div></div><div id=chatlog__message-container-1159459977371594834 class=chatlog__message-container data-message-id=1159459977371594834><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 5, 2023 12:00â€¯PM">12:00â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>If you donâ€™t mind please file a GitHub issue?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159465955823472700 class=chatlog__message-container data-message-id=1159465955823472700><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/532872309485207601/1bd78cacafe49c016aae12e06eb69442.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159459977371594834')"> If you donâ€™t mind please file a GitHub issue? </span></div></div><div class=chatlog__header><span class=chatlog__author title=tobowers data-user-id=532872309485207601>tobowers</span> <span class=chatlog__timestamp title="Thursday, October 5, 2023 12:23â€¯PM"><a href=#chatlog__message-container-1159465955823472700>10/5/2023 12:23â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Well I&#39;m confused though because of this:

<a href="https://github.com/lancedb/lancedb/blob/main/node/src/test/test.ts#L123-L133">https://github.com/lancedb/lancedb/blob/main/node/src/test/test.ts#L123-L133</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/blob/main/node/src/test/test.ts><div class="chatlog__markdown chatlog__markdown-preserve">lancedb/node/src/test/test.ts at main &#183; lancedb/lancedb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Developer-friendly, serverless vector database for AI applications. Easily add long-term memory to your LLM apps! - lancedb/lancedb</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/FvRhTenskWYwgcP__0C3I_AhlbDMgj6wz169d7psj9o/https/opengraph.githubassets.com/37a72bbf19df8a78fe232dd5ee1aea3271d3eae2bd7ea091ca57ed59b53a918b/lancedb/lancedb> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/FvRhTenskWYwgcP__0C3I_AhlbDMgj6wz169d7psj9o/https/opengraph.githubassets.com/37a72bbf19df8a78fe232dd5ee1aea3271d3eae2bd7ea091ca57ed59b53a918b/lancedb/lancedb alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1159466095120494733 class=chatlog__message-container data-message-id=1159466095120494733><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 5, 2023 12:24â€¯PM">12:24â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>maybe the latest just hasn&#39;t been released?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159472142430244879 class=chatlog__message-container data-message-id=1159472142430244879><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, October 5, 2023 12:48â€¯PM"><a href=#chatlog__message-container-1159472142430244879>10/5/2023 12:48â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It was an old limitation in the underlying format that was removed. We updated the python sdk but missed the nodejs</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159508202862428271 class=chatlog__message-container data-message-id=1159508202862428271><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/532872309485207601/1bd78cacafe49c016aae12e06eb69442.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159472142430244879')"> It was an old limitation in the underlying format that was removed. We updated the python sdk but missed the nodejs </span></div></div><div class=chatlog__header><span class=chatlog__author title=tobowers data-user-id=532872309485207601>tobowers</span> <span class=chatlog__timestamp title="Thursday, October 5, 2023 3:11â€¯PM"><a href=#chatlog__message-container-1159508202862428271>10/5/2023 3:11â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>right but does that test fail then?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159655200928321660 class=chatlog__message-container data-message-id=1159655200928321660><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=chrisemoody>chrisemoody</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159267864767893526')"> wonderful. thank you!!!! </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Friday, October 6, 2023 12:55â€¯AM"><a href=#chatlog__message-container-1159655200928321660>10/6/2023 12:55â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>FYI <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> the latest release of Lance fixes this issue. Just validated with my reproduction on GCS. <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ‘"
    title="thumbsup"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg"></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1159704696433414194 class=chatlog__message-container data-message-id=1159704696433414194><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159655200928321660')"> FYI <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> the latest release of Lance fixes this issue. Just validated with my reproduction on GCS. <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ‘"
    title="thumbsup"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg"> </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, October 6, 2023 4:12â€¯AM"><a href=#chatlog__message-container-1159704696433414194>10/6/2023 4:12â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>great, will start using it immediately!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1160072931473358889 class=chatlog__message-container data-message-id=1160072931473358889><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, October 7, 2023 4:35â€¯AM"><a href=#chatlog__message-container-1160072931473358889>10/7/2023 4:35â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>While running compact() on my dataset I&#39;m getting this: 

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Traceback (most recent call last):
  File &quot;/pkg/modal/_container_entrypoint.py&quot;, line 374, in handle_input_exception
    yield
  File &quot;/pkg/modal/_container_entrypoint.py&quot;, line 465, in run_inputs
    res = imp_fun.fun(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/root/jobs/products/assets.py&quot;, line 694, in index_products_worker
    index_products(uri)
  File &quot;/root/jobs/products/lance/utils.py&quot;, line 301, in index_products
    index_dataset(fn, centroids)
  File &quot;/root/jobs/utils/env_var_remover.py&quot;, line 30, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File &quot;/root/jobs/products/lance/utils.py&quot;, line 325, in index_dataset
    ds.optimize.compact_files()
  File &quot;/usr/local/lib/python3.11/site-packages/lance/dataset.py&quot;, line 1577, in compact_files
    return Compaction.execute(self._dataset, opts)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyo3_runtime.PanicException: range start must not be greater than end: 13614703732128473296 &lt;= 4096</code></span> <span class=chatlog__edited-timestamp title="Saturday, October 7, 2023 11:01â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1160265999577251924 class=chatlog__message-container data-message-id=1160265999577251924><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Saturday, October 7, 2023 5:22â€¯PM"> <a href=#chatlog__message-container-1160265999577251924>10/7/2023 5:22â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1160351521297416272 class=chatlog__message-container data-message-id=1160351521297416272><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, October 7, 2023 11:02â€¯PM"><a href=#chatlog__message-container-1160351521297416272>10/7/2023 11:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I created a new dataset and tried to add an index:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">    ds.create_index(
        &quot;vectors&quot;,
        index_type=&quot;IVF_PQ&quot;,
        replace=True,
        ivf_centroids=centroids,
        num_partitions=num_partitions,
        num_sub_vectors=192,
        metric=&quot;l2&quot;,
        use_opq=False,
    )</code>

but got a panic!

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">thread &#39;&lt;unnamed&gt;&#39; panicked at /root/.cargo/registry/src/index.crates.io-6f17d22bba15001f/arrow-data-43.0.0/src/data/mod.rs:536:9:
assertion failed: (offset + length) &lt;= self.len()
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
Traceback (most recent call last):
  File &quot;/pkg/modal/_container_entrypoint.py&quot;, line 374, in handle_input_exception
    yield
  File &quot;/pkg/modal/_container_entrypoint.py&quot;, line 465, in run_inputs
    res = imp_fun.fun(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/root/jobs/products/assets.py&quot;, line 744, in index_products_worker
    index_products(uri)
  File &quot;/root/jobs/products/lance/utils.py&quot;, line 302, in index_products
    index_dataset(fn, centroids, num_partitions=num_partitions)
  File &quot;/root/jobs/utils/env_var_remover.py&quot;, line 30, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File &quot;/root/jobs/products/lance/utils.py&quot;, line 346, in index_dataset
    ds.create_index(
  File &quot;/usr/local/lib/python3.11/site-packages/lance/dataset.py&quot;, line 822, in create_index
    self._ds.create_index(column, index_type, name, metric, kwargs)
pyo3_runtime.PanicException: assertion failed: (offset + length) &lt;= self.len()</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1160651087485866069 class=chatlog__message-container data-message-id=1160651087485866069><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Sunday, October 8, 2023 6:53â€¯PM"> <a href=#chatlog__message-container-1160651087485866069>10/8/2023 6:53â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162038886231453767 class=chatlog__message-container data-message-id=1162038886231453767><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gggrunt data-user-id=261206277017960448>gggrunt</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 2:47â€¯PM"><a href=#chatlog__message-container-1162038886231453767>10/12/2023 2:47â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I am seeing some issues with lancedb.connect(s3_uri)
Only testing it with localstack with a container setup. It has an app container for an api server and localstack container.
Error: AWS Error INVALID_ACCESS_KEY_ID during ListObjectsV2 operation: The AWS Access Key Id you provided does not exist in our records.

The setup works properly for other python boto3 operations, but it did not work for 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">lancedb.connect(uri) 
print(db.table_names())</code>
same uri is working fine for 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">filesystem = pa_fs.S3FileSystem(
            endpoint_override=os.environ.get(&quot;AWS_ENDPOINT&quot;),
            request_timeout=30,
            connect_timeout=30,
        )
        paths = filesystem.get_file_info(
            pa_fs.FileSelector(get_uri_location(uri))
        )</code>
Which is a bit confusing. I have the app container with AWS env variables and override AWS_ENDPOINT to point to localstack. I suppose if pyarrow fs works, I shouldn&#39;t have access issue with lancedb.connect.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162045417031221320 class=chatlog__message-container data-message-id=1162045417031221320><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=gggrunt>gggrunt</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1162038886231453767')"> I am seeing some issues with lancedb.connect(s3_uri)
Only testing it with localstack with a container setup. It has an app container for an api server and localstack container.
Error: AWS Error INVALID_ACCESS_KEY_ID during ListObjectsV2 operation: The AWS Access Key Id you provided does not exist in our records.

The setup works properly for other python boto3 operations, but it did not work for 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">lancedb.connect(uri) 
print(db.table_names())</code>
same uri is working fine for 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">filesystem = pa_fs.S3FileSystem(
            endpoint_override=os.environ.get(&quot;AWS_ENDPOINT&quot;),
            request_timeout=30,
            connect_timeout=30,
        )
        paths = filesystem.get_file_info(
            pa_fs.FileSelector(get_uri_location(uri))
        )</code>
Which is a bit confusing. I have the app container with AWS env variables and override AWS_ENDPOINT to point to localstack. I suppose if pyarrow fs works, I shouldn&#39;t have access issue with lancedb.connect. </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 3:13â€¯PM"><a href=#chatlog__message-container-1162045417031221320>10/12/2023 3:13â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It doesn&#39;t look like you are not specifying an access key programmatically in either case.  Is this a public bucket?  Or is an access key being provided some other way (env variable, config file, etc.)?</span> <span class=chatlog__edited-timestamp title="Thursday, October 12, 2023 3:13â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162060911738105907 class=chatlog__message-container data-message-id=1162060911738105907><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gggrunt data-user-id=261206277017960448>gggrunt</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 4:15â€¯PM"><a href=#chatlog__message-container-1162060911738105907>10/12/2023 4:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this is localhost with a localstack container, so it is &quot;public&quot; in the sense that definitely the app-server container can access it. The credentials are through env vars.</span></div></div></div></div><div id=chatlog__message-container-1162062270071836804 class=chatlog__message-container data-message-id=1162062270071836804><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 12, 2023 4:20â€¯PM">4:20â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ideally maybe there is a feature-request that it&#39;d be more flexible if user can create db given a pyarrow_fs. That way I can ping pyarrow with these issues and it&#39;d not be a lancedb thing to worry about.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162077112807735507 class=chatlog__message-container data-message-id=1162077112807735507><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 5:19â€¯PM"><a href=#chatlog__message-container-1162077112807735507>10/12/2023 5:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">ideally maybe there is a feature-request that it&#39;d be more flexible if user can create db given a pyarrow_fs. That way I can ping pyarrow with these issues and it&#39;d not be a lancedb thing to worry about.
</div></div>
That would be a little tricky since Lance is in rust and arrow-cpp doesn&#39;t have a stable API for filesystem.  We could add a python object_store and go through python but that would add python request overhead (grab gil, interpreter overhead, etc.) to every single I/O request.  I&#39;m not sure if that would be an acceptable performance impact or not.

<div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">this is localhost with a localstack container, so it is &quot;public&quot; in the sense that definitely the app-server container can access it. The credentials are through env vars.
</div></div>
I think localstack still requires credentials / policy.  Maybe you can figure out where pyarrow is getting the credentials from.  Can you run something like this:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">import pyarrow._s3fs
pyarrow._s3fs.initialize_s3(log_level=pyarrow._s3fs.S3LogLevel.Trace)

import pyarrow.fs as pa_fs
filesystem = pa_fs.S3FileSystem(
            endpoint_override=os.environ.get(&quot;AWS_ENDPOINT&quot;),
            request_timeout=30,
            connect_timeout=30,
        )
paths = filesystem.get_file_info(
        pa_fs.FileSelector(get_uri_location(uri))
)</code>

This will give you a lot more logging.  Buried in those logs somewhere should be some clue how it is resolving credentials.  For example:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">...
[DEBUG] 2023-10-12 17:18:29.704 Aws::Config::ConfigFileProfileFSM [140110013769536] found access key AKI...
[INFO] 2023-10-12 17:18:29.704 Aws::Config::AWSProfileConfigLoaderBase [140110013769536] Successfully reloaded configuration.
...</code></span></div></div></div></div><div id=chatlog__message-container-1162077144344698930 class=chatlog__message-container data-message-id=1162077144344698930><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 12, 2023 5:19â€¯PM">5:19â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="gggrunt">@gggrunt</span></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162094965850116126 class=chatlog__message-container data-message-id=1162094965850116126><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gggrunt data-user-id=261206277017960448>gggrunt</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 6:30â€¯PM"><a href=#chatlog__message-container-1162094965850116126>10/12/2023 6:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">pip install lancedb==0.3.0
Collecting lancedb==0.3.0
  Obtaining dependency information for lancedb==0.3.0 from https://files.pythonhosted.org/packages/a6/6a/faa9b22067d239f9567a59172a729988d93690894841c85a3212a5aa928e/lancedb-0.3.0-py3-none-any.whl.metadata
  Using cached lancedb-0.3.0-py3-none-any.whl.metadata (3.5 kB)
INFO: pip is looking at multiple versions of lancedb to determine which version is compatible with other requirements. This could take a while.
ERROR: Could not find a version that satisfies the requirement pylance==0.8.1 (from lancedb) (from versions: 0.0.2, 0.5.5, 0.5.6, 0.5.7, 0.5.8, 0.5.9, 0.5.10, 0.6.0, 0.6.1, 0.6.2, 0.6.3, 0.6.4, 0.6.5, 0.7.0, 0.7.1, 0.7.2, 0.7.3, 0.8.3, 0.8.4)
ERROR: No matching distribution found for pylance==0.8.1</code></span></div></div></div></div><div id=chatlog__message-container-1162095282549436468 class=chatlog__message-container data-message-id=1162095282549436468><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 12, 2023 6:31â€¯PM">6:31â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i also realize that i was on 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">pip list | grep lance
lancedb            0.1.8
pylance            0.8.4</code>
pip 23.2.1 from /usr/local/lib/python3.11/site-packages/pip (python 3.11)
Python 3.11.6</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162095639153356860 class=chatlog__message-container data-message-id=1162095639153356860><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 6:33â€¯PM"><a href=#chatlog__message-container-1162095639153356860>10/12/2023 6:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>You on aarch64/ARM Linux?</span> <span class=chatlog__edited-timestamp title="Thursday, October 12, 2023 6:34â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162095645247668326 class=chatlog__message-container data-message-id=1162095645247668326><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1162077112807735507')"> <div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">ideally maybe there is a feature-request that it&#39;d be more flexible if user can create db given a pyarrow_fs. That way I can ping pyarrow with these issues and it&#39;d not be a lancedb thing to worry about.
</div></div>
That would be a little tricky since Lance is in rust and arrow-cpp doesn&#39;t have a stable API for filesystem.  We could add a python object_store and go through python but that would add python request overhead (grab gil, interpreter overhead, etc.) to every single I/O request.  I&#39;m not sure if that would be an acceptable performance impact or not.

<div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">this is localhost with a localstack container, so it is &quot;public&quot; in the sense that definitely the app-server container can access it. The credentials are through env vars.
</div></div>
I think localstack still requires credentials / policy.  Maybe you can figure out where pyarrow is getting the credentials from.  Can you run something like this:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">import pyarrow._s3fs
pyarrow._s3fs.initialize_s3(log_level=pyarrow._s3fs.S3LogLevel.Trace)

import pyarrow.fs as pa_fs
filesystem = pa_fs.S3FileSystem(
            endpoint_override=os.environ.get(&quot;AWS_ENDPOINT&quot;),
            request_timeout=30,
            connect_timeout=30,
        )
paths = filesystem.get_file_info(
        pa_fs.FileSelector(get_uri_location(uri))
)</code>

This will give you a lot more logging.  Buried in those logs somewhere should be some clue how it is resolving credentials.  For example:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">...
[DEBUG] 2023-10-12 17:18:29.704 Aws::Config::ConfigFileProfileFSM [140110013769536] found access key AKI...
[INFO] 2023-10-12 17:18:29.704 Aws::Config::AWSProfileConfigLoaderBase [140110013769536] Successfully reloaded configuration.
...</code> </span></div></div><div class=chatlog__header><span class=chatlog__author title=gggrunt data-user-id=261206277017960448>gggrunt</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 6:33â€¯PM"><a href=#chatlog__message-container-1162095645247668326>10/12/2023 6:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i will have to try that perhaps a bit later, i added my own wrapper to just sync things down from S3 for now, trying to debug why it&#39;s running a version of lancedb without prefilter atm</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162097320708546721 class=chatlog__message-container data-message-id=1162097320708546721><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1162095639153356860')"> You on aarch64/ARM Linux? </span> <span class=chatlog__reply-edited-timestamp title="Thursday, October 12, 2023 6:34â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author title=gggrunt data-user-id=261206277017960448>gggrunt</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 6:39â€¯PM"><a href=#chatlog__message-container-1162097320708546721>10/12/2023 6:39â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="wjones127">@Will Jones</span> 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">uname -m
aarch64</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162107092207931513 class=chatlog__message-container data-message-id=1162107092207931513><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gggrunt data-user-id=261206277017960448>gggrunt</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 7:18â€¯PM"><a href=#chatlog__message-container-1162107092207931513>10/12/2023 7:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>it looks like the issue was that 0.8.1 pylance did not have the aarch64 wheels. not sure if that was intentional.</span></div></div></div></div><div id=chatlog__message-container-1162107245732040764 class=chatlog__message-container data-message-id=1162107245732040764><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 12, 2023 7:19â€¯PM">7:19â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>if someone knows how i can build one off a aarch64 docker image, would be appreciated.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162107418038251620 class=chatlog__message-container data-message-id=1162107418038251620><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 7:19â€¯PM"><a href=#chatlog__message-container-1162107418038251620>10/12/2023 7:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yeah that was accidental. I&#39;ll build and upload one in a minute</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162109122251079720 class=chatlog__message-container data-message-id=1162109122251079720><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=gggrunt>gggrunt</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1162107245732040764')"> if someone knows how i can build one off a aarch64 docker image, would be appreciated. </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 7:26â€¯PM"><a href=#chatlog__message-container-1162109122251079720>10/12/2023 7:26â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Just uploaded now.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162120705098387497 class=chatlog__message-container data-message-id=1162120705098387497><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gggrunt data-user-id=261206277017960448>gggrunt</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 8:12â€¯PM"><a href=#chatlog__message-container-1162120705098387497>10/12/2023 8:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ‘€"
    title="eyes"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg"> was just building the wheel on my m2 mins ago, thanks for the upload</span></div></div></div></div><div id=chatlog__message-container-1162121200105967627 class=chatlog__message-container data-message-id=1162121200105967627><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 12, 2023 8:14â€¯PM">8:14â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>looks like all good now</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1162134715499819038 class=chatlog__message-container data-message-id=1162134715499819038><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/261206277017960448/24e3ebcf94c10a92fd1a93beaad3a9f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gggrunt data-user-id=261206277017960448>gggrunt</span> <span class=chatlog__timestamp title="Thursday, October 12, 2023 9:08â€¯PM"><a href=#chatlog__message-container-1162134715499819038>10/12/2023 9:08â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="wpace">@WestonPace</span> looks like lancedb 0.3.0 does not have the problem, it was outdated db(lancedb at 0.1.8) issue, will ping if that issue happens again. Seems like all it takes it making sure that AWS_ENDPOINT is set to point to localstack</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163555779589185577 class=chatlog__message-container data-message-id=1163555779589185577><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=halfcoder_12101 data-user-id=1145343251398799420>ksanjeeb</span> <span class=chatlog__timestamp title="Monday, October 16, 2023 7:15â€¯PM"><a href=#chatlog__message-container-1163555779589185577>10/16/2023 7:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>import { PDFLoader } from &quot;langchain/document_loaders/fs/pdf&quot;;
const pdfLoader = new PDFLoader(file);
        const splitDocuments = await pdfLoader.loadAndSplit();


        const db = await connect(process.env.LANCEDB_URI);

        const table = await db.createTable(indexName + &quot;-vector-lance-table&quot;, [
            { vector: [1, 2], text: &quot;sample&quot;, source: &quot;a&quot; },
        ])
        await LanceDB.fromDocuments(
            splitDocuments,
            new OpenAIEmbeddings(),
            { table }
        );

Error Catch: Error: LanceDBError: Append with different schema: original=Field(id=0, name=vector, type=fixed_size_list:float:2)

Can anyone suggest  me How I can load the PDF here ?</span></div></div></div></div><div id=chatlog__message-container-1163556181873283214 class=chatlog__message-container data-message-id=1163556181873283214><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, October 16, 2023 7:16â€¯PM">7:16â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Which PDFLoader will give perfect schema for this ? I am trying to moving from Pinecone DB</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163557807543570533 class=chatlog__message-container data-message-id=1163557807543570533><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wjones127>Will Jones</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1159269173353000970')"> Is there something in particular you are having trouble with? You should be able to insert <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">datetime</code> objects like this:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">from datetime import datetime
import lancedb

db = lancedb.connect(&quot;./test&quot;)
table = db.create_table(
    &quot;test_table&quot;,
    [{&quot;vector&quot;: [1, 2, 3], &quot;date&quot;: datetime.now(), &quot;string&quot;: &quot;test&quot;}],
)
table.to_pandas()</code>

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">            vector                       date string
0  [1.0, 2.0, 3.0] 2023-10-04 16:20:31.766535   test</code> </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Monday, October 16, 2023 7:23â€¯PM"><a href=#chatlog__message-container-1163557807543570533>10/16/2023 7:23â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>class History(LanceModel):
    timestamp:datetime
    vector: Vector(1536)
    ....
    
db.create_table(&quot;history&quot; , schema=History.to_arrow_schema())


Exception has occurred: TypeError
Converting Pydantic type to Arrow Type: unsupported type &lt;class &#39;datetime.datetime&#39;&gt;
TypeError: Converting Pydantic type to Arrow Type: unsupported type &lt;class &#39;datetime.datetime&#39;&gt;</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163557980818657381 class=chatlog__message-container data-message-id=1163557980818657381><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1032079688887189556/9d9cd1c2872874160d9f8e2f6dd766a5.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=halfcoder_12101>ksanjeeb</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1163555779589185577')"> import { PDFLoader } from &quot;langchain/document_loaders/fs/pdf&quot;;
const pdfLoader = new PDFLoader(file);
        const splitDocuments = await pdfLoader.loadAndSplit();


        const db = await connect(process.env.LANCEDB_URI);

        const table = await db.createTable(indexName + &quot;-vector-lance-table&quot;, [
            { vector: [1, 2], text: &quot;sample&quot;, source: &quot;a&quot; },
        ])
        await LanceDB.fromDocuments(
            splitDocuments,
            new OpenAIEmbeddings(),
            { table }
        );

Error Catch: Error: LanceDBError: Append with different schema: original=Field(id=0, name=vector, type=fixed_size_list:float:2)

Can anyone suggest  me How I can load the PDF here ? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=ayushexel data-user-id=1032079688887189556>AyushC</span> <span class=chatlog__timestamp title="Monday, October 16, 2023 7:24â€¯PM"><a href=#chatlog__message-container-1163557980818657381>10/16/2023 7:24â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Does setting vector to Array(1536) when initializing the table help?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163565277787725824 class=chatlog__message-container data-message-id=1163565277787725824><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=_.zys._>zys</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1163557807543570533')"> class History(LanceModel):
    timestamp:datetime
    vector: Vector(1536)
    ....
    
db.create_table(&quot;history&quot; , schema=History.to_arrow_schema())


Exception has occurred: TypeError
Converting Pydantic type to Arrow Type: unsupported type &lt;class &#39;datetime.datetime&#39;&gt;
TypeError: Converting Pydantic type to Arrow Type: unsupported type &lt;class &#39;datetime.datetime&#39;&gt; </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, October 16, 2023 7:53â€¯PM"><a href=#chatlog__message-container-1163565277787725824>10/16/2023 7:53â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i think we&#39;re missing a type conversion here for datetime: <a href="https://github.com/lancedb/lancedb/blob/main/python/lancedb/pydantic.py#L144">https://github.com/lancedb/lancedb/blob/main/python/lancedb/pydantic.py#L144</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/blob/main/python/lancedb/pydantic.py><div class="chatlog__markdown chatlog__markdown-preserve">lancedb/python/lancedb/pydantic.py at main &#183; lancedb/lancedb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Developer-friendly, serverless vector database for AI applications. Easily add long-term memory to your LLM apps! - lancedb/lancedb</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/KF34nwfrVzgbEbUoTS34edWphGawJN1FA7vRx5XeL1s/https/opengraph.githubassets.com/c86d9c4b56490250c9c3fed6c9d1a74b370f504517f7c105da730b888a95fb0a/lancedb/lancedb> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/KF34nwfrVzgbEbUoTS34edWphGawJN1FA7vRx5XeL1s/https/opengraph.githubassets.com/c86d9c4b56490250c9c3fed6c9d1a74b370f504517f7c105da730b888a95fb0a/lancedb/lancedb alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div><div id=chatlog__message-container-1163566025430806579 class=chatlog__message-container data-message-id=1163566025430806579><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, October 16, 2023 7:55â€¯PM">7:55â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>1. if you want an immediate workaround, use string for now
2. if you&#39;re familiar with python and are interested, we&#39;d love a PR - just add an if condition to convert python datetime type to pyarrow timestamp and add a quick unit test in test_pydantic.py</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163566282034126938 class=chatlog__message-container data-message-id=1163566282034126938><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=halfcoder_12101>ksanjeeb</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1163555779589185577')"> import { PDFLoader } from &quot;langchain/document_loaders/fs/pdf&quot;;
const pdfLoader = new PDFLoader(file);
        const splitDocuments = await pdfLoader.loadAndSplit();


        const db = await connect(process.env.LANCEDB_URI);

        const table = await db.createTable(indexName + &quot;-vector-lance-table&quot;, [
            { vector: [1, 2], text: &quot;sample&quot;, source: &quot;a&quot; },
        ])
        await LanceDB.fromDocuments(
            splitDocuments,
            new OpenAIEmbeddings(),
            { table }
        );

Error Catch: Error: LanceDBError: Append with different schema: original=Field(id=0, name=vector, type=fixed_size_list:float:2)

Can anyone suggest  me How I can load the PDF here ? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, October 16, 2023 7:56â€¯PM"><a href=#chatlog__message-container-1163566282034126938>10/16/2023 7:56â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yeah this is because you initialized the table with a 2 dimension vector but openai embeddings are 1536 dimensional.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163568161023606794 class=chatlog__message-container data-message-id=1163568161023606794><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1058755251940900946/d044b06490e5c624b171c83e29724486.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1163566025430806579')"> 1. if you want an immediate workaround, use string for now
2. if you&#39;re familiar with python and are interested, we&#39;d love a PR - just add an if condition to convert python datetime type to pyarrow timestamp and add a quick unit test in test_pydantic.py </span></div></div><div class=chatlog__header><span class=chatlog__author title=_.zys._ data-user-id=1058755251940900946>zys</span> <span class=chatlog__timestamp title="Monday, October 16, 2023 8:04â€¯PM"><a href=#chatlog__message-container-1163568161023606794>10/16/2023 8:04â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>for the moment I will use float to convert from/to dt.timestamp().
I am no super expert in Python, it is not my favourite language mostly because it is untyped, but I use it since most ML libraries are using it.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163607594879946772 class=chatlog__message-container data-message-id=1163607594879946772><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Monday, October 16, 2023 10:41â€¯PM"><a href=#chatlog__message-container-1163607594879946772>10/16/2023 10:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hey <span class="chatlog__markdown-mention" title="wjones127">@Will Jones</span>! I&#39;ve got another uint32-related bug. I&#39;ve been going through a prebuilt Lance index and building an index that maps my internal ids <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">gumtap_id</code> to a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_rowid</code> so I can do fast lookups given my native index (if there&#39;s a better way to do this let me know!). In this dataset, the number of rows should be around ~25M. However,  some batches that <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">to_batches</code> yields have <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_rowid</code> that is suspiciously close to the uint32 max <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">4294967296</code>.  The first sixteen batches have normal-looking rowids. After the 16th batch rowids go nuts. Trying to retrieve those rows with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ds.take([row_id])</code> fails.</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1163607592224968754/image.png?ex=698a6284&amp;is=69891104&amp;hm=a44685e604cae475acc4321cc038ea81fab989a35e35333877189802af522b60&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1163607592224968754/image.png?ex=698a6284&amp;is=69891104&amp;hm=a44685e604cae475acc4321cc038ea81fab989a35e35333877189802af522b60&amp;" alt="Image attachment" title="Image: image.png (395 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163658344054136867 class=chatlog__message-container data-message-id=1163658344054136867><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=prrao data-user-id=675128789646442557>prashanth</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, October 17, 2023 2:02â€¯AM"> <a href=#chatlog__message-container-1163658344054136867>10/17/2023 2:02â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163718302913265675 class=chatlog__message-container data-message-id=1163718302913265675><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1163566282034126938')"> yeah this is because you initialized the table with a 2 dimension vector but openai embeddings are 1536 dimensional. </span></div></div><div class=chatlog__header><span class=chatlog__author title=halfcoder_12101 data-user-id=1145343251398799420>ksanjeeb</span> <span class=chatlog__timestamp title="Tuesday, October 17, 2023 6:01â€¯AM"><a href=#chatlog__message-container-1163718302913265675>10/17/2023 6:01â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Even after initiating with             { vector: Array(1536), text: &quot;sample&quot;, id: 1 },
Still it is giving same error</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1163719075411787806 class=chatlog__message-container data-message-id=1163719075411787806><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=halfcoder_12101>ksanjeeb</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1163718302913265675')"> Even after initiating with             { vector: Array(1536), text: &quot;sample&quot;, id: 1 },
Still it is giving same error </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Tuesday, October 17, 2023 6:04â€¯AM"><a href=#chatlog__message-container-1163719075411787806>10/17/2023 6:04â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hmmm <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ¤”"
    title="thinking"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f914.svg"> itâ€™s still saying thereâ€™s a fixed size float of list size 2? Thatâ€™d doesnâ€™t make sense</span></div></div></div></div><div id=chatlog__message-container-1163719174770659369 class=chatlog__message-container data-message-id=1163719174770659369><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, October 17, 2023 6:04â€¯AM">6:04â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Can you paste the latest code and also the latest error message?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1165355156624396359 class=chatlog__message-container data-message-id=1165355156624396359><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, October 21, 2023 6:25â€¯PM"><a href=#chatlog__message-container-1165355156624396359>10/21/2023 6:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;ve been surprised that creating an index when supplied <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">centroids</code> is taking a long time (a few hours so far.) I had naively assumed that fittingthe kmeans was the lengthy part, but I guess not. Is there anyway to make this faster? Or better, to optimize in each concurrent write?</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1165355150609756200/image.png?ex=698a268f&amp;is=6988d50f&amp;hm=82334a141cdabe367626f76d68575dc854ebbf6ebba9ee5786b83d1b5854b8fa&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1165355150609756200/image.png?ex=698a268f&amp;is=6988d50f&amp;hm=82334a141cdabe367626f76d68575dc854ebbf6ebba9ee5786b83d1b5854b8fa&amp;" alt="Image attachment" title="Image: image.png (65.49 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1165356969750708324 class=chatlog__message-container data-message-id=1165356969750708324><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, October 21, 2023 6:32â€¯PM"><a href=#chatlog__message-container-1165356969750708324>10/21/2023 6:32â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="lei.xu">@lei</span> added some optimizations to parallelize vector assignment in the past few weeks. If you havenâ€™t upgraded thatâ€™s one thing to try. Also, PQ training also requires kmeans per subvector</span></div></div></div></div><div id=chatlog__message-container-1165357582211354737 class=chatlog__message-container data-message-id=1165357582211354737><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, October 21, 2023 6:34â€¯PM">6:34â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>How long is it taking you? We released GPU support for both IVF and PQ kmeans training. If you have a gpu-instance with pytorch cuda installed, you could try just using the new feature directly? <span class="chatlog__markdown-mention" title="lei.xu">@lei</span> is working on additional optimizations so itâ€™ll get even faster in the next week or so</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1166400292292665456 class=chatlog__message-container data-message-id=1166400292292665456><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Tuesday, October 24, 2023 3:38â€¯PM"><a href=#chatlog__message-container-1166400292292665456>10/24/2023 3:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="webcoderz">@webcoderz</span> thanks for the bug report the fix is in review: <a href="https://github.com/lancedb/lancedb/pull/597">https://github.com/lancedb/lancedb/pull/597</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/pull/597><div class="chatlog__markdown chatlog__markdown-preserve">bug: (python) fix multiple embedding functions bug by changhiskhan ...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Closes #594
The embedding functions are pydantic models so multiple instances with the same parameters are considered ==, which means that if you have multiple embedding columns it&#39;s possible f...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/17ispiTeAlAzZsDBMp-ZgEysF0c2_P_5hDti9ZOX7PM/https/opengraph.githubassets.com/32ce48b988571110c81d01d52d0f7740344cc75ba6aef250bb8b9f2673848504/lancedb/lancedb/pull/597> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/17ispiTeAlAzZsDBMp-ZgEysF0c2_P_5hDti9ZOX7PM/https/opengraph.githubassets.com/32ce48b988571110c81d01d52d0f7740344cc75ba6aef250bb8b9f2673848504/lancedb/lancedb/pull/597 alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=heart><img class="chatlog__emoji chatlog__emoji--small" alt=â¤ï¸ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/2764.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1166405543154417724 class=chatlog__message-container data-message-id=1166405543154417724><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/667063403113873429/2626d511dd474b4226e0030a40b2644f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1166400292292665456')"> <span class="chatlog__markdown-mention" title="webcoderz">@webcoderz</span> thanks for the bug report the fix is in review: <a href="https://github.com/lancedb/lancedb/pull/597">https://github.com/lancedb/lancedb/pull/597</a> </span></div></div><div class=chatlog__header><span class=chatlog__author title=webcoderz data-user-id=667063403113873429>webcoderz</span> <span class=chatlog__timestamp title="Tuesday, October 24, 2023 3:59â€¯PM"><a href=#chatlog__message-container-1166405543154417724>10/24/2023 3:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Cool! Yea that was pmuch what I was thinking was the likely cause</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1166967513104523396 class=chatlog__message-container data-message-id=1166967513104523396><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1137814147799719967/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=rishabh0085 data-user-id=1137814147799719967>Rishabh</span> <span class=chatlog__timestamp title="Thursday, October 26, 2023 5:12â€¯AM"><a href=#chatlog__message-container-1166967513104523396>10/26/2023 5:12â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi</span></div></div></div></div><div id=chatlog__message-container-1166967759167553576 class=chatlog__message-container data-message-id=1166967759167553576><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 26, 2023 5:13â€¯AM">5:13â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ok, so there&#39;s this issue I got assigned, wherein pylance dependencies have to be lazily imported.</span></div></div></div></div><div id=chatlog__message-container-1166968187980611614 class=chatlog__message-container data-message-id=1166968187980611614><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 26, 2023 5:14â€¯AM">5:14â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>So my question is do I have to go to each and every file and whatever Libraries are imported must be made to import lazily..?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1166985984693522544 class=chatlog__message-container data-message-id=1166985984693522544><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1137814147799719967/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=rishabh0085>Rishabh</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1166968187980611614')"> So my question is do I have to go to each and every file and whatever Libraries are imported must be made to import lazily..? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, October 26, 2023 6:25â€¯AM"><a href=#chatlog__message-container-1166985984693522544>10/26/2023 6:25â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Which issue are you looking at?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1167016521281851517 class=chatlog__message-container data-message-id=1167016521281851517><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1137814147799719967/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=rishabh0085 data-user-id=1137814147799719967>Rishabh</span> <span class=chatlog__timestamp title="Thursday, October 26, 2023 8:27â€¯AM"><a href=#chatlog__message-container-1167016521281851517>10/26/2023 8:27â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Lance#1217</span></div></div></div></div><div id=chatlog__message-container-1167016731575865395 class=chatlog__message-container data-message-id=1167016731575865395><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 26, 2023 8:27â€¯AM">8:27â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Actually I am a beginner to opensource, so can you please guide me a bit <span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span></span></div></div></div></div><div id=chatlog__message-container-1167017646299041893 class=chatlog__message-container data-message-id=1167017646299041893><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, October 26, 2023 8:31â€¯AM">8:31â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lance/issues/1217">https://github.com/lancedb/lance/issues/1217</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/1217><div class="chatlog__markdown chatlog__markdown-preserve">Lazily import optional pylance dependencies &#183; Issue #1217 &#183; lancedb...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Right now if Pandas is installed, we will import it. This adds at least 500ms to the time to execute import lance on my machine. Not as bad, but similar story with numpy. In total, a program that j...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/-Wgc36jH3w0135t1B39ZZiTxCqPWx_AJVPoaQXRPnwg/https/opengraph.githubassets.com/4f87427eef0df9fe75126b9513a6fa9235fab401fe8c7e03b782ccff91a67492/lancedb/lance/issues/1217> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/-Wgc36jH3w0135t1B39ZZiTxCqPWx_AJVPoaQXRPnwg/https/opengraph.githubassets.com/4f87427eef0df9fe75126b9513a6fa9235fab401fe8c7e03b782ccff91a67492/lancedb/lance/issues/1217 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1167204492270370837 class=chatlog__message-container data-message-id=1167204492270370837><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1137814147799719967/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=rishabh0085 data-user-id=1137814147799719967>Rishabh</span> <span class=chatlog__timestamp title="Thursday, October 26, 2023 8:53â€¯PM"><a href=#chatlog__message-container-1167204492270370837>10/26/2023 8:53â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span> hope to here back from you soon.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1170648442377351189 class=chatlog__message-container data-message-id=1170648442377351189><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=giusedroid_41520 data-user-id=1022944279796129792>giusedroid</span> <span class=chatlog__timestamp title="Sunday, November 5, 2023 8:58â€¯AM"><a href=#chatlog__message-container-1170648442377351189>11/5/2023 8:58â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey folks! While working on a sample with NodeJS &amp; LangChain I bumped into this error. I&#39;m importing docs via the standard pdf loader

Errorr type 1: id of generated fileds is different, but the source documents are the same.
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">original=Field(id=0, name=vector, type=fixed_size_list:float:1536)\nField(id=1, name=text, type=string)\nField(id=2, name=source, type=string)\nField(id=3, name=pdf, type=struct)\nField(id=5, name=loc, type=struct)\n 
    new=Field(id=0, name=vector, type=fixed_size_list:float:1536)\nField(id=1, name=text, type=string)\nField(id=2, name=source, type=string)\nField(id=3, name=pdf, type=struct)\nField(id=30, name=loc, type=struct)\n&quot;,</code>

Error type 2: order of fields are swapped for some reasons

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">original=Field(id=0, name=vector, type=fixed_size_list:float:1536)\nField(id=1, name=text, type=string)\nField(id=2, name=source, type=string)\nField(id=3, name=pdf, type=struct)\nField(id=5, name=loc, type=struct)\n 
    new=Field(id=0, name=vector, type=fixed_size_list:float:1536)\nField(id=1, name=text, type=string)\nField(id=2, name=pdf, type=struct)\nField(id=3, name=source, type=string)\nField(id=30, name=loc, type=struct)\n&quot;,</code>

at least for the second error type, this is the line where I think the errors are coming from

<a href="https://github.com/langchain-ai/langchainjs/blob/main/langchain/src/vectorstores/lancedb.ts#L69">https://github.com/langchain-ai/langchainjs/blob/main/langchain/src/vectorstores/lancedb.ts#L69</a>

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Object.keys(documents[i].metadata).forEach((metaKey) =&gt; {</code>

I believe that the error may be due to the fact that Object.keys returns keys in the order in which they appear in the object, and sometimes the PDF loader may build the object in a different way? My suggestion would be to  implement an order guarantee such as

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Object.keys(documents[i].metadata).sort().forEach((metaKey) =&gt; {</code>


I didn&#39;t venture in the Rust implementation too much, because I don&#39;t speak rust very well</span> <span class=chatlog__edited-timestamp title="Sunday, November 5, 2023 9:01â€¯AM">(edited)</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/langchain-ai/langchainjs/blob/main/langchain/src/vectorstores/lancedb.ts><div class="chatlog__markdown chatlog__markdown-preserve">langchainjs/langchain/src/vectorstores/lancedb.ts at main &#183; langcha...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Contribute to langchain-ai/langchainjs development by creating an account on GitHub.</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/MB1ROzJtM3lbfiiq99qByWPusgSaiOS887S2EbtDTYk/https/opengraph.githubassets.com/c8896c4a11b6200b4c582e48a6bd53a209961420bdc97297d4cb5ee11c25abc7/langchain-ai/langchainjs> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/MB1ROzJtM3lbfiiq99qByWPusgSaiOS887S2EbtDTYk/https/opengraph.githubassets.com/c8896c4a11b6200b4c582e48a6bd53a209961420bdc97297d4cb5ee11c25abc7/langchain-ai/langchainjs alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1170867657592025171 class=chatlog__message-container data-message-id=1170867657592025171><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=giusedroid_41520>giusedroid</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1170648442377351189')"> Hey folks! While working on a sample with NodeJS &amp; LangChain I bumped into this error. I&#39;m importing docs via the standard pdf loader

Errorr type 1: id of generated fileds is different, but the source documents are the same.
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">original=Field(id=0, name=vector, type=fixed_size_list:float:1536)\nField(id=1, name=text, type=string)\nField(id=2, name=source, type=string)\nField(id=3, name=pdf, type=struct)\nField(id=5, name=loc, type=struct)\n 
    new=Field(id=0, name=vector, type=fixed_size_list:float:1536)\nField(id=1, name=text, type=string)\nField(id=2, name=source, type=string)\nField(id=3, name=pdf, type=struct)\nField(id=30, name=loc, type=struct)\n&quot;,</code>

Error type 2: order of fields are swapped for some reasons

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">original=Field(id=0, name=vector, type=fixed_size_list:float:1536)\nField(id=1, name=text, type=string)\nField(id=2, name=source, type=string)\nField(id=3, name=pdf, type=struct)\nField(id=5, name=loc, type=struct)\n 
    new=Field(id=0, name=vector, type=fixed_size_list:float:1536)\nField(id=1, name=text, type=string)\nField(id=2, name=pdf, type=struct)\nField(id=3, name=source, type=string)\nField(id=30, name=loc, type=struct)\n&quot;,</code>

at least for the second error type, this is the line where I think the errors are coming from

<a href="https://github.com/langchain-ai/langchainjs/blob/main/langchain/src/vectorstores/lancedb.ts#L69">https://github.com/langchain-ai/langchainjs/blob/main/langchain/src/vectorstores/lancedb.ts#L69</a>

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Object.keys(documents[i].metadata).forEach((metaKey) =&gt; {</code>

I believe that the error may be due to the fact that Object.keys returns keys in the order in which they appear in the object, and sometimes the PDF loader may build the object in a different way? My suggestion would be to  implement an order guarantee such as

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Object.keys(documents[i].metadata).sort().forEach((metaKey) =&gt; {</code>


I didn&#39;t venture in the Rust implementation too much, because I don&#39;t speak rust very well </span> <span class=chatlog__reply-edited-timestamp title="Sunday, November 5, 2023 9:01â€¯AM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Sunday, November 5, 2023 11:30â€¯PM"><a href=#chatlog__message-container-1170867657592025171>11/5/2023 11:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>would you mind filing a github issue on github.com/lancedb/lancedb ?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1172084085586411560 class=chatlog__message-container data-message-id=1172084085586411560><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=cmclean165_25187 data-user-id=1158835514686853121>mclean-connor</span> <span class=chatlog__timestamp title="Thursday, November 9, 2023 8:03â€¯AM"><a href=#chatlog__message-container-1172084085586411560>11/9/2023 8:03â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>looks like the configurable awsRegion specified in node connect() is not working as expected. I added an issue on github for it</span> <span class=chatlog__edited-timestamp title="Thursday, November 9, 2023 8:04â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173260404701528134 class=chatlog__message-container data-message-id=1173260404701528134><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kohlerbear3381 data-user-id=450637514668113921>kohlerbear</span> <span class=chatlog__timestamp title="Sunday, November 12, 2023 1:57â€¯PM"><a href=#chatlog__message-container-1173260404701528134>11/12/2023 1:57â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m occasionally running into cases where calling <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">create_index</code> (using the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cuda</code> accelerator) <em>doesn&#39;t</em> actually end up writing any indices (no <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_indices</code> directory exists after running index creation) despite the call returning successfully with no apparent error logs. This only seems to happen on larger (&gt;100 million embeddings) datasets. I&#39;ve done some quick tests and can&#39;t reproduce the behavior with smaller (&lt;100k embeddings) datasets.  Any thoughts/tips on how I could debug this further?</span> <span class=chatlog__edited-timestamp title="Sunday, November 12, 2023 1:59â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173270690506494043 class=chatlog__message-container data-message-id=1173270690506494043><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=kohlerbear3381>kohlerbear</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1173260404701528134')"> I&#39;m occasionally running into cases where calling <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">create_index</code> (using the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cuda</code> accelerator) <em>doesn&#39;t</em> actually end up writing any indices (no <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_indices</code> directory exists after running index creation) despite the call returning successfully with no apparent error logs. This only seems to happen on larger (&gt;100 million embeddings) datasets. I&#39;ve done some quick tests and can&#39;t reproduce the behavior with smaller (&lt;100k embeddings) datasets.  Any thoughts/tips on how I could debug this further? </span> <span class=chatlog__reply-edited-timestamp title="Sunday, November 12, 2023 1:59â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Sunday, November 12, 2023 2:38â€¯PM"><a href=#chatlog__message-container-1173270690506494043>11/12/2023 2:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hmmm Iâ€™m wondering whether itâ€™s hitting GPU OOM but somehow the error is being swallowed? Would you be able to share the code / output ? How many dimensions are the embeddings? Cc <span class="chatlog__markdown-mention" title="lei.xu">@lei</span></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173609629415129119 class=chatlog__message-container data-message-id=1173609629415129119><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1173270690506494043')"> Hmmm Iâ€™m wondering whether itâ€™s hitting GPU OOM but somehow the error is being swallowed? Would you be able to share the code / output ? How many dimensions are the embeddings? Cc <span class="chatlog__markdown-mention" title="lei.xu">@lei</span> </span></div></div><div class=chatlog__header><span class=chatlog__author title=kohlerbear3381 data-user-id=450637514668113921>kohlerbear</span> <span class=chatlog__timestamp title="Monday, November 13, 2023 1:05â€¯PM"><a href=#chatlog__message-container-1173609629415129119>11/13/2023 1:05â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Dataset is unfortunately private, but I was running into this with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">num_partitions=1024</code> and <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">num_sub_vectors=128</code> at around 450 million CLIP embeddings (512 dimensions). Interestingly, I was able to get this working when the underlying dataset was on local storage, but I&#39;ve run into this a a couple times when the underlying dataset was on S3 <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ¤”"
    title="thinking"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f914.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173667348134232094 class=chatlog__message-container data-message-id=1173667348134232094><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, November 13, 2023 4:55â€¯PM"><a href=#chatlog__message-container-1173667348134232094>11/13/2023 4:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="lei.xu">@lei</span> do you remember that old bug where it would write to local dir if the S3 config was incorrect? That was fixed a long time ago right?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173687640940367962 class=chatlog__message-container data-message-id=1173687640940367962><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Monday, November 13, 2023 6:15â€¯PM"><a href=#chatlog__message-container-1173687640940367962>11/13/2023 6:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>IIRC, it was fixed long time ago.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173698936553353387 class=chatlog__message-container data-message-id=1173698936553353387><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Monday, November 13, 2023 7:00â€¯PM"><a href=#chatlog__message-container-1173698936553353387>11/13/2023 7:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Sounds like the indexing process exits unsuccessfully without error messages</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173699119466938398 class=chatlog__message-container data-message-id=1173699119466938398><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, November 13, 2023 7:01â€¯PM"><a href=#chatlog__message-container-1173699119466938398>11/13/2023 7:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i guess the question is whether this is a pytorch issue or lance issue</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173703045184491620 class=chatlog__message-container data-message-id=1173703045184491620><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Monday, November 13, 2023 7:16â€¯PM"><a href=#chatlog__message-container-1173703045184491620>11/13/2023 7:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>sounds like lance index writing issue tho, if the local run has the same index parameters (i.e., number of IVF partitions)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173888692096618566 class=chatlog__message-container data-message-id=1173888692096618566><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=energetic_maypole_64699 data-user-id=1144859643500306513>Ben</span> <span class=chatlog__timestamp title="Tuesday, November 14, 2023 7:34â€¯AM"><a href=#chatlog__message-container-1173888692096618566>11/14/2023 7:34â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Iâ€™m trying to binarize my python code using pyinstaller. When I try to run the binary I get the following error: 

ImportError: The pyarrow installation is not built with support for &#39;dataset&#39; (No module named &#39;pyarrow._acero&#39;)

Itâ€™s coming from importing lancedb

Any one else run into this issue?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1173910951955791872 class=chatlog__message-container data-message-id=1173910951955791872><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Tuesday, November 14, 2023 9:03â€¯AM"><a href=#chatlog__message-container-1173910951955791872>11/14/2023 9:03â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>How did you install pyarrow? Was it built from source?</span></div></div></div></div><div id=chatlog__message-container-1173911093060579421 class=chatlog__message-container data-message-id=1173911093060579421><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, November 14, 2023 9:03â€¯AM">9:03â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Iâ€™ve never encountered this myself, though Iâ€™ve not used pyinstaller</span></div></div></div></div><div id=chatlog__message-container-1173912250545881148 class=chatlog__message-container data-message-id=1173912250545881148><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, November 14, 2023 9:08â€¯AM">9:08â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Do you need to specify hidden imports or anything like that with pyinstaller?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1174030383612973249 class=chatlog__message-container data-message-id=1174030383612973249><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=sumsao data-user-id=434172897028734979>sumsao</span> <span class=chatlog__timestamp title="Tuesday, November 14, 2023 4:57â€¯PM"><a href=#chatlog__message-container-1174030383612973249>11/14/2023 4:57â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hey <span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span> Ben and I are working together and I&#39;m the one running all this stuff. So I&#39;m not sure if this is a pyinstaller issue or not. I previously was using cx_Freeze and was getting the same issue with pyarrow.dataset. I installed it just from installing lancedb (which then installed it as a dependency). I then also tried force reinstalling it separately, and got the same issue</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1174163435886481509 class=chatlog__message-container data-message-id=1174163435886481509><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1173703045184491620')"> sounds like lance index writing issue tho, if the local run has the same index parameters (i.e., number of IVF partitions) </span></div></div><div class=chatlog__header><span class=chatlog__author title=kohlerbear3381 data-user-id=450637514668113921>kohlerbear</span> <span class=chatlog__timestamp title="Wednesday, November 15, 2023 1:46â€¯AM"><a href=#chatlog__message-container-1174163435886481509>11/15/2023 1:46â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hm, any debug parameters or anything I can provide/set for extra logging/context during the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">create_index</code> call?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1174199576782188606 class=chatlog__message-container data-message-id=1174199576782188606><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, November 15, 2023 4:09â€¯AM"><a href=#chatlog__message-container-1174199576782188606>11/15/2023 4:09â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yea, you can set <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">LANCE_LOG=info</code> it should generate some logs . Also can use <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">RUST_BACKTRACE=1</code> env var to see whether we can get some backtrace if the process exits abruptly . 

Would love to see how can we reproduce from our end</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1174745041827270696 class=chatlog__message-container data-message-id=1174745041827270696><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Thursday, November 16, 2023 4:17â€¯PM"><a href=#chatlog__message-container-1174745041827270696>11/16/2023 4:17â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">ImportError: The pyarrow installation is not built with support for &#39;dataset&#39; (No module named &#39;pyarrow._acero&#39;)
</div></div>
My best guess is that it&#39;s not finding the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">python3.11/site-packages/pyarrow/libarrow_acero.so.1300</code> shared library.  Can you confirm that is getting installed by the installer?  Are you installing on the same architecture as you are building your installer?</span></div></div></div></div><div id=chatlog__message-container-1174745075889221732 class=chatlog__message-container data-message-id=1174745075889221732><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, November 16, 2023 4:17â€¯PM">4:17â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="energetic_maypole_64699">@Ben</span></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1175150550552166461 class=chatlog__message-container data-message-id=1175150550552166461><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=energetic_maypole_64699 data-user-id=1144859643500306513>Ben</span> <span class=chatlog__timestamp title="Friday, November 17, 2023 7:08â€¯PM"><a href=#chatlog__message-container-1175150550552166461>11/17/2023 7:08â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Found a work around by adding &quot;pyarrow.vendored.version&quot; to the build</span></div></div></div></div><div id=chatlog__message-container-1175150568885461172 class=chatlog__message-container data-message-id=1175150568885461172><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, November 17, 2023 7:08â€¯PM">7:08â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>thank you for the help!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1176938296652353607 class=chatlog__message-container data-message-id=1176938296652353607><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jhsieh data-user-id=714506948132864011>jmhsieh</span> <span class=chatlog__timestamp title="Wednesday, November 22, 2023 5:32â€¯PM"><a href=#chatlog__message-container-1176938296652353607>11/22/2023 5:32â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m trying to have lancedb use google cloud storage for persistence.  I&#39;ve been able to get it working with &quot;authorized_user&quot; credentials but &quot;service_account&quot; credentials are preferred.  I thought I may have not given the service user sufficient privs but I did a quick experiment giving the service account all capabilities and I get the same error.  Is this an intended limitation or am I doing something wrong? 
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Traceback (most recent call last):
  File &quot;/home/jmhsieh/proj/feral/test_gs.py&quot;, line 54, in &lt;module&gt;
    table = db.create_table(
  File &quot;/home/jmhsieh/.ve/lib/python3.10/site-packages/lancedb/db.py&quot;, line 336, in create_table
    tbl = LanceTable.create(
  File &quot;/home/jmhsieh/.ve/lib/python3.10/site-packages/lancedb/table.py&quot;, line 890, in create
    lance.write_dataset(empty, tbl._dataset_uri, schema=schema, mode=mode)
  File &quot;/home/jmhsieh/.ve/lib/python3.10/site-packages/lance/dataset.py&quot;, line 1883, in write_dataset
    _write_dataset(reader, uri, params)
OSError: LanceError(IO): Generic GCS error: Unsupported ApplicationCredentials type: service_account, /home/runner/work/lance/lance/rust/lance-core/src/io/object_store.rs:835:30</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1176940927915405475 class=chatlog__message-container data-message-id=1176940927915405475><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/129515424571195392/824829191829fd31169e34f4c1054a61.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=zmuuuu data-user-id=129515424571195392>Zach</span> <span class=chatlog__timestamp title="Wednesday, November 22, 2023 5:43â€¯PM"><a href=#chatlog__message-container-1176940927915405475>11/22/2023 5:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>you have to set the GOOGLE_SERVICE_ACCOUNT or GOOGLE_SERVICE_ACCOUNT_KEY environment variables</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1176945893488996463 class=chatlog__message-container data-message-id=1176945893488996463><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jhsieh data-user-id=714506948132864011>jmhsieh</span> <span class=chatlog__timestamp title="Wednesday, November 22, 2023 6:02â€¯PM"><a href=#chatlog__message-container-1176945893488996463>11/22/2023 6:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks Zach.  I&#39;ll give it a try.   I&#39;ve been using the GOOGLE_APPLICATION_CREDENTIALS env variable.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1176946149811298314 class=chatlog__message-container data-message-id=1176946149811298314><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/129515424571195392/824829191829fd31169e34f4c1054a61.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=zmuuuu data-user-id=129515424571195392>Zach</span> <span class=chatlog__timestamp title="Wednesday, November 22, 2023 6:03â€¯PM"><a href=#chatlog__message-container-1176946149811298314>11/22/2023 6:03â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>no problem! you may have to set both-- not 100% sure but try it out</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1176946709696348161 class=chatlog__message-container data-message-id=1176946709696348161><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jhsieh data-user-id=714506948132864011>jmhsieh</span> <span class=chatlog__timestamp title="Wednesday, November 22, 2023 6:06â€¯PM"><a href=#chatlog__message-container-1176946709696348161>11/22/2023 6:06â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="zmuuuu">@Zach</span> looks like that worked.  Just needed GOOGLE_SERVICE_ACCOUNT =serviceaccount.json Thanks!</span> <span class=chatlog__edited-timestamp title="Wednesday, November 22, 2023 6:06â€¯PM">(edited)</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=tada><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸŽ‰ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f389.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1177250381923885236 class=chatlog__message-container data-message-id=1177250381923885236><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1060259256965791905/a0e73065f553dc3c8a3b95e1c471c4bc.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=thiagozf data-user-id=1060259256965791905>thiagozf</span> <span class=chatlog__timestamp title="Thursday, November 23, 2023 2:12â€¯PM"><a href=#chatlog__message-container-1177250381923885236>11/23/2023 2:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi. I&#39;m experimenting with LanceDB (JS), and I&#39;m not able to add records to the table using a custom schema. Here is what I&#39;m trying to do:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-ts">// Define schema
const { Field, FixedSizeList, Float32, Schema, Utf8 } = require(&#39;apache-arrow&#39;);

export const schema = new Schema([
  new Field(&#39;id&#39;, new Utf8()),
  new Field(
    &#39;vector&#39;,
    new FixedSizeList(1536, new Field(&#39;item&#39;, new Float32() /* Also tried to tweak nullable here */)),
    false // tried both nullable=true/false here
  ),
  new Field(&#39;content&#39;, new Utf8()),
  new Field(&#39;metadata&#39;, new Utf8()),
]);

// Create table
const table = await db.createTable({ name: this.getName(), schema, embeddingFunction })

// ...or if table exists
const table = await db.openTable(this.getName(), embeddingFunction);

// Add records

// Records have this type: { id: string; content: string; metadata: string; }
const data = records
  // Tried to make sure content is not empty
  .filter((r) =&gt; r.content &amp;&amp; r.content.length &gt; 0)
await table.add(data);</code></span> <span class=chatlog__edited-timestamp title="Thursday, November 23, 2023 2:14â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1177250651877671024 class=chatlog__message-container data-message-id=1177250651877671024><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1060259256965791905/a0e73065f553dc3c8a3b95e1c471c4bc.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1060259256965791905/a0e73065f553dc3c8a3b95e1c471c4bc.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=thiagozf>thiagozf</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1177250381923885236')"> Hi. I&#39;m experimenting with LanceDB (JS), and I&#39;m not able to add records to the table using a custom schema. Here is what I&#39;m trying to do:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-ts">// Define schema
const { Field, FixedSizeList, Float32, Schema, Utf8 } = require(&#39;apache-arrow&#39;);

export const schema = new Schema([
  new Field(&#39;id&#39;, new Utf8()),
  new Field(
    &#39;vector&#39;,
    new FixedSizeList(1536, new Field(&#39;item&#39;, new Float32() /* Also tried to tweak nullable here */)),
    false // tried both nullable=true/false here
  ),
  new Field(&#39;content&#39;, new Utf8()),
  new Field(&#39;metadata&#39;, new Utf8()),
]);

// Create table
const table = await db.createTable({ name: this.getName(), schema, embeddingFunction })

// ...or if table exists
const table = await db.openTable(this.getName(), embeddingFunction);

// Add records

// Records have this type: { id: string; content: string; metadata: string; }
const data = records
  // Tried to make sure content is not empty
  .filter((r) =&gt; r.content &amp;&amp; r.content.length &gt; 0)
await table.add(data);</code> </span> <span class=chatlog__reply-edited-timestamp title="Thursday, November 23, 2023 2:14â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author title=thiagozf data-user-id=1060259256965791905>thiagozf</span> <span class=chatlog__timestamp title="Thursday, November 23, 2023 2:13â€¯PM"><a href=#chatlog__message-container-1177250651877671024>11/23/2023 2:13â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This is the error:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">[Error: LanceDBError: LanceError(Schema): FileWriter::write: schema mismatch: expected: Schema { fields: [Field { name: &quot;id&quot;, data_type: Utf8, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }, Field { name: &quot;vector&quot;, data_type: FixedSizeList(Field { name: &quot;item&quot;, data_type: Float32, nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} }, 1536), nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }, Field { name: &quot;content&quot;, data_type: Utf8, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }, Field { name: &quot;metadata&quot;, data_type: Utf8, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }], metadata: {} }, actual: Schema { fields: [Field { name: &quot;id&quot;, data_type: Utf8, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }, Field { name: &quot;vector&quot;, data_type: FixedSizeList(Field { name: &quot;item&quot;, data_type: Float32, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }, 1536), nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }, Field { name: &quot;content&quot;, data_type: Utf8, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }, Field { name: &quot;metadata&quot;, data_type: Utf8, nullable: false, dict_id: 0, dict_is_ordered: false, metadata: {} }], metadata: {} }, /home/build_user/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-core-0.8.17/src/io/writer.rs:133:31]</code>

Seems like the &quot;vector&quot; mismatches because of nullable/not nullable. I&#39;ve tried to change it in the schema, without success. Am I missing something obvious?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1177653419427758130 class=chatlog__message-container data-message-id=1177653419427758130><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, November 24, 2023 4:54â€¯PM"><a href=#chatlog__message-container-1177653419427758130>11/24/2023 4:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="thiagozf">@thiagozf</span> sorry we&#39;re a bit slow - US thanksgiving here.</span></div></div></div></div><div id=chatlog__message-container-1177653562902327346 class=chatlog__message-container data-message-id=1177653562902327346><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, November 24, 2023 4:54â€¯PM">4:54â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>try tweaking the schema declaration as :

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">new Field(
    &#39;vector&#39;,
    new FixedSizeList(1536, new Field(&#39;item&#39;, new Float32() , false)),
    false
  ),</code></span></div></div></div></div><div id=chatlog__message-container-1177653638265585765 class=chatlog__message-container data-message-id=1177653638265585765><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, November 24, 2023 4:55â€¯PM">4:55â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the main difference is to declare the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">item</code> inner field also as NOT nullable</span></div></div></div></div><div id=chatlog__message-container-1177653675905265734 class=chatlog__message-container data-message-id=1177653675905265734><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, November 24, 2023 4:55â€¯PM">4:55â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>that&#39;s the main difference i spot between the schemas</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1177703011368321066 class=chatlog__message-container data-message-id=1177703011368321066><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1060259256965791905/a0e73065f553dc3c8a3b95e1c471c4bc.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1177653419427758130')"> <span class="chatlog__markdown-mention" title="thiagozf">@thiagozf</span> sorry we&#39;re a bit slow - US thanksgiving here. </span></div></div><div class=chatlog__header><span class=chatlog__author title=thiagozf data-user-id=1060259256965791905>thiagozf</span> <span class=chatlog__timestamp title="Friday, November 24, 2023 8:11â€¯PM"><a href=#chatlog__message-container-1177703011368321066>11/24/2023 8:11â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey <span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span>. Yes, I tried tweaking both the inner and outer field without success. Upgrading <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vectordb</code> package from <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">0.3.6</code> to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">0.3.8 (latest)</code> did the trick. I believe this commit has fixed the issue: <a href="https://github.com/lancedb/lancedb/commit/2737315cb2e5d10d8078283395ac7494ea886fc3">https://github.com/lancedb/lancedb/commit/2737315cb2e5d10d8078283395ac7494ea886fc3</a>. Shame on me! Sorry to bother you guys and <strong>THANK YOU</strong> for this fantastic project!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1177754281361809410 class=chatlog__message-container data-message-id=1177754281361809410><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, November 24, 2023 11:35â€¯PM"><a href=#chatlog__message-container-1177754281361809410>11/24/2023 11:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Got it! Awesome you got the problem resolved</span></div></div></div></div><div id=chatlog__message-container-1177754349930299402 class=chatlog__message-container data-message-id=1177754349930299402><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, November 24, 2023 11:35â€¯PM">11:35â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Would love to hear more about your use case if youâ€™d be open to sharing</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1178679036688486400 class=chatlog__message-container data-message-id=1178679036688486400><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=yotam_fine_75501 data-user-id=1138139168174776332>Yotam Haran</span> <span class=chatlog__timestamp title="Monday, November 27, 2023 12:49â€¯PM"><a href=#chatlog__message-container-1178679036688486400>11/27/2023 12:49â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey there! Some of our users are getting this error when trying to use our app. Any idea how we can solve this? Thanks ahead for the help!</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1178679036390678538/image.png?ex=698a80a5&amp;is=69892f25&amp;hm=39a1576b45574056ebd858e141e2e97f0bcdffc3635f24834552b47371abd5d9&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1178679036390678538/image.png?ex=698a80a5&amp;is=69892f25&amp;hm=39a1576b45574056ebd858e141e2e97f0bcdffc3635f24834552b47371abd5d9&amp;" alt="Image attachment" title="Image: image.png (197.2 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1178731236768895060 class=chatlog__message-container data-message-id=1178731236768895060><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, November 27, 2023 4:17â€¯PM"> <a href=#chatlog__message-container-1178731236768895060>11/27/2023 4:17â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1179906286461137006 class=chatlog__message-container data-message-id=1179906286461137006><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jhsieh data-user-id=714506948132864011>jmhsieh</span> <span class=chatlog__timestamp title="Thursday, November 30, 2023 10:06â€¯PM"><a href=#chatlog__message-container-1179906286461137006>11/30/2023 10:06â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;ve encountered some unexpected behavior when I try to run db.table_names() against a google cloud storage bucket.  I am able to directly open and write to google storage but for some reason I&#39;m getting nothing back from the table_names() call even though there are several present.  &quot;meta&quot; is an example table that I&#39;d expect to be returned.  Seems like a bug? 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">(.ve) ~/proj/feral$ python
Python 3.10.12 (main, Nov 20 2023, 15:14:05) [GCC 11.4.0] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import lancedb
&gt;&gt;&gt; db = lancedb.connect(&quot;gs://xxxx/lance&quot;)
&gt;&gt;&gt; db.table_names()
[]
&gt;&gt;&gt; db.open_table(&quot;meta&quot;)
LanceTable(meta)
&gt;&gt;&gt; t = db.open_table(&quot;meta&quot;)
&gt;&gt;&gt; len(t.to_pandas())
11
&gt;&gt;&gt;</code></span> <span class=chatlog__edited-timestamp title="Thursday, November 30, 2023 10:08â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1179942272616378432 class=chatlog__message-container data-message-id=1179942272616378432><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, December 1, 2023 12:29â€¯AM"> <a href=#chatlog__message-container-1179942272616378432>12/1/2023 12:29â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1181239102637609011 class=chatlog__message-container data-message-id=1181239102637609011><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/421450044827500554/919c62e7a6948caa25a6dc840ded2532.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=felipebcs data-user-id=421450044827500554>felipebcs</span> <span class=chatlog__timestamp title="Monday, December 4, 2023 2:22â€¯PM"><a href=#chatlog__message-container-1181239102637609011>12/4/2023 2:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi guys! How can we store a lance file in a minio store? 

If I try it like this:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-python">lance.write_dataset(data, &quot;https://minio_host/bucket/object_key&quot;)</code>

Then I get:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">File &quot;/home/ray/.local/lib/python3.8/site-packages/lance/dataset.py&quot;, line 1883, in write_dataset
    _write_dataset(reader, uri, params)
OSError: Dataset at path https://minio_host/bucket/object_key was not found: No such file or directory (os error 2), /home/runner/work/lance/lance/rust/lance-core/src/io/object_store.rs:969:27</code>

If I use <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">s3://</code> instead of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">https:// </code>, it&#39;ll actually try to reach AWS S3, not the desired minio service.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1181267791844749332 class=chatlog__message-container data-message-id=1181267791844749332><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/421450044827500554/919c62e7a6948caa25a6dc840ded2532.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=felipebcs>felipebcs</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1181239102637609011')"> Hi guys! How can we store a lance file in a minio store? 

If I try it like this:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-python">lance.write_dataset(data, &quot;https://minio_host/bucket/object_key&quot;)</code>

Then I get:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">File &quot;/home/ray/.local/lib/python3.8/site-packages/lance/dataset.py&quot;, line 1883, in write_dataset
    _write_dataset(reader, uri, params)
OSError: Dataset at path https://minio_host/bucket/object_key was not found: No such file or directory (os error 2), /home/runner/work/lance/lance/rust/lance-core/src/io/object_store.rs:969:27</code>

If I use <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">s3://</code> instead of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">https:// </code>, it&#39;ll actually try to reach AWS S3, not the desired minio service. </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Monday, December 4, 2023 4:16â€¯PM"><a href=#chatlog__message-container-1181267791844749332>12/4/2023 4:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi Felipe. To connect, you should use the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">s3://</code> scheme and set the environment variable <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">AWS_ENDPOINT</code> to the S3 endpoint of your Minio server.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1181498998423572540 class=chatlog__message-container data-message-id=1181498998423572540><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, December 5, 2023 7:35â€¯AM"><a href=#chatlog__message-container-1181498998423572540>12/5/2023 7:35â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We have not tested on minio, could you try use minio s3 endpint?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1181603334734495835 class=chatlog__message-container data-message-id=1181603334734495835><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/421450044827500554/919c62e7a6948caa25a6dc840ded2532.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=felipebcs data-user-id=421450044827500554>felipebcs</span> <span class=chatlog__timestamp title="Tuesday, December 5, 2023 2:29â€¯PM"><a href=#chatlog__message-container-1181603334734495835>12/5/2023 2:29â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi! Thanks for the response, <span class="chatlog__markdown-mention" title="wjones127">@Will Jones</span> and <span class="chatlog__markdown-mention" title="lei.xu">@lei</span>. I&#39;ve tested setting these variables: <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">AWS_ENDPOINT</code>, <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">AWS_ACCESS_KEY_ID</code> and <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">AWS_SECRET_ACCESS_KEY</code>.

This is the error I&#39;m getting now:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">[2023-12-04T17:01:02Z WARN  aws_config::imds::region] failed to load region from IMDS err=failed to load IMDS session token: service error: invalid token (FailedToLoadToken(FailedToLoadToken ...</code>

The token should be right, but I&#39;ll re-check soon</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1181632788684878018 class=chatlog__message-container data-message-id=1181632788684878018><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, December 5, 2023 4:26â€¯PM"> <a href=#chatlog__message-container-1181632788684878018>12/5/2023 4:26â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1182789701661376522 class=chatlog__message-container data-message-id=1182789701661376522><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, December 8, 2023 9:04â€¯PM"><a href=#chatlog__message-container-1182789701661376522>12/8/2023 9:04â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">OSError: LanceError(IO): Resources exhausted: Failed to allocate additional 5618883160 bytes for ExternalSorter[0] with 0 bytes already allocated - maximum available is 4284481536, /rustc/79e9716c980570bfd1f666e3b16ac583f0168962/library/core/src/convert/mod.rs:716:9</code>

while calling:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight"># ds is 41M rows
 ds.create_index(
            &quot;vectors&quot;,
            index_type,  # IVF_PQ
            num_partitions,   # 32768
            num_sub_vectors,  # 192
            ivf_centroids=precomputed_centroids, # an array of [32768, 1536]
            metric=&quot;l2&quot;,
            use_opq=False,
            accelerator=accelerator, # =None
        )</code>`

is the error complaining about not having enough RAM? or is that disk space (I just checked and it has plenty of disk...)

thank you!</span> <span class=chatlog__edited-timestamp title="Friday, December 8, 2023 9:04â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1182793144534835246 class=chatlog__message-container data-message-id=1182793144534835246><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, December 8, 2023 9:17â€¯PM"> <a href=#chatlog__message-container-1182793144534835246>12/8/2023 9:17â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1192226734066634872 class=chatlog__message-container data-message-id=1192226734066634872><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/535805966927790091/2a972be74d56102f99d390c2dcf58fff.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=smkiv data-user-id=535805966927790091>Mark</span> <span class=chatlog__timestamp title="Wednesday, January 3, 2024 10:03â€¯PM"><a href=#chatlog__message-container-1192226734066634872>1/3/2024 10:03â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hey - heads up, i noticed that when you run search with a prefiltered where clause and the where clause leaves the query with no records to search through, the query disregards the where clause and returns matches across all records, whereas i would&#39;ve expected no results. is this intended behavior?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195416121977868308 class=chatlog__message-container data-message-id=1195416121977868308><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:16â€¯PM"><a href=#chatlog__message-container-1195416121977868308>1/12/2024 5:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Not sure if this is a bug, but I have a script that has added about 25,000 records (including 1536 dimension vectors and additional columns).  I&#39;m now at over 25GB, and I will not have room to continue populating this database on the current VM.  Most of the data is in _versions.  Am I doing something wrong?  Seems like a snapshot of every version is being saved (with each insert).  Can I clean this up somehow, and prevent every single version from being saved in the future?  I&#39;m using Python.</span> <span class=chatlog__edited-timestamp title="Friday, January 12, 2024 5:17â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195416705216806984 class=chatlog__message-container data-message-id=1195416705216806984><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=russw_>russw_</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1195416121977868308')"> Not sure if this is a bug, but I have a script that has added about 25,000 records (including 1536 dimension vectors and additional columns).  I&#39;m now at over 25GB, and I will not have room to continue populating this database on the current VM.  Most of the data is in _versions.  Am I doing something wrong?  Seems like a snapshot of every version is being saved (with each insert).  Can I clean this up somehow, and prevent every single version from being saved in the future?  I&#39;m using Python. </span> <span class=chatlog__reply-edited-timestamp title="Friday, January 12, 2024 5:17â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:19â€¯PM"><a href=#chatlog__message-container-1195416705216806984>1/12/2024 5:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Try running <a href="https://lancedb.github.io/lance/api/python/lance.html#lance.dataset.LanceDataset.cleanup_old_versions">https://lancedb.github.io/lance/api/python/lance.html#lance.dataset.LanceDataset.cleanup_old_versions</a></span></div></div></div></div><div id=chatlog__message-container-1195417276862713978 class=chatlog__message-container data-message-id=1195417276862713978><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, January 12, 2024 5:21â€¯PM">5:21â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">prevent every single version from being saved in the future?
</div></div>No, but you can run cleanup as frequently as you want.  Old versions are kept for two reasons.  1, we never modify files in place because we assume the underlying filesystem doesn&#39;t support it and it creates concurrency / scaling issues on the read path.  2, we want to support restoring an older version.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195417755999023194 class=chatlog__message-container data-message-id=1195417755999023194><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1195416705216806984')"> Try running <a href="https://lancedb.github.io/lance/api/python/lance.html#lance.dataset.LanceDataset.cleanup_old_versions">https://lancedb.github.io/lance/api/python/lance.html#lance.dataset.LanceDataset.cleanup_old_versions</a> </span></div></div><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:23â€¯PM"><a href=#chatlog__message-container-1195417755999023194>1/12/2024 5:23â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks!  I saw that, but I think I&#39;m not understanding where that class is defined.  Is it in the lancedb Python package?  Can I call this on the table itself once it is loaded?  tbl= db.open_table(&quot;textembeddings&quot;) and then do tbl.cleanup_old_versions?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195418400055378051 class=chatlog__message-container data-message-id=1195418400055378051><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:25â€¯PM"><a href=#chatlog__message-container-1195418400055378051>1/12/2024 5:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ah, I don&#39;t know that cleanup is in lancedb yet (just lance) but you can do...

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">tbl = db.open_table(&quot;textembeddings&quot;)
tbl.to_lance().cleanup_old_versions()</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195418562488184903 class=chatlog__message-container data-message-id=1195418562488184903><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:26â€¯PM"><a href=#chatlog__message-container-1195418562488184903>1/12/2024 5:26â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ok, thanks.  And I guess there&#39;s no need to specify a time interval, I can just let it cleanup all old versions.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195418564258181331 class=chatlog__message-container data-message-id=1195418564258181331><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:26â€¯PM"><a href=#chatlog__message-container-1195418564258181331>1/12/2024 5:26â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>You might need to specify arguments.  By default <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cleanup_old_versions</code> will only cleanup stuff that is older than two weeks</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195418698903719947 class=chatlog__message-container data-message-id=1195418698903719947><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:27â€¯PM"><a href=#chatlog__message-container-1195418698903719947>1/12/2024 5:27â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ah, ok! You just answered my question.  But the timedelta format is not specified in the docs</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195418902306500680 class=chatlog__message-container data-message-id=1195418902306500680><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:27â€¯PM"><a href=#chatlog__message-container-1195418902306500680>1/12/2024 5:27â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It&#39;s a python timedelta: <a href="https://docs.python.org/3/library/datetime.html#timedelta-objects">https://docs.python.org/3/library/datetime.html#timedelta-objects</a>

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">import datetime
...
tbl.to_lance().cleanup_old_versions(datetime.timedelta(seconds=1))</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195418960234020975 class=chatlog__message-container data-message-id=1195418960234020975><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1195418902306500680')"> It&#39;s a python timedelta: <a href="https://docs.python.org/3/library/datetime.html#timedelta-objects">https://docs.python.org/3/library/datetime.html#timedelta-objects</a>

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">import datetime
...
tbl.to_lance().cleanup_old_versions(datetime.timedelta(seconds=1))</code> </span></div></div><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:28â€¯PM"><a href=#chatlog__message-container-1195418960234020975>1/12/2024 5:28â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Awesome, thanks!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195419067574665307 class=chatlog__message-container data-message-id=1195419067574665307><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:28â€¯PM"><a href=#chatlog__message-container-1195419067574665307>1/12/2024 5:28â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>If you&#39;re adding data in a piecemeal fashion you will probably also want to run compaction on a semi-regular basis for performance reasons.  Let me see what that API is</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195419286857064609 class=chatlog__message-container data-message-id=1195419286857064609><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1195419067574665307')"> If you&#39;re adding data in a piecemeal fashion you will probably also want to run compaction on a semi-regular basis for performance reasons.  Let me see what that API is </span></div></div><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:29â€¯PM"><a href=#chatlog__message-container-1195419286857064609>1/12/2024 5:29â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Nice.  I could put it in a cron job.  My main concern is when all of the data is being inserted for the first time.  The version history is killing the disk space.</span></div></div></div></div><div id=chatlog__message-container-1195419502352023643 class=chatlog__message-container data-message-id=1195419502352023643><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, January 12, 2024 5:30â€¯PM">5:30â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I need to run to board a flight.  Might have wifi there, so I&#39;ll check back in but thanks @WestonPace for all of your help.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195419678928015501 class=chatlog__message-container data-message-id=1195419678928015501><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:31â€¯PM"><a href=#chatlog__message-container-1195419678928015501>1/12/2024 5:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Huh...looking at the code it looks like <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cleanup_old_verisons</code> should also exist on a lancedb table.  So you should just be able to do:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">tbl.cleanup_old_versions(datetime.timedelta(seconds=1))</code>

Also, compaction is
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">tbl.compact_files()</code>

Have a safe flight</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195420877332959343 class=chatlog__message-container data-message-id=1195420877332959343><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1195419678928015501')"> Huh...looking at the code it looks like <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cleanup_old_verisons</code> should also exist on a lancedb table.  So you should just be able to do:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">tbl.cleanup_old_versions(datetime.timedelta(seconds=1))</code>

Also, compaction is
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">tbl.compact_files()</code>

Have a safe flight </span></div></div><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 5:35â€¯PM"><a href=#chatlog__message-container-1195420877332959343>1/12/2024 5:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks!  I&#39;m giviing it a shot now.  It is running but taking quite a while.  I&#39;m not actually sure if it&#39;s working since the disk space is still the same.  It might be &quot;thinking.&quot; I have it running in a screen session so I&#39;ll check in a bit.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195443909103468716 class=chatlog__message-container data-message-id=1195443909103468716><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1195419678928015501')"> Huh...looking at the code it looks like <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cleanup_old_verisons</code> should also exist on a lancedb table.  So you should just be able to do:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">tbl.cleanup_old_versions(datetime.timedelta(seconds=1))</code>

Also, compaction is
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">tbl.compact_files()</code>

Have a safe flight </span></div></div><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 7:07â€¯PM"><a href=#chatlog__message-container-1195443909103468716>1/12/2024 7:07â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks.  This seems to have worked.  Reduced from over 30GB to 750MB.  Big difference.  I understand the desire to retain versions, but seems as though there needs to be a more a efficient way to do it -- or a configuration parameter to shut it off or auto-delete older versions.  I think that this will likely cause problems for those who are creating large data sets.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195445907341185196 class=chatlog__message-container data-message-id=1195445907341185196><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 7:15â€¯PM"><a href=#chatlog__message-container-1195445907341185196>1/12/2024 7:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I agree.  I know we&#39;ve been looking at things like &quot;auto compaction after X fragments&quot; and maybe we need something like &quot;auto cleanup after X versions&quot;</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195446050132078612 class=chatlog__message-container data-message-id=1195446050132078612><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/444509372027240450/9c13cf060800840c8904b38bc952ad31.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1195445907341185196')"> I agree.  I know we&#39;ve been looking at things like &quot;auto compaction after X fragments&quot; and maybe we need something like &quot;auto cleanup after X versions&quot; </span></div></div><div class=chatlog__header><span class=chatlog__author title=russw_ data-user-id=444509372027240450>russw_</span> <span class=chatlog__timestamp title="Friday, January 12, 2024 7:15â€¯PM"><a href=#chatlog__message-container-1195446050132078612>1/12/2024 7:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yes, that would be a good idea.  Or a way to specify when inserting a record that it should not prompt a new version to be saved (especially useful for initial data population)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195746024979964094 class=chatlog__message-container data-message-id=1195746024979964094><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=archtoad data-user-id=834498751384125491>archtoad</span> <span class=chatlog__timestamp title="Saturday, January 13, 2024 3:07â€¯PM"><a href=#chatlog__message-container-1195746024979964094>1/13/2024 3:07â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lancedb/issues/812">https://github.com/lancedb/lancedb/issues/812</a> nasty bug that was breaking all my unit tests</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195828409075515553 class=chatlog__message-container data-message-id=1195828409075515553><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Saturday, January 13, 2024 8:35â€¯PM"><a href=#chatlog__message-container-1195828409075515553>1/13/2024 8:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="archtoad">@archtoad</span> this is an expected behavior. LanceDB use a copy-on-write disk layout, when you modify the data (i.e., deleting rows), a new version will be created. Any reference to the old version will not reflect the new changes.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195850543042666606 class=chatlog__message-container data-message-id=1195850543042666606><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, January 13, 2024 10:03â€¯PM"><a href=#chatlog__message-container-1195850543042666606>1/13/2024 10:03â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m getting an error when I compact my dataset:

OSError: Commit conflict for version 607: Failed to commit the transaction after 5 retries., /home/runner/work/lance/lance/rust/lance/src/io/commit.rs:399:19

I&#39;ve now rebuilt the whole thing from scratch a few times now (~1TB in size) and I&#39;m still getting the same error. Unfortunately due to size it&#39;s hard for me give a bug that reproduces well</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195855279460454485 class=chatlog__message-container data-message-id=1195855279460454485><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Saturday, January 13, 2024 10:21â€¯PM"> <a href=#chatlog__message-container-1195855279460454485>1/13/2024 10:21â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195976153526190101 class=chatlog__message-container data-message-id=1195976153526190101><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1195828409075515553')"> <span class="chatlog__markdown-mention" title="archtoad">@archtoad</span> this is an expected behavior. LanceDB use a copy-on-write disk layout, when you modify the data (i.e., deleting rows), a new version will be created. Any reference to the old version will not reflect the new changes. </span></div></div><div class=chatlog__header><span class=chatlog__author title=archtoad data-user-id=834498751384125491>archtoad</span> <span class=chatlog__timestamp title="Sunday, January 14, 2024 6:22â€¯AM"><a href=#chatlog__message-container-1195976153526190101>1/14/2024 6:22â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Is there a method to â€œrefreshâ€ a table so itâ€™s at the latest version?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1195976459827810367 class=chatlog__message-container data-message-id=1195976459827810367><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Sunday, January 14, 2024 6:23â€¯AM"><a href=#chatlog__message-container-1195976459827810367>1/14/2024 6:23â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>usually just reopen the table <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">db.open_table()</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197339785031864401 class=chatlog__message-container data-message-id=1197339785031864401><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 12:40â€¯AM"><a href=#chatlog__message-container-1197339785031864401>1/18/2024 12:40â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;ve got a bug that results in huge search times -- a single vector search can take up to 15 seconds! I started investigating, and it looks like the centroids are pretty weird. A typical centroid has a magnitude which is 100x larger (see the 2nd screenshot -- the values are typically in the -300 to +300) than my vectors (see 3rd screenshot, values are roughly -1 to 1). The way i am building the index is on the GPU; aside from that nothing is particularly different. I can keep investigating the centroids, but wanted to see if y&#39;all had any thoughts or leads as I dive in</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1197339783949717535/image.png?ex=698a7e91&amp;is=69892d11&amp;hm=88ac9e142db5a5bf8df8fc2f8bb92f69fc72097e1286adbeec45fa3aa667cd52&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1197339783949717535/image.png?ex=698a7e91&amp;is=69892d11&amp;hm=88ac9e142db5a5bf8df8fc2f8bb92f69fc72097e1286adbeec45fa3aa667cd52&amp;" alt="Image attachment" title="Image: image.png (55.07 KB)" loading=lazy> </a></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1197339784348192769/image.png?ex=698a7e92&amp;is=69892d12&amp;hm=5305e2cea510f321ff34f50913b1fa1c48f1d7229f22b0cf6928f99686fc05a1&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1197339784348192769/image.png?ex=698a7e92&amp;is=69892d12&amp;hm=5305e2cea510f321ff34f50913b1fa1c48f1d7229f22b0cf6928f99686fc05a1&amp;" alt="Image attachment" title="Image: image.png (173.46 KB)" loading=lazy> </a></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1197339784604028928/image.png?ex=698a7e92&amp;is=69892d12&amp;hm=a1d8a8c825f0931c70f8934bbb4df22fe35da0ade5ea9b5fde17c83daa5a220e&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1197339784604028928/image.png?ex=698a7e92&amp;is=69892d12&amp;hm=a1d8a8c825f0931c70f8934bbb4df22fe35da0ade5ea9b5fde17c83daa5a220e&amp;" alt="Image attachment" title="Image: image.png (163.47 KB)" loading=lazy> </a></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1197339784859893760/image.png?ex=698a7e92&amp;is=69892d12&amp;hm=fad027d51d8085bb43ae47723130d75425129381b9432cd10bbb52e0b99707a1&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1197339784859893760/image.png?ex=698a7e92&amp;is=69892d12&amp;hm=fad027d51d8085bb43ae47723130d75425129381b9432cd10bbb52e0b99707a1&amp;" alt="Image attachment" title="Image: image.png (74.98 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197389221925756948 class=chatlog__message-container data-message-id=1197389221925756948><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 3:57â€¯AM"><a href=#chatlog__message-container-1197389221925756948>1/18/2024 3:57â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This seems wrong, the partition <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">length=0</code> means this partition is empty. Can you take a look of 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">[p[&quot;length&quot;] for p in stats[&quot;partitions&quot;]]</code>. Are they mostly zeros?</span> <span class=chatlog__edited-timestamp title="Thursday, January 18, 2024 4:11â€¯AM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1197390149403807776 class=chatlog__message-container data-message-id=1197390149403807776><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, January 18, 2024 4:00â€¯AM">4:00â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> :this:</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197401698419871796 class=chatlog__message-container data-message-id=1197401698419871796><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1197389221925756948')"> This seems wrong, the partition <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">length=0</code> means this partition is empty. Can you take a look of 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">[p[&quot;length&quot;] for p in stats[&quot;partitions&quot;]]</code>. Are they mostly zeros? </span> <span class=chatlog__reply-edited-timestamp title="Thursday, January 18, 2024 4:11â€¯AM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 4:46â€¯AM"><a href=#chatlog__message-container-1197401698419871796>1/18/2024 4:46â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>weird. it says ds.has_index=True too</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197403746364297266 class=chatlog__message-container data-message-id=1197403746364297266><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 4:54â€¯AM"><a href=#chatlog__message-container-1197403746364297266>1/18/2024 4:54â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>ok, something bizarre has happened or i&#39;m going crazy. i can no longer reproduce any screenshots above. the index centroids don&#39;t look weird any more. and searches return in the expected amount of time.</span></div></div></div></div><div id=chatlog__message-container-1197403901205434460 class=chatlog__message-container data-message-id=1197403901205434460><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, January 18, 2024 4:55â€¯AM">4:55â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the partitions look fine now too</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1197403901016670238/image.png?ex=698a1188&amp;is=6988c008&amp;hm=8704851ab2d66b56665d1142d37eebb82ea2efc4f2227a8221faae0ed1c1808a&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1197403901016670238/image.png?ex=698a1188&amp;is=6988c008&amp;hm=8704851ab2d66b56665d1142d37eebb82ea2efc4f2227a8221faae0ed1c1808a&amp;" alt="Image attachment" title="Image: image.png (136.92 KB)" loading=lazy> </a></div></div></div></div><div id=chatlog__message-container-1197403975608184853 class=chatlog__message-container data-message-id=1197403975608184853><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, January 18, 2024 4:55â€¯AM">4:55â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>anyway, i&#39;ll chalk it up to a weird heisenbug. sorry for wasting your time!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197405207647236137 class=chatlog__message-container data-message-id=1197405207647236137><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 5:00â€¯AM"><a href=#chatlog__message-container-1197405207647236137>1/18/2024 5:00â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the index uuid looks different from this screen shot and the last one. same dataset? or possibly that other ds was an old version?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197407522408108182 class=chatlog__message-container data-message-id=1197407522408108182><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 5:10â€¯AM"><a href=#chatlog__message-container-1197407522408108182>1/18/2024 5:10â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>maybe. but i&#39;m wary of that and reloaded the dataset again and again, and restarted my notebook kernel multiple times</span></div></div></div></div><div id=chatlog__message-container-1197407601009373214 class=chatlog__message-container data-message-id=1197407601009373214><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, January 18, 2024 5:10â€¯AM">5:10â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>but that seems to most likely explanation</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197407997090082877 class=chatlog__message-container data-message-id=1197407997090082877><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 5:11â€¯AM"><a href=#chatlog__message-container-1197407997090082877>1/18/2024 5:11â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hopefully just a one time thing. If it happens again please let us know <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™"
    title="pray"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197409066704719965 class=chatlog__message-container data-message-id=1197409066704719965><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 5:16â€¯AM"><a href=#chatlog__message-container-1197409066704719965>1/18/2024 5:16â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i will!</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197498515425865730 class=chatlog__message-container data-message-id=1197498515425865730><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=jagan2274 data-user-id=1100071470547341314>Jagan</span> <span class=chatlog__timestamp title="Thursday, January 18, 2024 11:11â€¯AM"><a href=#chatlog__message-container-1197498515425865730>1/18/2024 11:11â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We&#39;ve encountered an error when connecting to LanceDB in GCP. The specific error is a LanceError(IO) with the message &quot;Generic GCS error: Unsupported ApplicationCredentials type: service_account,&quot; originating from the file &quot;/Users/runner/work/lance/lance/rust/lance-core/src/error.rs&quot; at line 115, column 23.

Could someone provide assistance in resolving this error?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1197554080499892403 class=chatlog__message-container data-message-id=1197554080499892403><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, January 18, 2024 2:52â€¯PM"> <a href=#chatlog__message-container-1197554080499892403>1/18/2024 2:52â€¯PM</a> </span></div></div></div><div id=chatlog__message-container-1197580762829041779 class=chatlog__message-container data-message-id=1197580762829041779><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, January 18, 2024 4:38â€¯PM"> <a href=#chatlog__message-container-1197580762829041779>1/18/2024 4:38â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1198288316714467459 class=chatlog__message-container data-message-id=1198288316714467459><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1161666983142641795/1f6912b050b12356d6e9f090ec12eb03.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=boonheng_65484 data-user-id=1161666983142641795>Boon Heng</span> <span class=chatlog__timestamp title="Saturday, January 20, 2024 3:29â€¯PM"><a href=#chatlog__message-container-1198288316714467459>1/20/2024 3:29â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, I am trying to use lancedb in our internal minio store that has tls configured. Is there a way I could specify a ca certificate? I try setting the environment variable <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">AWS_CA_BUNDLE </code> but it doesn&#39;t seem to work.  Also, if needed, is there an option to disable SSL certificate verification?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1198347884802875527 class=chatlog__message-container data-message-id=1198347884802875527><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Saturday, January 20, 2024 7:26â€¯PM"> <a href=#chatlog__message-container-1198347884802875527>1/20/2024 7:26â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1198848336451620924 class=chatlog__message-container data-message-id=1198848336451620924><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Monday, January 22, 2024 4:35â€¯AM"><a href=#chatlog__message-container-1198848336451620924>1/22/2024 4:35â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>got some more weirdness on GPU index creation. trying to create an index on a GPU, on a 50Mx1920D index 

with code (on pylance==0.9.8):
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ds = ds.create_index(&quot;vectors&quot;,index_type=&quot;IVF_PQ&quot;,replace=True,num_partitions=32768,num_sub_vectors=240,metric=&quot;l2&quot;,use_opq=False,accelerator=&quot;cuda&quot;))</code>
... but it&#39;s taken almost 72h so far and still going. the 8x CPU is at 100% the last three days; the tmpdir takes up ~70GB which seems a bit larger than expected; the GPU is basically always at 0%, but there&#39;s active memory usage. i haven&#39;t had eyes on the GPU usage spiking up at all, but I&#39;m guessing it does sometimes get used because the model is in memory and log lines come out. i don&#39;t really know what&#39;s up, but high CPU usage, high disk usage, low gpu usage, but active gpu memory usage: my guess would be the dataloader is somehow is failing to keep the GPU fed?</span> <span class=chatlog__edited-timestamp title="Monday, January 22, 2024 4:37â€¯AM">(edited)</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1198848336250277951/image.png?ex=698a0cc4&amp;is=6988bb44&amp;hm=cc369b3a4318ad6446a12b7db98d64e65c89cef04d26437db3a36eee8c2378fc&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1198848336250277951/image.png?ex=698a0cc4&amp;is=6988bb44&amp;hm=cc369b3a4318ad6446a12b7db98d64e65c89cef04d26437db3a36eee8c2378fc&amp;" alt="Image attachment" title="Image: image.png (109.73 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1199383006536814692 class=chatlog__message-container data-message-id=1199383006536814692><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/390203590469222400/355786ddd5d0645e543c1e82a87bff86.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=evgenys91 data-user-id=390203590469222400>Eugene Sorokin</span> <span class=chatlog__timestamp title="Tuesday, January 23, 2024 3:59â€¯PM"><a href=#chatlog__message-container-1199383006536814692>1/23/2024 3:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello, first of all thank you very much for awesome product, I have more question than bug report, hope that&#39;s ok. 

I&#39;m using <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vectordb</code> library in electron environment with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">@xenova/transformers</code> for embedding and mostly it works well, but small part of our users experience the following error:
on <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Windows (both 32,64bit)</code> environment table search doesn&#39;t work and leads to application crash with message <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">app exited with code 3221225501</code>. 

I tracked down the line to 
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">const buffer = await tableSearch.call(this._tbl, this, isElectron)</code>

Actually it&#39;s very similar to this issue:
<a href="https://github.com/lancedb/lancedb/issues/382">https://github.com/lancedb/lancedb/issues/382</a>

I noticed that for these few cases that we found there&#39;s one common thing: they all use old CPUs without AVX instructions support.
So my question is the following: does <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lancedb</code> have hardware requirements, especially for CPU ? 

Libraries used:
<ul><li><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">electron@28.1.1</code></li><li><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vectordb@0.4.3</code></li><li><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">@xenova/transformers@2.13.4</code></li></ul></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/382><div class="chatlog__markdown chatlog__markdown-preserve">[Typescript] Vector search crashes in Electron environment without ...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">From discord When I run identical code in typescript and then the same code in electron, populating the database works perfectly as does getting length, adding, etc. For some reason queryâ€”for ident...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/OMCjbffSKgOvyZwUM1XOpIKfJWq85lClt5_LBBOBoTU/https/opengraph.githubassets.com/5de6ed2f5023f50258f478032ab40f4e844ef0dbbeb9dc59fd41a9b58e30b46c/lancedb/lancedb/issues/382> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/OMCjbffSKgOvyZwUM1XOpIKfJWq85lClt5_LBBOBoTU/https/opengraph.githubassets.com/5de6ed2f5023f50258f478032ab40f4e844ef0dbbeb9dc59fd41a9b58e30b46c/lancedb/lancedb/issues/382 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1199386805536047134 class=chatlog__message-container data-message-id=1199386805536047134><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/390203590469222400/355786ddd5d0645e543c1e82a87bff86.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=evgenys91>Eugene Sorokin</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1199383006536814692')"> Hello, first of all thank you very much for awesome product, I have more question than bug report, hope that&#39;s ok. 

I&#39;m using <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vectordb</code> library in electron environment with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">@xenova/transformers</code> for embedding and mostly it works well, but small part of our users experience the following error:
on <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Windows (both 32,64bit)</code> environment table search doesn&#39;t work and leads to application crash with message <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">app exited with code 3221225501</code>. 

I tracked down the line to 
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">const buffer = await tableSearch.call(this._tbl, this, isElectron)</code>

Actually it&#39;s very similar to this issue:
<a href="https://github.com/lancedb/lancedb/issues/382">https://github.com/lancedb/lancedb/issues/382</a>

I noticed that for these few cases that we found there&#39;s one common thing: they all use old CPUs without AVX instructions support.
So my question is the following: does <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lancedb</code> have hardware requirements, especially for CPU ? 

Libraries used:
<ul><li><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">electron@28.1.1</code></li><li><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vectordb@0.4.3</code></li><li><code class="chatlog__markdown-pre chatlog__markdown-pre--inline">@xenova/transformers@2.13.4</code></li></ul> </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, January 23, 2024 4:14â€¯PM"><a href=#chatlog__message-container-1199386805536047134>1/23/2024 4:14â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I think we likely do require AVX instructions, but <span class="chatlog__markdown-mention" title="lei.xu">@lei</span> would know better than I on that.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1199389317391470712 class=chatlog__message-container data-message-id=1199389317391470712><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Tuesday, January 23, 2024 4:24â€¯PM"><a href=#chatlog__message-container-1199389317391470712>1/23/2024 4:24â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We should document this but I think, for pypi wheels, we expect:
<ul><li>x86_64 -&gt; avx2, fma, f16c</li></ul><ul><li>aarch64 -&gt; neon, fp16</li></ul>
If you build from source you can customize this.  I believe we have scalar workarounds of all the vectorized paths so you should be able to build without any hardware requirements but I don&#39;t know if we have that tested in CI.</span> <span class=chatlog__edited-timestamp title="Tuesday, January 23, 2024 4:25â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1199401236894593213 class=chatlog__message-container data-message-id=1199401236894593213><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Tuesday, January 23, 2024 5:12â€¯PM"><a href=#chatlog__message-container-1199401236894593213>1/23/2024 5:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="lei.xu">@lei</span> I thought there was a slow path that skips SIMD</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1199403520751849523 class=chatlog__message-container data-message-id=1199403520751849523><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, January 23, 2024 5:21â€¯PM"><a href=#chatlog__message-container-1199403520751849523>1/23/2024 5:21â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We build the binary with Haswell as the minimal cpu support</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1199403920821325924 class=chatlog__message-container data-message-id=1199403920821325924><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1199389317391470712')"> We should document this but I think, for pypi wheels, we expect:
<ul><li>x86_64 -&gt; avx2, fma, f16c</li></ul><ul><li>aarch64 -&gt; neon, fp16</li></ul>
If you build from source you can customize this.  I believe we have scalar workarounds of all the vectorized paths so you should be able to build without any hardware requirements but I don&#39;t know if we have that tested in CI. </span> <span class=chatlog__reply-edited-timestamp title="Tuesday, January 23, 2024 4:25â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Tuesday, January 23, 2024 5:22â€¯PM"><a href=#chatlog__message-container-1199403920821325924>1/23/2024 5:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This is electron / Node, not Python.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1199407054230663269 class=chatlog__message-container data-message-id=1199407054230663269><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, January 23, 2024 5:35â€¯PM"><a href=#chatlog__message-container-1199407054230663269>1/23/2024 5:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We dont really have i686 (32 bit) support on windows. It is kind surprise to me that LanceDB  worked at all 
<a href="https://www.npmjs.com/package/vectordb?activeTab=dependencies">https://www.npmjs.com/package/vectordb?activeTab=dependencies</a>

For its dependency, we do have a rust flag setup here.
<a href="https://github.com/lancedb/lance/blob/main/rust/.cargo/config.toml#L31">https://github.com/lancedb/lance/blob/main/rust/.cargo/config.toml#L31</a> 

<span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span> for L2 / f32, we fixed the code to use auto-vectorization, so there should no be raw asm in the code path from the nodejs sdk</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(203,56,55,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href="https://www.npmjs.com/package/vectordb?activeTab=dependencies"><div class="chatlog__markdown chatlog__markdown-preserve">vectordb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Serverless, low-latency vector database for AI applications. Latest version: 0.4.3, last published: 12 days ago. Start using vectordb in your project by running <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">npm i vectordb</code>. There are 2 other projects in the npm registry using vectordb.</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/Ad-xJpugnwmVAyOVzIOuFNMDAfzOhcQNxVhcqe5tL1g/https/static-production.npmjs.com/338e4905a2684ca96e08c7780fc68412.png> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/Ad-xJpugnwmVAyOVzIOuFNMDAfzOhcQNxVhcqe5tL1g/https/static-production.npmjs.com/338e4905a2684ca96e08c7780fc68412.png alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/blob/main/rust/.cargo/config.toml><div class="chatlog__markdown chatlog__markdown-preserve">lance/rust/.cargo/config.toml at main &#183; lancedb/lance</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Modern columnar data format for ML and LLMs implemented in Rust. Convert from parquet in 2 lines of code for 100x faster random access, vector index, and data versioning. Compatible with Pandas, Du...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/gK2ZNRAqR7dWjy9GLnXVQrND_-EokXZAcfXcNm6NEN4/https/opengraph.githubassets.com/2c45beaf439c2e6c48febf373486942666c5b25c9c54a2716fd1b05c43c46ab9/lancedb/lance> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/gK2ZNRAqR7dWjy9GLnXVQrND_-EokXZAcfXcNm6NEN4/https/opengraph.githubassets.com/2c45beaf439c2e6c48febf373486942666c5b25c9c54a2716fd1b05c43c46ab9/lancedb/lance alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1199413482056069231 class=chatlog__message-container data-message-id=1199413482056069231><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Tuesday, January 23, 2024 6:00â€¯PM"><a href=#chatlog__message-container-1199413482056069231>1/23/2024 6:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="evgenys91">@Eugene Sorokin</span> you can probably build from source and change the flags for older CPUs.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200499371993739304 class=chatlog__message-container data-message-id=1200499371993739304><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 5:55â€¯PM"><a href=#chatlog__message-container-1200499371993739304>1/26/2024 5:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Roughly how fast should I expect deletes to be? I am currently seeing them take about 30x more time than appends. 

My code looks like:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight"># ~20MB parquet file
table = pd.read_parquet(fn_incoming)
ids = &#39;,&#39;.join(table[&#39;id&#39;].values.to_list())
# dataset is remote. total size is a few million rows and has ~20 files in the data directory.
ds = lance.dataset(uri_on_gcs)
# delete a batch of ~500k rows takes ~4min
ds.delete(&#39;id IN ({ids})&#39;)
# appending rows takes ~10 seconds 
lance.write_dataset(table, uri_on_gcs, mode=&quot;append&quot;)</code>

I thought the way deletes work is that rows are marked for deletion, and not actually deleted until compaction. So i would&#39;ve though deletes are roughly as fast as appending?</span></div></div></div></div><div id=chatlog__message-container-1200499989370109952 class=chatlog__message-container data-message-id=1200499989370109952><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, January 26, 2024 5:58â€¯PM">5:58â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Second bug: I also compact every once in a while. I get this 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight"> 
&gt;       return Compaction.execute(self._dataset, opts)
E       OSError: LanceError(IO): Execution error: Row ids did not arrive in sorted order: integers are ordered up to the 0th element, /rustc/82e1608dfa6e0b5569232559e3d385fea5a93112/library/core/src/convert/mod.rs:757:9</code>

when running 
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ds = lance.dataset(uri_on_gcs)
ds.optimize.compact_files()</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200500238566293624 class=chatlog__message-container data-message-id=1200500238566293624><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 5:59â€¯PM"><a href=#chatlog__message-container-1200500238566293624>1/26/2024 5:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Deletion needs to read the data and apply filters. Append dost not touch existing data, just write new data and update manifest.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200500465348120636 class=chatlog__message-container data-message-id=1200500465348120636><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1200500238566293624')"> Deletion needs to read the data and apply filters. Append dost not touch existing data, just write new data and update manifest. </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:00â€¯PM"><a href=#chatlog__message-container-1200500465348120636>1/26/2024 6:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Does that mean I should see lots of network activity when deleting?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200500476676939877 class=chatlog__message-container data-message-id=1200500476676939877><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:00â€¯PM"><a href=#chatlog__message-container-1200500476676939877>1/26/2024 6:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>do you do deletion often? there are some optimizations we can do, i.e, do not materialize deletion, but it needs to pay the cost during read then</span></div></div></div></div><div id=chatlog__message-container-1200500576451051631 class=chatlog__message-container data-message-id=1200500576451051631><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, January 26, 2024 6:00â€¯PM">6:00â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yea in your example, you should see a full scan of &quot;id&quot; column</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200500582251757618 class=chatlog__message-container data-message-id=1200500582251757618><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1200500476676939877')"> do you do deletion often? there are some optimizations we can do, i.e, do not materialize deletion, but it needs to pay the cost during read then </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:00â€¯PM"><a href=#chatlog__message-container-1200500582251757618>1/26/2024 6:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I am doing a poor man&#39;s upsert, so yeah, its pretty frequent</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200500635053854841 class=chatlog__message-container data-message-id=1200500635053854841><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:00â€¯PM"><a href=#chatlog__message-container-1200500635053854841>1/26/2024 6:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Oh our upsert API is almost there</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=partying_face><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ¥³ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f973.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div><div id=chatlog__message-container-1200500725554348072 class=chatlog__message-container data-message-id=1200500725554348072><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, January 26, 2024 6:01â€¯PM">6:01â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>finally the upstream datafusion released the fix we needed</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200500778704572577 class=chatlog__message-container data-message-id=1200500778704572577><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:01â€¯PM"><a href=#chatlog__message-container-1200500778704572577>1/26/2024 6:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>do you have a scalar index on the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ids</code> column?</span></div></div></div></div><div id=chatlog__message-container-1200500869226037258 class=chatlog__message-container data-message-id=1200500869226037258><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, January 26, 2024 6:01â€¯PM">6:01â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>that might be a temporary solution to make deletions go faster til Upsert is officially supported?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200501008174956594 class=chatlog__message-container data-message-id=1200501008174956594><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=lei.xu>lei</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1200500635053854841')"> Oh our upsert API is almost there </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:02â€¯PM"><a href=#chatlog__message-container-1200501008174956594>1/26/2024 6:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;ve been watching this closely!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200501116870328370 class=chatlog__message-container data-message-id=1200501116870328370><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1200500778704572577')"> do you have a scalar index on the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ids</code> column? </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:02â€¯PM"><a href=#chatlog__message-container-1200501116870328370>1/26/2024 6:02â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh my gosh no! let me try that. sounds obvious now</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200508381006401706 class=chatlog__message-container data-message-id=1200508381006401706><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:31â€¯PM"><a href=#chatlog__message-container-1200508381006401706>1/26/2024 6:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>OK, adding an index made deletes go much faster as predicted. Thanks <span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span> and <span class="chatlog__markdown-mention" title="lei.xu">@lei</span> !</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=fire><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ”¥ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f525.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200508578755260566 class=chatlog__message-container data-message-id=1200508578755260566><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, January 26, 2024 6:32â€¯PM"><a href=#chatlog__message-container-1200508578755260566>1/26/2024 6:32â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>awesome</span></div></div></div></div><div id=chatlog__message-container-1200508692215369769 class=chatlog__message-container data-message-id=1200508692215369769><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Friday, January 26, 2024 6:32â€¯PM">6:32â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>would love to get your feedback on the upsert api when it&#39;s released next week</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200934813062926456 class=chatlog__message-container data-message-id=1200934813062926456><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1200508692215369769')"> would love to get your feedback on the upsert api when it&#39;s released next week </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, January 27, 2024 10:46â€¯PM"><a href=#chatlog__message-container-1200934813062926456>1/27/2024 10:46â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i&#39;ll be happy to check it ou!</span></div></div></div></div><div id=chatlog__message-container-1200935594180747265 class=chatlog__message-container data-message-id=1200935594180747265><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, January 27, 2024 10:49â€¯PM">10:49â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>re: inserts. i just realized that neither scalar nor vector indexes are automatically updated after inserts (right?). is there a way to update the indices, or is recomputing them the only option?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200937900733374684 class=chatlog__message-container data-message-id=1200937900733374684><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=chrisemoody>chrisemoody</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1200935594180747265')"> re: inserts. i just realized that neither scalar nor vector indexes are automatically updated after inserts (right?). is there a way to update the indices, or is recomputing them the only option? </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, January 27, 2024 10:58â€¯PM"><a href=#chatlog__message-container-1200937900733374684>1/27/2024 10:58â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh is this what <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ds.optimize.optimize_indices()</code> does?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200938610598363176 class=chatlog__message-container data-message-id=1200938610598363176><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, January 27, 2024 11:01â€¯PM"><a href=#chatlog__message-container-1200938610598363176>1/27/2024 11:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>yeah, that should update both vector and scalar indices. But if you just add a small number of rows, searches should still work fine without optimize_indices</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1200942682390937730 class=chatlog__message-container data-message-id=1200942682390937730><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Saturday, January 27, 2024 11:17â€¯PM"><a href=#chatlog__message-container-1200942682390937730>1/27/2024 11:17â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;ve got what looks like a pretty slow query that should be really fast. the table is big -- 500M entries. there&#39;s a scalar index on one column, and i&#39;m doing a filter like <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">gumtap_id = {random.randint(0, 500_000_000)}</code>. the index is up to date, with no unindexed rows. the dataset is on a local drive. so i was expecting to see ~100ms lookup times, but i&#39;m getting ~2200ms. is there anything i can do?</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1200942682051190887/image.png?ex=698a6b07&amp;is=69891987&amp;hm=23caacd93d92a69da8fc50e16e4a95d7958e0e663cefd558e8898a9a5f4515f0&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1200942682051190887/image.png?ex=698a6b07&amp;is=69891987&amp;hm=23caacd93d92a69da8fc50e16e4a95d7958e0e663cefd558e8898a9a5f4515f0&amp;" alt="Image attachment" title="Image: image.png (118.2 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1202004283453870191 class=chatlog__message-container data-message-id=1202004283453870191><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Tuesday, January 30, 2024 9:35â€¯PM"><a href=#chatlog__message-container-1202004283453870191>1/30/2024 9:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m creating an IVF index (32768 partitions, pq=192) and getting an OoM error pretty quickly while training an index -- on a machine with 882G of ram + 256G of swap and 224 cores. cpu only, no gpu. unfortunately, I think this is the biggest machine i can find on GCP. The table is ~92M rows and approximately ~1.2TB in size and includes non-vector columns</span> <span class=chatlog__edited-timestamp title="Tuesday, January 30, 2024 9:43â€¯PM">(edited)</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1202004283193557002/image.png?ex=698a5339&amp;is=698901b9&amp;hm=7cd0cf174c71bbb46ae0fd412bc54fef3c5fa64228d565cc200149e5b18569a4&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1202004283193557002/image.png?ex=698a5339&amp;is=698901b9&amp;hm=7cd0cf174c71bbb46ae0fd412bc54fef3c5fa64228d565cc200149e5b18569a4&amp;" alt="Image attachment" title="Image: image.png (786.12 KB)" loading=lazy> </a></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1202004283604607006/image.png?ex=698a5339&amp;is=698901b9&amp;hm=02bc769e548a528638f305111781fcafd76e7128c28178978892efdcbcce70bf&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1202004283604607006/image.png?ex=698a5339&amp;is=698901b9&amp;hm=02bc769e548a528638f305111781fcafd76e7128c28178978892efdcbcce70bf&amp;" alt="Image attachment" title="Image: image.png (78.8 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1202024246579302475 class=chatlog__message-container data-message-id=1202024246579302475><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, January 30, 2024 10:55â€¯PM"> <a href=#chatlog__message-container-1202024246579302475>1/30/2024 10:55â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1202047845449089034 class=chatlog__message-container data-message-id=1202047845449089034><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Wednesday, January 31, 2024 12:28â€¯AM"><a href=#chatlog__message-container-1202047845449089034>1/31/2024 12:28â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>btw <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> the new release includes the new upsert functionality that <span class="chatlog__markdown-mention" title="wpace">@WestonPace</span> added. I remember you saying before that it was something you had been looking for. Let us know if you get a chance to try it out</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1202057446328381481 class=chatlog__message-container data-message-id=1202057446328381481><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/801879136569524304/a8afcc49442ea2bf1dcb6482b7bdb033.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1202047845449089034')"> btw <span class="chatlog__markdown-mention" title="chrisemoody">@chrisemoody</span> the new release includes the new upsert functionality that <span class="chatlog__markdown-mention" title="wpace">@WestonPace</span> added. I remember you saying before that it was something you had been looking for. Let us know if you get a chance to try it out </span></div></div><div class=chatlog__header><span class=chatlog__author title=chrisemoody data-user-id=801879136569524304>chrisemoody</span> <span class=chatlog__timestamp title="Wednesday, January 31, 2024 1:07â€¯AM"><a href=#chatlog__message-container-1202057446328381481>1/31/2024 1:07â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;ll be trying this immediately! where are the docs?</span></div></div></div></div><div id=chatlog__message-container-1202057543653015652 class=chatlog__message-container data-message-id=1202057543653015652><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, January 31, 2024 1:07â€¯AM">1:07â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>i searched for upsert  / merge and couldn&#39;t quite see what i was looking for</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1202087467063451658 class=chatlog__message-container data-message-id=1202087467063451658><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=mtdonato data-user-id=912791911796990002>mtdonato</span> <span class=chatlog__timestamp title="Wednesday, January 31, 2024 3:06â€¯AM"><a href=#chatlog__message-container-1202087467063451658>1/31/2024 3:06â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Any idea why this is? 

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Io error: Internal error: Unexpected result from predicate evaluation: Scalar(Boolean(NULL)).
This was likely caused by a bug in DataFusion&#39;s code and we would welcome that you file an bug report in our issue tracker</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1202096187189243958 class=chatlog__message-container data-message-id=1202096187189243958><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, January 31, 2024 3:41â€¯AM"> <a href=#chatlog__message-container-1202096187189243958>1/31/2024 3:41â€¯AM</a> </span></div></div></div><div id=chatlog__message-container-1202096274846011396 class=chatlog__message-container data-message-id=1202096274846011396><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, January 31, 2024 3:41â€¯AM"> <a href=#chatlog__message-container-1202096274846011396>1/31/2024 3:41â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1203077085812490271 class=chatlog__message-container data-message-id=1203077085812490271><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kohlerbear3381 data-user-id=450637514668113921>kohlerbear</span> <span class=chatlog__timestamp title="Friday, February 2, 2024 8:38â€¯PM"><a href=#chatlog__message-container-1203077085812490271>2/2/2024 8:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hi there! I ran into the following error attempting to create an index on my lance dataset:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">OSError: Encountered internal error. Please file a bug report at https://github.com/lancedb/lance/issues. File 02-01-clip-embeddings-5k.lance/data/926f1f30-bbec-4c9c-b013-aa407657b0ec.lance not found in fragment Fragment { id: 4744, files: [DataFile { path: &quot;b8f811a6-88b4-478c-9502-aa7d4de67bd0.lance&quot;, fields: [0, 1, 2, 3, 4, 5, 6, 7] }], deletion_file: None, physical_rows: Some(1048576) }, /app/lance/rust/lance-core/src/io/reader.rs:271:43</code>
From what I can see, that file does exist:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">âž¡ aws s3 ls s3://lance-datasets/02-01-clip-embeddings-5k.lance/data/926f1f30-bbec-4c9c-b013-aa407657b0ec.lance
2024-02-02 02:03:52 2488729092 926f1f30-bbec-4c9c-b013-aa407657b0ec.lance</code>
The other file mentioned within the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">DataFile</code> path also exists:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">âž¡ aws s3 ls s3://lance-datasets/02-01-clip-embeddings-5k.lance/data/b8f811a6-88b4-478c-9502-aa7d4de67bd0.lance
2024-02-02 02:03:52 2488188678 b8f811a6-88b4-478c-9502-aa7d4de67bd0.lance</code>


Any thoughts on what might be going wrong here or thoughts on how I could debug this further? I don&#39;t think I&#39;ve really done anything out of the ordinary. I have called <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cleanup_old_versions</code>, but I think that&#39;s about it.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1203801698318024714 class=chatlog__message-container data-message-id=1203801698318024714><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1040448339088519168/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=garnizzle data-user-id=1040448339088519168>garnizzle</span> <span class=chatlog__timestamp title="Sunday, February 4, 2024 8:38â€¯PM"><a href=#chatlog__message-container-1203801698318024714>2/4/2024 8:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey I think there is a bug with the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">create_fts_index</code> method on the table object. It is saving this index locally on my mac instead of in s3. My s3 bucket path is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&quot;s3://vf-frontify-embeddings/&quot;</code> and this works fine for creation and searching of tables normally but this line, <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">fs, path = fs_from_uri(self._get_fts_index_path())</code> in table.py is spitting out the wrong path - in this case <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&#39;vf-frontify-embeddings/assets.lance/_indices/tantivy&#39;</code> which saves the full text index in my mac.

If this is not a bug, can someone please tell me how to configure the table or connection so that this does not happen?</span> <span class=chatlog__edited-timestamp title="Sunday, February 4, 2024 8:38â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1203808911950348308 class=chatlog__message-container data-message-id=1203808911950348308><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1040448339088519168/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=garnizzle>garnizzle</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1203801698318024714')"> Hey I think there is a bug with the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">create_fts_index</code> method on the table object. It is saving this index locally on my mac instead of in s3. My s3 bucket path is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&quot;s3://vf-frontify-embeddings/&quot;</code> and this works fine for creation and searching of tables normally but this line, <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">fs, path = fs_from_uri(self._get_fts_index_path())</code> in table.py is spitting out the wrong path - in this case <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&#39;vf-frontify-embeddings/assets.lance/_indices/tantivy&#39;</code> which saves the full text index in my mac.

If this is not a bug, can someone please tell me how to configure the table or connection so that this does not happen? </span> <span class=chatlog__reply-edited-timestamp title="Sunday, February 4, 2024 8:38â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Sunday, February 4, 2024 9:06â€¯PM"><a href=#chatlog__message-container-1203808911950348308>2/4/2024 9:06â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hey yeah we use Tantivy for fts and it does not currently support object storage. We have a separate extension for tantivy (<a href="https://github.com/lancedb/tantivy-object-store)">https://github.com/lancedb/tantivy-object-store)</a> but it&#39;s not merged in. There&#39;s an outstanding issue in <a href="https://github.com/quickwit-oss/tantivy-py/issues/194">https://github.com/quickwit-oss/tantivy-py/issues/194</a> . If you want to chime in also maybe we&#39;ll get some more movement</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/tantivy-object-store><div class="chatlog__markdown chatlog__markdown-preserve">GitHub - lancedb/tantivy-object-store: Tantivy directory implementa...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Tantivy directory implementation backed by object_store - GitHub - lancedb/tantivy-object-store: Tantivy directory implementation backed by object_store</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/lzHw70GEhYCIfmEI43EGwRa-oHhtBPYgR12IILBh46M/https/opengraph.githubassets.com/548b1f41e24865849e14b90bcccaab660ef730057bb35b783ab1a9454211f9a4/lancedb/tantivy-object-store> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/lzHw70GEhYCIfmEI43EGwRa-oHhtBPYgR12IILBh46M/https/opengraph.githubassets.com/548b1f41e24865849e14b90bcccaab660ef730057bb35b783ab1a9454211f9a4/lancedb/tantivy-object-store alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/quickwit-oss/tantivy-py/issues/194><div class="chatlog__markdown chatlog__markdown-preserve">[feature request] Expose means of configuring/providing a custom Ob...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Hi there, I&#39;m a user of lancedb, which leverages tantivy-py for full text search indices (see <a href="https://lancedb.github.io/lancedb/fts)">https://lancedb.github.io/lancedb/fts)</a>. A current shortcoming of the lancedb FTS support is that it...</div></div></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1203809272279072884 class=chatlog__message-container data-message-id=1203809272279072884><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1040448339088519168/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=garnizzle data-user-id=1040448339088519168>garnizzle</span> <span class=chatlog__timestamp title="Sunday, February 4, 2024 9:08â€¯PM"><a href=#chatlog__message-container-1203809272279072884>2/4/2024 9:08â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>just commented, thanks for linking the issue!</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div><div id=chatlog__message-container-1203809778556473344 class=chatlog__message-container data-message-id=1203809778556473344><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Sunday, February 4, 2024 9:10â€¯PM">9:10â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>is the issue that the full-text search cannot be done against objects well actually in storage? maybe a work around is to still put them there then load some portion into memory for searching?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1203812756776681483 class=chatlog__message-container data-message-id=1203812756776681483><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Sunday, February 4, 2024 9:22â€¯PM"><a href=#chatlog__message-container-1203812756776681483>2/4/2024 9:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>that&#39;s possible but it makes writes a lot more complicated then since you have to manage the write-through and potential can end up in some bad situations if you have to manually manage the copying of the index back and forth</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1203893791485067294 class=chatlog__message-container data-message-id=1203893791485067294><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1040448339088519168/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=garnizzle data-user-id=1040448339088519168>garnizzle</span> <span class=chatlog__timestamp title="Monday, February 5, 2024 2:44â€¯AM"><a href=#chatlog__message-container-1203893791485067294>2/5/2024 2:44â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>thats true. For now just creating a demo, so I can keep everything on an ec2 and add more storage to the file system. but don&#39;t want to do that if I end up putting something in prod</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1203906970394824744 class=chatlog__message-container data-message-id=1203906970394824744><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, February 5, 2024 3:36â€¯AM"><a href=#chatlog__message-container-1203906970394824744>2/5/2024 3:36â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>our plan is that we&#39;re going to integrate tantivy at the rust level so we can bring the object store plugin into that ourselves and not have to depend on that getting merged into tantivy</span></div></div></div></div><div id=chatlog__message-container-1203907039529799740 class=chatlog__message-container data-message-id=1203907039529799740><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, February 5, 2024 3:36â€¯AM">3:36â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>it&#39;ll just take a couple of weeks as it&#39;s a substantial refactor</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1204217524476977202 class=chatlog__message-container data-message-id=1204217524476977202><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1040448339088519168/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=garnizzle data-user-id=1040448339088519168>garnizzle</span> <span class=chatlog__timestamp title="Tuesday, February 6, 2024 12:10â€¯AM"><a href=#chatlog__message-container-1204217524476977202>2/6/2024 12:10â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>makes sense!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1204244348489826335 class=chatlog__message-container data-message-id=1204244348489826335><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1040448339088519168/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=garnizzle data-user-id=1040448339088519168>garnizzle</span> <span class=chatlog__timestamp title="Tuesday, February 6, 2024 1:57â€¯AM"><a href=#chatlog__message-container-1204244348489826335>2/6/2024 1:57â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey guys, I noticed if I try to do something like this <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.search((query_vector, term), query_type=&quot;hybrid&quot;).limit(3).to_list()</code> with the hybrid search index it returns 6 items instead of 3. I&#39;m guessing thats because its 3 for each index? was this intentional?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1204247554754216068 class=chatlog__message-container data-message-id=1204247554754216068><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1040448339088519168/5445ffd7ffb201a98393cbdf684ea4b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=garnizzle data-user-id=1040448339088519168>garnizzle</span> <span class=chatlog__timestamp title="Tuesday, February 6, 2024 2:09â€¯AM"><a href=#chatlog__message-container-1204247554754216068>2/6/2024 2:09â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>also noticed the results are way better if I add <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.metric(&quot;cosine&quot;)</code> - any idea why that might be?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1204247790386155530 class=chatlog__message-container data-message-id=1204247790386155530><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Tuesday, February 6, 2024 2:10â€¯AM"><a href=#chatlog__message-container-1204247790386155530>2/6/2024 2:10â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="ayushexel">@AyushC</span> ^</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1204248120200929357 class=chatlog__message-container data-message-id=1204248120200929357><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, February 6, 2024 2:12â€¯AM"> <a href=#chatlog__message-container-1204248120200929357>2/6/2024 2:12â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1211805200445214821 class=chatlog__message-container data-message-id=1211805200445214821><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/550656390679494657/492c95bfd1ad14bf1c9f2eb6edb1109d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gabriel_syme data-user-id=550656390679494657>ð“…¬ gabriel_syme ð“…¬</span> <span class=chatlog__timestamp title="Monday, February 26, 2024 10:41â€¯PM"><a href=#chatlog__message-container-1211805200445214821>2/26/2024 10:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>quick question, is this supposed to be <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lru_cache</code>?
from: <a href="https://lancedb.github.io/lancedb/embeddings/custom_embedding_function/#textembeddingfunction-interface">https://lancedb.github.io/lancedb/embeddings/custom_embedding_function/#textembeddingfunction-interface</a></span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1211805200575369257/image.png?ex=698a628a&amp;is=6989110a&amp;hm=997c2247e0d221f72d524ae84729f1f3a51e5ad4fe3806b61300827dd50026cf&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1211805200575369257/image.png?ex=698a628a&amp;is=6989110a&amp;hm=997c2247e0d221f72d524ae84729f1f3a51e5ad4fe3806b61300827dd50026cf&amp;" alt="Image attachment" title="Image: image.png (15.7 KB)" loading=lazy> </a></div><div class=chatlog__embed><div class="chatlog__embed-color-pill chatlog__embed-color-pill--default"></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href="https://lancedb.github.io/lancedb/embeddings/custom_embedding_function/"><div class="chatlog__markdown chatlog__markdown-preserve">User-defined embedding functions</div></a></div></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1211812726972743680 class=chatlog__message-container data-message-id=1211812726972743680><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, February 26, 2024 11:11â€¯PM"><a href=#chatlog__message-container-1211812726972743680>2/26/2024 11:11â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Well for a given instance of the embedding function, youâ€™ll ever only have one cached model. You could potentially create some sort of global lru cache across all functions, but typically youâ€™re not working with a lot of them all in the same process</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1211815459251294288 class=chatlog__message-container data-message-id=1211815459251294288><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/550656390679494657/492c95bfd1ad14bf1c9f2eb6edb1109d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=changkhiskhan>changhiskhan</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1211812726972743680')"> Well for a given instance of the embedding function, youâ€™ll ever only have one cached model. You could potentially create some sort of global lru cache across all functions, but typically youâ€™re not working with a lot of them all in the same process </span></div></div><div class=chatlog__header><span class=chatlog__author title=gabriel_syme data-user-id=550656390679494657>ð“…¬ gabriel_syme ð“…¬</span> <span class=chatlog__timestamp title="Monday, February 26, 2024 11:21â€¯PM"><a href=#chatlog__message-container-1211815459251294288>2/26/2024 11:21â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh ok, any idea where the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">cached</code> is coming from? <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™‚"
    title="slight_smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f642.svg"> not in the docs and can&#39;t find it in the repo either</span></div></div></div></div><div id=chatlog__message-container-1211815711714844692 class=chatlog__message-container data-message-id=1211815711714844692><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, February 26, 2024 11:23â€¯PM">11:23â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>(apologies if I missed it smh!)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1211816315715588127 class=chatlog__message-container data-message-id=1211816315715588127><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Monday, February 26, 2024 11:25â€¯PM"><a href=#chatlog__message-container-1211816315715588127>2/26/2024 11:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>oh, sorry, i was totally looking at the wrong thing</span></div></div></div></div><div id=chatlog__message-container-1211816429440073819 class=chatlog__message-container data-message-id=1211816429440073819><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, February 26, 2024 11:25â€¯PM">11:25â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lancedb/blob/main/python/lancedb/embeddings/sentence_transformers.py#L70">https://github.com/lancedb/lancedb/blob/main/python/lancedb/embeddings/sentence_transformers.py#L70</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/blob/main/python/lancedb/embeddings/sentence_transformers.py><div class="chatlog__markdown chatlog__markdown-preserve">lancedb/python/lancedb/embeddings/sentence_transformers.py at main ...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Developer-friendly, serverless vector database for AI applications. Easily add long-term memory to your LLM apps! - lancedb/lancedb</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/tMkdC6jZ8pi25m7aZQPBevJebL9eClmp3iYOtjRukxc/https/opengraph.githubassets.com/73269b50d99bec7162b39527929fce279d66ddac2ffa07f4853c033e9ae87e24/lancedb/lancedb> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/tMkdC6jZ8pi25m7aZQPBevJebL9eClmp3iYOtjRukxc/https/opengraph.githubassets.com/73269b50d99bec7162b39527929fce279d66ddac2ffa07f4853c033e9ae87e24/lancedb/lancedb alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1211816473199251506 class=chatlog__message-container data-message-id=1211816473199251506><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, February 26, 2024 11:26â€¯PM">11:26â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>the docs need to be updated</span></div></div></div></div><div id=chatlog__message-container-1211816509605941258 class=chatlog__message-container data-message-id=1211816509605941258><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, February 26, 2024 11:26â€¯PM">11:26â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>but ^ is the actual code</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1211816540760965181 class=chatlog__message-container data-message-id=1211816540760965181><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/550656390679494657/492c95bfd1ad14bf1c9f2eb6edb1109d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gabriel_syme data-user-id=550656390679494657>ð“…¬ gabriel_syme ð“…¬</span> <span class=chatlog__timestamp title="Monday, February 26, 2024 11:26â€¯PM"><a href=#chatlog__message-container-1211816540760965181>2/26/2024 11:26â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>awesome thanks!</span></div></div></div></div><div id=chatlog__message-container-1211816563854934036 class=chatlog__message-container data-message-id=1211816563854934036><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, February 26, 2024 11:26â€¯PM">11:26â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>should have looked better tbh</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1212221938227744808 class=chatlog__message-container data-message-id=1212221938227744808><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/550656390679494657/492c95bfd1ad14bf1c9f2eb6edb1109d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gabriel_syme data-user-id=550656390679494657>ð“…¬ gabriel_syme ð“…¬</span> <span class=chatlog__timestamp title="Wednesday, February 28, 2024 2:17â€¯AM"><a href=#chatlog__message-container-1212221938227744808>2/28/2024 2:17â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello, is it possible that the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">num_partitions</code> value is hardcoded smh in the calculation of the vector index?

I keep getting an error asking for the value to be less than 256 even though I have put a value less than the mumber of centroids in the function call.</span></div></div></div></div><div id=chatlog__message-container-1212222359512154172 class=chatlog__message-container data-message-id=1212222359512154172><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, February 28, 2024 2:18â€¯AM">2:18â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Error trace is:
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">LanceError(Index): KMeans: can not train 256 centroid with 70 vectors, choose a smaller K (&lt; 70) instead</code>

I assume that is the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">num_partitions</code> value?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1212261681623736351 class=chatlog__message-container data-message-id=1212261681623736351><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1001739727197700146/5cd18d5cd712e8e0248f6bd4a2f04b4f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span class=chatlog__timestamp title="Wednesday, February 28, 2024 4:55â€¯AM"><a href=#chatlog__message-container-1212261681623736351>2/28/2024 4:55â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this is most likely for training PQ , each PQ = 8 bits = 2^8 centroids</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1212293853923643392 class=chatlog__message-container data-message-id=1212293853923643392><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/550656390679494657/492c95bfd1ad14bf1c9f2eb6edb1109d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gabriel_syme data-user-id=550656390679494657>ð“…¬ gabriel_syme ð“…¬</span> <span class=chatlog__timestamp title="Wednesday, February 28, 2024 7:02â€¯AM"><a href=#chatlog__message-container-1212293853923643392>2/28/2024 7:02â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Aha makes sense, I definitely don&#39;t need an index for something that small</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1212506397598814288 class=chatlog__message-container data-message-id=1212506397598814288><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/550656390679494657/492c95bfd1ad14bf1c9f2eb6edb1109d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gabriel_syme data-user-id=550656390679494657>ð“…¬ gabriel_syme ð“…¬</span> <span class=chatlog__timestamp title="Wednesday, February 28, 2024 9:07â€¯PM"><a href=#chatlog__message-container-1212506397598814288>2/28/2024 9:07â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>any idea what this issue might be?</span></div></div></div></div><div id=chatlog__message-container-1212506400908124250 class=chatlog__message-container data-message-id=1212506400908124250><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, February 28, 2024 9:07â€¯PM">9:07â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lancedb/issues/1020">https://github.com/lancedb/lancedb/issues/1020</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/1020><div class="chatlog__markdown chatlog__markdown-preserve">bug(python): Hybrid search with filters is broken   &#183; Issue #1020 &#183;...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LanceDB version 0.5.7 What happened? Hybrid search with filters is broken. If we have filters in hybrid search it produces error. ... QueryBuilder.to_arrow(self) 608 if self._with_row_id: 609 # Nee...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/3UyRajb9a6ekiVc2Y2ff3Y-wf4PIL15Io-eNK4_FND0/https/opengraph.githubassets.com/9514167f05c003bf579a184ff8deb17c219d4d7529b6c7066e0b925d9a2ae69b/lancedb/lancedb/issues/1020> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/3UyRajb9a6ekiVc2Y2ff3Y-wf4PIL15Io-eNK4_FND0/https/opengraph.githubassets.com/9514167f05c003bf579a184ff8deb17c219d4d7529b6c7066e0b925d9a2ae69b/lancedb/lancedb/issues/1020 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1212506563877798008 class=chatlog__message-container data-message-id=1212506563877798008><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, February 28, 2024 9:08â€¯PM">9:08â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I could do filtering in a hybrid search a week ago I think, I don&#39;t believe I changed my code towards that (followed your advice of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">(vector, fts_query)</code></span></div></div></div></div><div id=chatlog__message-container-1212506639953956914 class=chatlog__message-container data-message-id=1212506639953956914><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, February 28, 2024 9:08â€¯PM">9:08â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>when I remove the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.where()</code> attribute it works</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1212519252771213437 class=chatlog__message-container data-message-id=1212519252771213437><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=ayushexel data-user-id=1032079688887189556>AyushC</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, February 28, 2024 9:58â€¯PM"> <a href=#chatlog__message-container-1212519252771213437>2/28/2024 9:58â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1215709868372000808 class=chatlog__message-container data-message-id=1215709868372000808><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/874024849549443083/82ae4877b6329b4d8ab2440a270e9278.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=jmeks data-user-id=874024849549443083>JMEKS</span> <span class=chatlog__timestamp title="Friday, March 8, 2024 5:16â€¯PM"><a href=#chatlog__message-container-1215709868372000808>3/8/2024 5:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey the github docs are throwing 404 errors when navigating using the top menu bar. Might cause some issues when indexing the docs using Cursor</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1217216952167170181 class=chatlog__message-container data-message-id=1217216952167170181><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, March 12, 2024 9:05â€¯PM"> <a href=#chatlog__message-container-1217216952167170181>3/12/2024 9:05â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1225403417028202536 class=chatlog__message-container data-message-id=1225403417028202536><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=nikkogg123 data-user-id=1225399829698445365>nikkogg123</span> <span class=chatlog__timestamp title="Thursday, April 4, 2024 11:15â€¯AM"><a href=#chatlog__message-container-1225403417028202536>4/4/2024 11:15â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hey there! we are using Lance for vector search (Python SDK) and noticed unexplainable performance degradation when using upsert. We are just wondering whether this is a bug, or an implementation mistake on our end <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™"
    title="pray"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg"><img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ»"
    title="ðŸ»"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f3fb.svg"> 

We are inserting our data points with:

lance_table.merge_insert(
            &quot;composite_id&quot;
        ).when_matched_update_all().when_not_matched_insert_all().when_not_matched_by_source_delete(
            f&#39;primary_id = &quot;{primary_id}&quot;&#39;
        ).execute(
            pa.Table.from_pylist(data)
        )

The data we are trying to insert is a list of Python objects:

               [{
                    &quot;embeddings&quot;: List[float],
                    &quot;company_id&quot;: str,
                    &quot;portfolio_id&quot;: str,
                    &quot;primary_id&quot;: str,
                    &quot;composite_id&quot;: str,
                    &quot;text&quot;: str,
                }]

After running the above query a few times, Lance&#39;s performance drops to 5-7 seconds (initially it is about 800ms). Our dataset is tiny (less than 1000 records) and the query we use to search the inserted records is rather simple:

lance_table.search(embedded_query)
            .where(f&quot;portfolio_id=123&quot;)
            .metric(&quot;cosine&quot;)
            .limit(5)

anyone has experienced this before?</span> <span class=chatlog__edited-timestamp title="Thursday, April 4, 2024 11:17â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1226622444027121734 class=chatlog__message-container data-message-id=1226622444027121734><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/766305750125379594/5d65ee52e112ceb9653fdf289113dc76.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=hankelbao. data-user-id=766305750125379594>HankelBao</span> <span class=chatlog__timestamp title="Sunday, April 7, 2024 7:59â€¯PM"><a href=#chatlog__message-container-1226622444027121734>4/7/2024 7:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hey mates - I&#39;m wondering what&#39;s the best practice for concurrent writes to the same table in Lancedb? We tried to do batch upsert concurrenctly and as it continues the error rate will go to 100%. All the error looks like the following screenshot.

For reference:
<ul><li>We are trying to index 30M+ records in the table</li><li>The batch size is currently 256 and we allow up to 100 concurrent calls</li><li>The whole dataset is around 500G with the fields</li></ul></span> <span class=chatlog__edited-timestamp title="Sunday, April 7, 2024 8:02â€¯PM">(edited)</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1226622443880316928/image.png?ex=698a3cac&amp;is=6988eb2c&amp;hm=164118dfe248867c60a02b0127848c339e91d9edddafed72e32329008c5eaef8&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1226622443880316928/image.png?ex=698a3cac&amp;is=6988eb2c&amp;hm=164118dfe248867c60a02b0127848c339e91d9edddafed72e32329008c5eaef8&amp;" alt="Image attachment" title="Image: image.png (14.93 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1226648723023724549 class=chatlog__message-container data-message-id=1226648723023724549><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Sunday, April 7, 2024 9:44â€¯PM"> <a href=#chatlog__message-container-1226648723023724549>4/7/2024 9:44â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1227714991445114895 class=chatlog__message-container data-message-id=1227714991445114895><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=rm_rf_wfh data-user-id=1145707974929682464>John</span> <span class=chatlog__timestamp title="Wednesday, April 10, 2024 8:21â€¯PM"><a href=#chatlog__message-container-1227714991445114895>4/10/2024 8:21â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/duckdb/duckdb/issues/11608">https://github.com/duckdb/duckdb/issues/11608</a>

Cross posting this here in-case it is in any way related to LanceDB.

TLDR: <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">DuckDB</code> chokes on a LanceDB table has timestamps created from a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pd.DataFrame</code>, but has no issue with the same data when the LanceDB table is created from a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">List</code> of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Dict</code>s.</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=pray><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ™ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f64f.svg loading=lazy> <span class=chatlog__reaction-count>2</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1228020602967687228 class=chatlog__message-container data-message-id=1228020602967687228><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=aigeek_33554 data-user-id=1141819736137662494>aiGeek</span> <span class=chatlog__timestamp title="Thursday, April 11, 2024 4:35â€¯PM"><a href=#chatlog__message-container-1228020602967687228>4/11/2024 4:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>1) On <a href="https://lancedb.github.io/lancedb/">https://lancedb.github.io/lancedb/</a>
Expand LanceDB Cloud
Expand API reference
Click on JavaScript -&gt; 404
  <a href="https://lancedb.github.io/lancedb/javascript/saas-modules.md">https://lancedb.github.io/lancedb/javascript/saas-modules.md</a>

2) On <a href="https://lancedb.github.io/lancedb/python/saas-python/#lancedb.connect">https://lancedb.github.io/lancedb/python/saas-python/#lancedb.connect</a>
there is a typo
  Connect to LancdDB cloud:

It should be
 Connect to LanceDB cloud:

3) On <a href="https://blog.lancedb.com/multimodal-myntra-fashion-search-engine-using-lancedb/">https://blog.lancedb.com/multimodal-myntra-fashion-search-engine-using-lancedb/</a>
There is missing text below
  1. Register Clip EmbeddingTo store
  g the images in the form of a vector database,

4) On the integrations page at <a href="https://lancedb.github.io/lancedb/integrations/">https://lancedb.github.io/lancedb/integrations/</a>
  LangChain -&gt; 404</span></div><div class=chatlog__embed><div class="chatlog__embed-color-pill chatlog__embed-color-pill--default"></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href="https://blog.lancedb.com/multimodal-myntra-fashion-search-engine-using-lancedb/"><div class="chatlog__markdown chatlog__markdown-preserve">Multimodal Myntra Fashion Search Engine using LanceDB</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">In this comprehensive guide, we aim to explain the process of creating a multi-modal search app and break it down into manageable steps. The procedure involves several phases, including registering clip embeddings, setting up a data class and table, and executing a search query.

Using a vector database like LanceDB</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/GkJKBWGWCODMTBALlw4GVMbQev6hz83X6YdLEhL_kzk/%3Fcrop%3Dentropy%26cs%3Dtinysrgb%26fit%3Dmax%26fm%3Djpg%26ixid%3DM3wxMTc3M3wwfDF8c2VhcmNofDEzfHxmYXNoaW9ufGVufDB8fHx8MTcxMDkzODA5MHww%26ixlib%3Drb-4.0.3%26q%3D80%26w%3D2000content%2Fimages%2Fsize%2Fw1200/https/images.unsplash.com/photo-1557777586-f6682739fcf3> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/GkJKBWGWCODMTBALlw4GVMbQev6hz83X6YdLEhL_kzk/%3Fcrop%3Dentropy%26cs%3Dtinysrgb%26fit%3Dmax%26fm%3Djpg%26ixid%3DM3wxMTc3M3wwfDF8c2VhcmNofDEzfHxmYXNoaW9ufGVufDB8fHx8MTcxMDkzODA5MHww%26ixlib%3Drb-4.0.3%26q%3D80%26w%3D2000content%2Fimages%2Fsize%2Fw1200/https/images.unsplash.com/photo-1557777586-f6682739fcf3 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1228056298709454929 class=chatlog__message-container data-message-id=1228056298709454929><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1086036080106668234/aa6abaf2b7d787089eabacc7218ca3d6.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=mohan_tummala data-user-id=1086036080106668234>mohan_tummala</span> <span class=chatlog__timestamp title="Thursday, April 11, 2024 6:57â€¯PM"><a href=#chatlog__message-container-1228056298709454929>4/11/2024 6:57â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lancedb/issues/1216">https://github.com/lancedb/lancedb/issues/1216</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/1216><div class="chatlog__markdown chatlog__markdown-preserve">bug(python): search function is throwing error when querying lanced...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LanceDB version v0.6.6 What happened? i am getting this error when i am querying lancedb from a fastapi backend service thread &#39;lance-cpu&#39; panicked at /home/runner/work/lance/lance/rust/lan...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/vOzcqa85pFO550JoH08ef3U5go9fCyCHzJ7h4skZI-Q/https/opengraph.githubassets.com/d0d3c1a92047ede29962fcea89f3e4114f1b80b53fccf3982eebb5a80d35ae21/lancedb/lancedb/issues/1216> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/vOzcqa85pFO550JoH08ef3U5go9fCyCHzJ7h4skZI-Q/https/opengraph.githubassets.com/d0d3c1a92047ede29962fcea89f3e4114f1b80b53fccf3982eebb5a80d35ae21/lancedb/lancedb/issues/1216 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1228492285667315843 class=chatlog__message-container data-message-id=1228492285667315843><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=aigeek_33554 data-user-id=1141819736137662494>aiGeek</span> <span class=chatlog__timestamp title="Friday, April 12, 2024 11:49â€¯PM"><a href=#chatlog__message-container-1228492285667315843>4/12/2024 11:49â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>There is a doc typo on <a href="https://lancedb.github.io/lancedb/js/modules/#connect">https://lancedb.github.io/lancedb/js/modules/#connect</a>
Change &quot;Accpeted formats:&quot; to &quot;Accepted formats:&quot;</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1228690552225005609 class=chatlog__message-container data-message-id=1228690552225005609><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=aigeek_33554>aiGeek</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1228492285667315843')"> There is a doc typo on <a href="https://lancedb.github.io/lancedb/js/modules/#connect">https://lancedb.github.io/lancedb/js/modules/#connect</a>
Change &quot;Accpeted formats:&quot; to &quot;Accepted formats:&quot; </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Saturday, April 13, 2024 12:57â€¯PM"><a href=#chatlog__message-container-1228690552225005609>4/13/2024 12:57â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks! Want to submit a quick PR?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1230799989136031855 class=chatlog__message-container data-message-id=1230799989136031855><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/863364093670981643/d2ba859ad949a383c3601235f1bc0825.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=jiahuei_ data-user-id=863364093670981643>jiahuei_</span> <span class=chatlog__timestamp title="Friday, April 19, 2024 8:39â€¯AM"><a href=#chatlog__message-container-1230799989136031855>4/19/2024 8:39â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi everyone, sometimes after a row add,  row select operation will fail with an error <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">OSError: Io error: Execution error: LanceError(IO): No page info found for field:</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1230800313985011783 class=chatlog__message-container data-message-id=1230800313985011783><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/863364093670981643/d2ba859ad949a383c3601235f1bc0825.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/863364093670981643/d2ba859ad949a383c3601235f1bc0825.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=jiahuei_>jiahuei_</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1230799989136031855')"> Hi everyone, sometimes after a row add,  row select operation will fail with an error <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">OSError: Io error: Execution error: LanceError(IO): No page info found for field:</code> </span></div></div><div class=chatlog__header><span class=chatlog__author title=jiahuei_ data-user-id=863364093670981643>jiahuei_</span> <span class=chatlog__timestamp title="Friday, April 19, 2024 8:41â€¯AM"><a href=#chatlog__message-container-1230800313985011783>4/19/2024 8:41â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Here is the traceback

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">  File &quot;/home/jiahuei/github/JAM.ai.dev/services/orchestrators/src/owl/db/gen_table.py&quot;, line 572, in select
    rows = table._dataset.to_table(offset=offset, limit=limit).to_pylist()
           â”‚     â”‚                        â”‚             â”” 12
           â”‚     â”‚                        â”” 0
           â”‚     â”” &lt;property object at 0x7fa4244d8e00&gt;
           â”” LanceTable(connection=LanceDBConnection(/home/jiahuei/github/JAM.ai.dev/db/default/default/action), name=&quot;japan&quot;)

  File &quot;/home/jiahuei/micromamba/envs/jam310/lib/python3.10/site-packages/lance/dataset.py&quot;, line 425, in to_table
    ).to_table()
  File &quot;/home/jiahuei/micromamba/envs/jam310/lib/python3.10/site-packages/lance/dataset.py&quot;, line 2117, in to_table
    return self.to_reader().read_all()
           â”‚    â”” &lt;function LanceScanner.to_reader at 0x7fa4286551b0&gt;
           â”” &lt;lance.dataset.LanceScanner object at 0x7fa359891260&gt;
  File &quot;pyarrow/ipc.pxi&quot;, line 757, in pyarrow.lib.RecordBatchReader.read_all
    check_status(self.reader.get().ToTable().Value(&amp;table))
                                                    â”” &lt;cyfunction table at 0x7fa433934790&gt;
  File &quot;pyarrow/error.pxi&quot;, line 91, in pyarrow.lib.check_status
    raise convert_status(status)

OSError: Io error: Execution error: LanceError(IO): No page info found for field: Day, field_id=8 batch=0, /home/runner/work/lance/lance/rust/lance-file/src/reader.rs:681:19</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1230898022079004787 class=chatlog__message-container data-message-id=1230898022079004787><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, April 19, 2024 3:09â€¯PM"> <a href=#chatlog__message-container-1230898022079004787>4/19/2024 3:09â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1232077501719642112 class=chatlog__message-container data-message-id=1232077501719642112><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kohlerbear3381 data-user-id=450637514668113921>kohlerbear</span> <span class=chatlog__timestamp title="Monday, April 22, 2024 9:16â€¯PM"><a href=#chatlog__message-container-1232077501719642112>4/22/2024 9:16â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi there, I&#39;m seeing the following error when attempting to create a scalar index (column I&#39;m indexing is a string named <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">time_of_day</code> , so the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">min</code> here makes me suspect something might be happening with an internal column named <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">min</code>?):
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">OSError: LanceError(Arrow): Invalid argument error: Column &#39;min&#39; is declared as non-nullable but contains null values, /home/runner/work/lance/lance/rust/lance-index/src/scalar/btree.rs:1031:8</code>

Any guidance on what might be going on here?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1237660577749274684 class=chatlog__message-container data-message-id=1237660577749274684><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=zealous_lynx_89282 data-user-id=1208519774733078533>Gal</span> <span class=chatlog__timestamp title="Wednesday, May 8, 2024 7:01â€¯AM"><a href=#chatlog__message-container-1237660577749274684>5/8/2024 7:01â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, 
I am not sure if it is a bug.
But (sometime)&#160;while attempting to delete records from a table, I receive the following error: 
 &quot;message&quot;: &quot;lance error: Commit conflict for version 3082: There was a concurrent commit that conflicts with this one and it cannot be automatically resolved. Please rerun the operation off the latest version of the table.\n Transaction: Transaction....

Does anyone know why it happens?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1237787926037921878 class=chatlog__message-container data-message-id=1237787926037921878><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, May 8, 2024 3:27â€¯PM"> <a href=#chatlog__message-container-1237787926037921878>5/8/2024 3:27â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1238542427287978066 class=chatlog__message-container data-message-id=1238542427287978066><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kohlerbear3381 data-user-id=450637514668113921>kohlerbear</span> <span class=chatlog__timestamp title="Friday, May 10, 2024 5:25â€¯PM"><a href=#chatlog__message-container-1238542427287978066>5/10/2024 5:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m running into an offset overflow when attempting a (large-ish) table update - any suggestions on how to break down the update into smaller pieces?
(Bug report with more info here: <a href="https://github.com/lancedb/lancedb/issues/1291)">https://github.com/lancedb/lancedb/issues/1291)</a></span></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1238549880465784847 class=chatlog__message-container data-message-id=1238549880465784847><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, May 10, 2024 5:55â€¯PM"> <a href=#chatlog__message-container-1238549880465784847>5/10/2024 5:55â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1240444576985124934 class=chatlog__message-container data-message-id=1240444576985124934><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=mtdonato data-user-id=912791911796990002>mtdonato</span> <span class=chatlog__timestamp title="Wednesday, May 15, 2024 11:23â€¯PM"><a href=#chatlog__message-container-1240444576985124934>5/15/2024 11:23â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m finding the time of a query on a lancedb table strange. This simple where is taking ~26s. My table has more or less 400k rows. Can anyone imagine what could be happening?

def get_data(self, id: str):
        &#39;&#39;&#39; Retorna os dados de um registro&#39;&#39;&#39;
        return self.tbl.search().where(f&quot;{self.id_type} = &#39;{id}&#39;&quot;, prefilter=True).to_list()[0]</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1240668533663338496 class=chatlog__message-container data-message-id=1240668533663338496><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chen_76550 data-user-id=1240663944738373652>chen</span> <span class=chatlog__timestamp title="Thursday, May 16, 2024 2:13â€¯PM"><a href=#chatlog__message-container-1240668533663338496>5/16/2024 2:13â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, I am not sure this is the right place - I just want to make sure I understand correctly - for each chunk I insert to the DB - lance creates a new manifest file ? If I have a lot of chunks a lot of manifest files will be created and the chances for conflicts will be higher?</span> <span class=chatlog__edited-timestamp title="Thursday, May 16, 2024 2:14â€¯PM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1240669126196985928 class=chatlog__message-container data-message-id=1240669126196985928><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, May 16, 2024 2:16â€¯PM">2:16â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Another question - query function has a limit  default value of 10 is there a way to  query without any limit?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1241070283759292436 class=chatlog__message-container data-message-id=1241070283759292436><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=chen_76550>chen</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1240669126196985928')"> Another question - query function has a limit  default value of 10 is there a way to  query without any limit? </span></div></div><div class=chatlog__header><span class=chatlog__author title=qian_00349 data-user-id=1139637723725041674>Qian</span> <span class=chatlog__timestamp title="Friday, May 17, 2024 4:50â€¯PM"><a href=#chatlog__message-container-1241070283759292436>5/17/2024 4:50â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>you can set the number of rows to be returned with .limit(n) . If you would like to have the whole table returned, set n= table.count_rows()</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1241433060327817287 class=chatlog__message-container data-message-id=1241433060327817287><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chen_76550 data-user-id=1240663944738373652>chen</span> <span class=chatlog__timestamp title="Saturday, May 18, 2024 4:51â€¯PM"><a href=#chatlog__message-container-1241433060327817287>5/18/2024 4:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thank you</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1244671943764873236 class=chatlog__message-container data-message-id=1244671943764873236><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/863364093670981643/d2ba859ad949a383c3601235f1bc0825.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=jiahuei_ data-user-id=863364093670981643>jiahuei_</span> <span class=chatlog__timestamp title="Monday, May 27, 2024 3:21â€¯PM"><a href=#chatlog__message-container-1244671943764873236>5/27/2024 3:21â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi all, in our GitHub CI runs sometimes one of our add row tests will fail randomly with this error:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Dataset at path app/api/db/default/default/chat/documents.lance was not found: LanceError(IO): Generic LocalFileSystem error: Unable to access metadata for app/api/db/default/default/chat/documents.lance/_versions/.tmp_6.manifest_3fba7042-d4a3-4bfb-a4a4-a75c671cf786: IO error for operation on /app/api/db/default/default/chat/documents.lance/_versions/.tmp_6.manifest_3fba7042-d4a3-4bfb-a4a4-a75c671cf786: No such file or directory (os error 2), /home/runner/work/lance/lance/rust/lance-table/src/io/commit.rs:89:26, /home/runner/work/lance/lance/rust/lance/src/dataset/builder.rs:217:31</code>

Any ideas? Thanks</span> <span class=chatlog__edited-timestamp title="Monday, May 27, 2024 3:22â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1244677528875172004 class=chatlog__message-container data-message-id=1244677528875172004><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, May 27, 2024 3:44â€¯PM"> <a href=#chatlog__message-container-1244677528875172004>5/27/2024 3:44â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1245054466722365541 class=chatlog__message-container data-message-id=1245054466722365541><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=ipoflexx data-user-id=692097686589145138>ipoflexx</span> <span class=chatlog__timestamp title="Tuesday, May 28, 2024 4:41â€¯PM"><a href=#chatlog__message-container-1245054466722365541>5/28/2024 4:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi everyone, i&#39;m not sure if this is the right place but i&#39;m struggling adding lance format in my framework. i have a child class of torch.utils.data.Dataset which have the line :
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">self.data_infos.take([index]).to_pylist()[0]</code>
where <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">self.data_infos</code> is my lance dataset loaded priorly with : <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance.dataset(dataset_path)</code>. This dataset is fed to a torch.utils.data.Dataloader
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">data_loader = DataLoader(dataset,batch_size=batch_size,sampler=sampler,num_workers=num_workers,batch_sampler=batch_sampler,collate_fn=partial(dc_collate,samples_per_gpu=samples_per_gpu),pin_memory=kwargs.pop(&quot;pin_memory&quot;, False),worker_init_fn=init_fn,**kwargs)</code>. This works find as long as <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">num_workers=0</code> otherwise the access to the lance dataset isn&#39;t possible. So i am wondering how can i do parallel access for multi-gpu in pytorch with lance. Thank you and sorry if the question is redundant but i couldn&#39;t find any ressources that could help me.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1245114430438510705 class=chatlog__message-container data-message-id=1245114430438510705><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=sandias42 data-user-id=686348388484382828>sandias42</span> <span class=chatlog__timestamp title="Tuesday, May 28, 2024 8:40â€¯PM"><a href=#chatlog__message-container-1245114430438510705>5/28/2024 8:40â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi folks, I&#39;m loving lancedb so far! I&#39;m getting a bug which I thought I&#39;d share (sorry if this is the wrong place!). I&#39;ve got a large lancedb table (~1.6TB, 700M rows) and a small dataset of ~2k embeddings which I&#39;m trying to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">merge</code>  into the large table. I&#39;m merging on a string key present in both.  This is traceback:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">---------------------------------------------------------------------------
OSError                                   Traceback (most recent call last)
Cell In[33], line 1
----&gt; 1 main_table.merge(lance_vec_table.to_lance(), left_on=&quot;resume_id&quot;).batch_size(1024)

File /opt/conda/envs/raycluster/lib/python3.11/site-packages/lancedb/table.py:1335, in LanceTable.merge(self, other_table, left_on, right_on, schema)
   1333 if isinstance(other_table, LanceDataset):
   1334     other_table = other_table.to_table()
-&gt; 1335 self._ref.dataset = self._dataset_mut.merge(
   1336     other_table, left_on=left_on, right_on=right_on, schema=schema
   1337 )

File /opt/conda/envs/raycluster/lib/python3.11/site-packages/lance/dataset.py:752, in LanceDataset.merge(self, data_obj, left_on, right_on, schema)
    748     right_on = left_on
    750 reader = _coerce_reader(data_obj, schema)
--&gt; 752 self._ds.merge(reader, left_on, right_on)

OSError: Encountered internal error. Please file a bug report at https://github.com/lancedb/lance/issues. Fragment Updater: batch size mismatch: 640 != 1024, /home/runner/work/lance/lance/rust/lance/src/dataset/updater.rs:331:31</code>
I&#39;ve tried merging with the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">source</code> as a pandas dataframe, a pa table, and a lance dataset (which I obtained by creating a new lancedb table then doing to_lance) and I get this same error every time. Python is 3.11.9, lancedb 0.8.0, pylance 0.11.0. Any ideas? Thanks!</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1245126557400432757 class=chatlog__message-container data-message-id=1245126557400432757><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, May 28, 2024 9:28â€¯PM"> <a href=#chatlog__message-container-1245126557400432757>5/28/2024 9:28â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1246126479696203907 class=chatlog__message-container data-message-id=1246126479696203907><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/464194627520430090/7cb561f5cfdce31ab563051aa8cd84ae.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=cloneofsimo data-user-id=464194627520430090>cloneofsimo</span> <span class=chatlog__timestamp title="Friday, May 31, 2024 3:41â€¯PM"><a href=#chatlog__message-container-1246126479696203907>5/31/2024 3:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This isn&#39;t exactly bug report, but since there are so many of them I&#39;ll just post them in bulk here.

1.  <a href="https://lancedb.github.io/lance/read_and_write.html#writing-lance-dataset">https://lancedb.github.io/lance/read_and_write.html#writing-lance-dataset</a> example codes in this section does not work. producer is defined but not used anywhere, replacing reader with producer doesnt work.
2. Nowhere in this doc describes how one just.. CRUD? I mean how do I just add batch of row? dataset.add_rows().,..?
3.  It seems like supported data type for lance is subset of pyarrow&#39;s, so I can&#39;t seem to put int8 or float8 format just out of the box. Even if I provide schema, it won&#39;t convert list of python floats into such format.
4. <a href="https://lancedb.github.io/lance/read_and_write.html#replace-a-portion-of-data">https://lancedb.github.io/lance/read_and_write.html#replace-a-portion-of-data</a>
<a href="https://lancedb.github.io/lance/read_and_write.html#update-or-insert-upsert">https://lancedb.github.io/lance/read_and_write.html#update-or-insert-upsert</a>
<a href="https://lancedb.github.io/lance/read_and_write.html#insert-if-not-exists">https://lancedb.github.io/lance/read_and_write.html#insert-if-not-exists</a>
<a href="https://lancedb.github.io/lance/read_and_write.html#bulk-update">https://lancedb.github.io/lance/read_and_write.html#bulk-update</a>
All of the example code blocks above, just does not work. I think you meant to put execute(new_table). I think itd be useful to have more... correct (and useful) examples, such as complex data formats, such as tensors, list of tensors, model states, images binaries, etc, as we are here for those and not for merely strings (we would be using postgres for strings...)

Personally, docs for lance has been very difficult to follow. All ive tried to do was to put float16 dataformat into lance dataset and I just simply couldn&#39;t get it to work easily. I had to look up the source code to get it to work... Not to mention the attempt to parallel process large dataset ive mentioned on the other channel. I have better understanding of it but I feel like I wasted a lot of time.

Hope this feedback helped some way</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1246137853982019720 class=chatlog__message-container data-message-id=1246137853982019720><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, May 31, 2024 4:26â€¯PM"> <a href=#chatlog__message-container-1246137853982019720>5/31/2024 4:26â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1248383575078735994 class=chatlog__message-container data-message-id=1248383575078735994><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kohlerbear3381 data-user-id=450637514668113921>kohlerbear</span> <span class=chatlog__timestamp title="Thursday, June 6, 2024 9:10â€¯PM"><a href=#chatlog__message-container-1248383575078735994>6/6/2024 9:10â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hey folks! I&#39;m running into what I think is a regression between lance 0.8.0 and 0.8.1. On 0.8.0, I&#39;m able to load/query my table without issue. On 0.8.1 (and 0.8.2), I&#39;m now running into a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">LanceError(IO): file size is too small</code> error when doing any sort of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">search()</code>/<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">head()</code>/etc. request. Any guidance on how to potentially debug this further?</span> <span class=chatlog__edited-timestamp title="Thursday, June 6, 2024 9:11â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1248653327873605718 class=chatlog__message-container data-message-id=1248653327873605718><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=kohlerbear3381 data-user-id=450637514668113921>kohlerbear</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, June 7, 2024 3:02â€¯PM"> <a href=#chatlog__message-container-1248653327873605718>6/7/2024 3:02â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1248717061404753941 class=chatlog__message-container data-message-id=1248717061404753941><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=sandias42 data-user-id=686348388484382828>sandias42</span> <span class=chatlog__timestamp title="Friday, June 7, 2024 7:15â€¯PM"><a href=#chatlog__message-container-1248717061404753941>6/7/2024 7:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Howdy, I&#39;m experiencing an error writing to S3 with both the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.add(my_dataframe_generator())</code>  generator-based write and the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance.ray.sink.LanceDatasink</code> approach with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">ray.data</code>. <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.add(df)</code> works fine. Details in thread <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ™‚"
    title="slight_smile"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f642.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1248749763210379457 class=chatlog__message-container data-message-id=1248749763210379457><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/240554726213681153/22645555f9e38aa01737433561ff8e0b.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=derost data-user-id=240554726213681153>deRost</span> <span class=chatlog__timestamp title="Friday, June 7, 2024 9:25â€¯PM"><a href=#chatlog__message-container-1248749763210379457>6/7/2024 9:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hiya. I&#39;m running into a &quot;Illegal instruction&quot; problem on my linux VM when importing lancedb in either js or python. It works fine on the Windows host, but not the Linux VM. Some searching here indicates it might be a cpu problem and I may need to compile it myself, which is not ideal as lancedb is used as part of a vscode plugin. Anyone with experience with this?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1248753382529699855 class=chatlog__message-container data-message-id=1248753382529699855><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, June 7, 2024 9:40â€¯PM"> <a href=#chatlog__message-container-1248753382529699855>6/7/2024 9:40â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1255125487211118592 class=chatlog__message-container data-message-id=1255125487211118592><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=itziksiegelbareket2369 data-user-id=716978516339720213>Yitz</span> <span class=chatlog__timestamp title="Tuesday, June 25, 2024 11:40â€¯AM"><a href=#chatlog__message-container-1255125487211118592>6/25/2024 11:40â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello, I&#39;m getting an <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">AttributeError: module &#39;lance&#39; has no attribute &#39;commit&#39;</code> while trying to run merge insert in an aws lambda. 

this code block:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">        new_messages_table = pa.Table.from_pylist([m.model_dump() for m in instant_messages],
                                                  schema=messages_dataset.schema)
        messages_dataset.merge_insert(&quot;instant_message_id&quot;) \
            .when_matched_update_all() \
            .execute(new_messages_table)</code>
will execute well locally but will fail with:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">{
  &quot;errorMessage&quot;: &quot;Encountered internal error. Please file a bug report at https://github.com/lancedb/lance/issues. Error importing from pylance AttributeError: module &#39;lance&#39; has no attribute &#39;commit&#39;, src/dataset/commit.rs:41:27&quot;,
  &quot;errorType&quot;: &quot;OSError&quot;,
  &quot;requestId&quot;: &quot;fcdd6ee4-6b42-4012-828e-ce0b49a32a2d&quot;,
  &quot;stackTrace&quot;: [
    &quot;  File \&quot;/ingestion/ingestion/get_attachments.py\&quot;, line 85, in handler\n    .execute(new_messages_table)\n&quot;,
    &quot;  File \&quot;/usr/local/lib/python3.11/site-packages/lance/dataset.py\&quot;, line 104, in execute\n    return super(MergeInsertBuilder, self).execute(reader)\n&quot;
  ]
}</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1255187089495035908 class=chatlog__message-container data-message-id=1255187089495035908><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, June 25, 2024 3:45â€¯PM"> <a href=#chatlog__message-container-1255187089495035908>6/25/2024 3:45â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1255290994396762254 class=chatlog__message-container data-message-id=1255290994396762254><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/728741239771627570/0f6109d3d061cc9b905a33ec200f4224.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=stugorf. data-user-id=728741239771627570>stugorf.</span> <span class=chatlog__timestamp title="Tuesday, June 25, 2024 10:38â€¯PM"><a href=#chatlog__message-container-1255290994396762254>6/25/2024 10:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I have loaded a small dataset into LanceDB, I perform a vector search() in the same application invocation as loading the data. The results appear valid. If I rerun the application that performs the same search without loading the data the results always substitute the first (cosine most similar) result with the first record loaded into the database. Have you seen this or can you recommend why I might be experiencing this issue.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1255294926510362702 class=chatlog__message-container data-message-id=1255294926510362702><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, June 25, 2024 10:53â€¯PM"> <a href=#chatlog__message-container-1255294926510362702>6/25/2024 10:53â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1255659704265347084 class=chatlog__message-container data-message-id=1255659704265347084><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=sandias42 data-user-id=686348388484382828>sandias42</span> <span class=chatlog__timestamp title="Wednesday, June 26, 2024 11:03â€¯PM"><a href=#chatlog__message-container-1255659704265347084>6/26/2024 11:03â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I think there&#39;s a bug in <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">python/lance/torch/kmeans.py</code>. <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Kmeans.dist_func</code> is set to either either <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">l2_distance</code> or <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">dot_distance</code> in <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">__init__</code> and invoked with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">self.dist_func(data, self.centroids, y2=y2)</code> but <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">dot_distance</code>  does not accept <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">y2</code> as a kwarg (as defined on line 231 of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">python/lance/torch/distance.py</code>). Traceback in thread.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1258569864348569714 class=chatlog__message-container data-message-id=1258569864348569714><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=giusedroid_41520 data-user-id=1022944279796129792>giusedroid</span> <span class=chatlog__timestamp title="Thursday, July 4, 2024 11:47â€¯PM"><a href=#chatlog__message-container-1258569864348569714>7/4/2024 11:47â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey folks. Do you know why you don&#39;t support &quot;:&quot; in table names anymore? It breaks AWS Cognito identities <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ˜¦"
    title="frowning"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f626.svg"></span></div></div></div></div><div id=chatlog__message-container-1258569936138403900 class=chatlog__message-container data-message-id=1258569936138403900><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, July 4, 2024 11:47â€¯PM">11:47â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>On S3</span></div></div></div></div><div id=chatlog__message-container-1258570398975655986 class=chatlog__message-container data-message-id=1258570398975655986><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, July 4, 2024 11:49â€¯PM">11:49â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>(migrating from 0.3.3 to 0.9.0 <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ˜¦"
    title="frowning"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f626.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1258671129137119277 class=chatlog__message-container data-message-id=1258671129137119277><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, July 5, 2024 6:29â€¯AM"> <a href=#chatlog__message-container-1258671129137119277>7/5/2024 6:29â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1260120190184591441 class=chatlog__message-container data-message-id=1260120190184591441><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jhsieh data-user-id=714506948132864011>jmhsieh</span> <span class=chatlog__timestamp title="Tuesday, July 9, 2024 6:27â€¯AM"><a href=#chatlog__message-container-1260120190184591441>7/9/2024 6:27â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey folks, I&#39;m trying to update a binary field in a lance record (generating an image, saving it with the existing record), and found that table.update fails with a not implemented error &quot;SQL converstion is not implemented for this type&quot;.  Attached is an ipynotebook with example code/outputs.</span></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1260120189819944980/LanceDB_-_update_binary_fails.ipynb?ex=698a2721&amp;is=6988d5a1&amp;hm=b081b902ee8b32c3e751b2baa8a20422aa70d1f5584c05daf1dba92cda731a2e&amp;"> LanceDB_-_update_binary_fails.ipynb </a></div><div class=chatlog__attachment-generic-size>10.99 KB</div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=eye><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ï¸ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f441.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1260127742654021692 class=chatlog__message-container data-message-id=1260127742654021692><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jhsieh data-user-id=714506948132864011>jmhsieh</span> <span class=chatlog__timestamp title="Tuesday, July 9, 2024 6:57â€¯AM"><a href=#chatlog__message-container-1260127742654021692>7/9/2024 6:57â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Here&#39;s what seems to be a subtle bug around null and empty string handling.  Basically, if I use empty strings I get inconsistent behavior with &quot;is null&quot; filters.</span></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1260127742318350376/LanceDB_-_null_or_empty_string_handling_and_filtering_inconsistent.ipynb?ex=698a2e29&amp;is=6988dca9&amp;hm=413ff02b9ca85352b70172a36685047fed8e3a7e7ca07b09065bd8359c5c599a&amp;"> LanceDB_-_null_or_empty_string_handling_and_filtering_inconsistent.ipynb </a></div><div class=chatlog__attachment-generic-size>4.8 KB</div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1260284791107096670 class=chatlog__message-container data-message-id=1260284791107096670><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, July 9, 2024 5:21â€¯PM"> <a href=#chatlog__message-container-1260284791107096670>7/9/2024 5:21â€¯PM</a> </span></div></div></div><div id=chatlog__message-container-1260472150989606988 class=chatlog__message-container data-message-id=1260472150989606988><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, July 10, 2024 5:46â€¯AM"> <a href=#chatlog__message-container-1260472150989606988>7/10/2024 5:46â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1265534639326625915 class=chatlog__message-container data-message-id=1265534639326625915><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/863364093670981643/d2ba859ad949a383c3601235f1bc0825.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=jiahuei_ data-user-id=863364093670981643>jiahuei_</span> <span class=chatlog__timestamp title="Wednesday, July 24, 2024 5:02â€¯AM"><a href=#chatlog__message-container-1265534639326625915>7/24/2024 5:02â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi guys, I encountered issues where certain versions of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lancedb</code> and <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pylance</code> fail to load certain tables, while some will be able to load them but not delete rows from the table. The table is attached below. I also <a href="https://github.com/lancedb/lancedb/issues/1466">created an issue on GitHub</a></span></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1265534639510913129/test_table.lance.zip?ex=698a133a&amp;is=6988c1ba&amp;hm=b339cc901cb9e6d0817eed6e1d04c859e51a58bf3cadefb83b0fa7dddf0ae867&amp;"> test_table.lance.zip </a></div><div class=chatlog__attachment-generic-size>1.09 MB</div></div></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/1466><div class="chatlog__markdown chatlog__markdown-preserve">bug(python): Fail to delete rows due to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">OSError: LanceError(IO)</code> &#183;...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LanceDB version v0.10.1 What happened? Row deletion on the attached table test_table.lance.zip fails with this error: OSError: LanceError(IO): Execution error: External error: Execution error: Lanc...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/etEuR1cjlCjLEnpvRhBhz9sUm4JvjfgQq4KOObviSPQ/https/opengraph.githubassets.com/78e7c368b3b96e4a846c32695129c4944d1cb0d2ac64c817e0fefeaf281d0654/lancedb/lancedb/issues/1466> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/etEuR1cjlCjLEnpvRhBhz9sUm4JvjfgQq4KOObviSPQ/https/opengraph.githubassets.com/78e7c368b3b96e4a846c32695129c4944d1cb0d2ac64c817e0fefeaf281d0654/lancedb/lancedb/issues/1466 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1265564327113654363 class=chatlog__message-container data-message-id=1265564327113654363><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/863364093670981643/d2ba859ad949a383c3601235f1bc0825.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/863364093670981643/d2ba859ad949a383c3601235f1bc0825.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=jiahuei_>jiahuei_</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1265534639326625915')"> Hi guys, I encountered issues where certain versions of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lancedb</code> and <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pylance</code> fail to load certain tables, while some will be able to load them but not delete rows from the table. The table is attached below. I also <a href="https://github.com/lancedb/lancedb/issues/1466">created an issue on GitHub</a> </span></div></div><div class=chatlog__header><span class=chatlog__author title=jiahuei_ data-user-id=863364093670981643>jiahuei_</span> <span class=chatlog__timestamp title="Wednesday, July 24, 2024 7:00â€¯AM"><a href=#chatlog__message-container-1265564327113654363>7/24/2024 7:00â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>These are the versions tested
------------
READ OK, DELETE OK
------------
lancedb 0.8.0, pylance 0.11.0

------------
READ OK, DELETE FAIL
------------
lancedb 0.8.0, pylance 0.11.0
lancedb 0.9.0, pylance 0.13.0
lancedb 0.10.0, pylance 0.14.1
lancedb 0.10.1, pylance 0.14.1

------------
READ FAIL, DELETE FAIL
------------
lancedb 0.8.1, pylance 0.11.1
lancedb 0.8.2, pylance 0.12.1</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1265651513032970348 class=chatlog__message-container data-message-id=1265651513032970348><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, July 24, 2024 12:47â€¯PM"> <a href=#chatlog__message-container-1265651513032970348>7/24/2024 12:47â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1268145200279191593 class=chatlog__message-container data-message-id=1268145200279191593><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chen3062 data-user-id=738395904008126494>chen</span> <span class=chatlog__timestamp title="Wednesday, July 31, 2024 9:56â€¯AM"><a href=#chatlog__message-container-1268145200279191593>7/31/2024 9:56â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi,  found a scenario in which we try to delete chunks and at the meantime other chunks ( not related ) are added to the table, then we get the following error: Commit conflict for version 13090: There was a concurrent commit that conflicts with this one and it cannot be automatically resolved. Please rerun the operation off the latest version of the table.
 Transaction: Transaction { read_version: 13089, uuid: &quot;4af04985-ecc5-40f0-acc6-2953fbb2820b&quot;, operation: Delete { updated_fragments: [Fragment { id: 13075, files: [DataFile { path: &quot;850c3890-1314-49bc-a2a6-dbf4e817bbfb.lance&quot;, fields: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], column_indices: [], file_major_version: 0, file_minor_version: 0 }], deletion_file: Some(DeletionFile { read_version: 13089, id: 2842110123760556603, file_type: Array, num_deleted_rows: Some(13) }), physical_rows: Some(13018) }], deleted_fragment_ids: [], predicate: &quot;(datasource_id = &quot;a8244370-ed44-420a-9d20-95a4802c87fd&quot;) AND (inode=6047124750868677000)&quot; }, tag: None }
 Conflicting Transaction: Some(Transaction { read_version: 13089, uuid: &quot;e2fe8599-f9fb-4d65-b23e-fb781f0bef99&quot;, operation: Append { fragments: [Fragment { id: 0, files: [DataFile { path: &quot;8a917a51-1f32-423d-81af-54f4ebec3a75.lance&quot;, fields: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], column_indices: [], file_major_version: 0, file_minor_version: 0 }], deletion_file: None, physical_rows: Some(1) }] }, tag: None }), /home/build_user/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-0.10.18/src/io/commit.rs:107:23.   when is it safe to do a delete from lance? ( we work with nodejs)</span> <span class=chatlog__edited-timestamp title="Wednesday, July 31, 2024 9:58â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1268223598577848409 class=chatlog__message-container data-message-id=1268223598577848409><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, July 31, 2024 3:07â€¯PM"> <a href=#chatlog__message-container-1268223598577848409>7/31/2024 3:07â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1268226312871481404 class=chatlog__message-container data-message-id=1268226312871481404><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Wednesday, July 31, 2024 3:18â€¯PM"><a href=#chatlog__message-container-1268226312871481404>7/31/2024 3:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Good luck Daniel</span></div></div></div></div><div id=chatlog__message-container-1268227903116804116 class=chatlog__message-container data-message-id=1268227903116804116><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Wednesday, July 31, 2024 3:24â€¯PM">3:24â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Please post in <span class="chatlog__markdown-mention">#looking</span> channel. Thanks</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1268497750081933342 class=chatlog__message-container data-message-id=1268497750081933342><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=yca1 data-user-id=621057130371481601>yca1</span> <span class=chatlog__timestamp title="Thursday, August 1, 2024 9:17â€¯AM"><a href=#chatlog__message-container-1268497750081933342>8/1/2024 9:17â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey!
I&#39;ve noticed that version 0.8.0 (and 0.7.2) of the js lib are not published on npm. Can they be published please?

The docs use the v0.8 version and there&#39;s a release for it in Github releases. I want to use the transformers embeddings function which were added in v0.8.

<a href="https://www.npmjs.com/package/@lancedb/lancedb?activeTab=versions">https://www.npmjs.com/package/@lancedb/lancedb?activeTab=versions</a></span> <span class=chatlog__edited-timestamp title="Thursday, August 1, 2024 9:20â€¯AM">(edited)</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(203,56,55,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href="https://www.npmjs.com/package/@lancedb/lancedb?activeTab=versions"><div class="chatlog__markdown chatlog__markdown-preserve">@lancedb/lancedb</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LanceDB: A serverless, low-latency vector database for AI applications. Latest version: 0.7.1, last published: 15 days ago. Start using @lancedb/lancedb in your project by running <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">npm i @lancedb/lancedb</code>. There is 1 other project in the npm registry using @lancedb/lancedb.</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/Ad-xJpugnwmVAyOVzIOuFNMDAfzOhcQNxVhcqe5tL1g/https/static-production.npmjs.com/338e4905a2684ca96e08c7780fc68412.png> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/Ad-xJpugnwmVAyOVzIOuFNMDAfzOhcQNxVhcqe5tL1g/https/static-production.npmjs.com/338e4905a2684ca96e08c7780fc68412.png alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1268947767649112075 class=chatlog__message-container data-message-id=1268947767649112075><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1107704233685434519/57e5fc331623dc34a8cf262d060dea71.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=yca1>yca1</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1268497750081933342')"> Hey!
I&#39;ve noticed that version 0.8.0 (and 0.7.2) of the js lib are not published on npm. Can they be published please?

The docs use the v0.8 version and there&#39;s a release for it in Github releases. I want to use the transformers embeddings function which were added in v0.8.

<a href="https://www.npmjs.com/package/@lancedb/lancedb?activeTab=versions">https://www.npmjs.com/package/@lancedb/lancedb?activeTab=versions</a> </span> <span class=chatlog__reply-edited-timestamp title="Thursday, August 1, 2024 9:20â€¯AM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span class=chatlog__timestamp title="Friday, August 2, 2024 3:05â€¯PM"><a href=#chatlog__message-container-1268947767649112075>8/2/2024 3:05â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Apologies, something broke in our release process. I&#39;m still working on fixing it so we can publish. Should have it published by end of day today.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1268948001100140661 class=chatlog__message-container data-message-id=1268948001100140661><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=yca1 data-user-id=621057130371481601>yca1</span> <span class=chatlog__timestamp title="Friday, August 2, 2024 3:06â€¯PM"><a href=#chatlog__message-container-1268948001100140661>8/2/2024 3:06â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>awesome, thank you</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1269918739411763222 class=chatlog__message-container data-message-id=1269918739411763222><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1125651771302367304/e013c1cf043a359b642e44a1c1930d9b.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=memfree data-user-id=1125651771302367304>MemFree</span> <span class=chatlog__timestamp title="Monday, August 5, 2024 7:23â€¯AM"><a href=#chatlog__message-container-1269918739411763222>8/5/2024 7:23â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><a href="https://github.com/lancedb/lancedb/issues/1497">https://github.com/lancedb/lancedb/issues/1497</a> I have been encountering this issue in the production environment recently. Can anyone help me take a look? Thank you</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/1497><div class="chatlog__markdown chatlog__markdown-preserve">bug(node): LanceError(Arrow): Invalid argument error: Last offset 1...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LanceDB version 0.5.2 @lancedb/lancedb What happened? Failed to get next batch from stream: lance error: LanceError(IO): Execution error: External error: Execution error: LanceError(Arrow): Invalid...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/shC2Z_zCCo7XkZ906aOxktuaVf8RuXqdMDTB97Cf2ek/https/opengraph.githubassets.com/d63e40e870fca0a439dd5f41b037cc560afb863df6f25baf7748cd7649cd547f/lancedb/lancedb/issues/1497> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/shC2Z_zCCo7XkZ906aOxktuaVf8RuXqdMDTB97Cf2ek/https/opengraph.githubassets.com/d63e40e870fca0a439dd5f41b037cc560afb863df6f25baf7748cd7649cd547f/lancedb/lancedb/issues/1497 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1269956036568154249 class=chatlog__message-container data-message-id=1269956036568154249><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=memfree data-user-id=1125651771302367304>MemFree</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, August 5, 2024 9:51â€¯AM"> <a href=#chatlog__message-container-1269956036568154249>8/5/2024 9:51â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1270550661079109726 class=chatlog__message-container data-message-id=1270550661079109726><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/453011810984132648/7e7ce1345a74b61dde07ed74b98a089e.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kdexd data-user-id=453011810984132648>kd</span> <span class=chatlog__timestamp title="Wednesday, August 7, 2024 1:14â€¯AM"><a href=#chatlog__message-container-1270550661079109726>8/7/2024 1:14â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I upgraded to Lance v0.16 today.

I am trying to write a dataset in Lance v2 format, which is currently throwing a &quot;panic exception&quot; because one of the columns contains bytes (length of each row for this column has high variance, from <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">None</code> to a few kilobytes). This code did not raise an exception while writing in v1 format with <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pylance==0.14.1</code>.

Full Rust stacktrace for visibility: (attached)</span></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1270550660781445202/message.txt?ex=698a8683&amp;is=69893503&amp;hm=68f93ba7c3c9c9065a37bbfc3f7872809605535d543ebab8727617b0cc193b81&amp;"> message.txt </a></div><div class=chatlog__attachment-generic-size>4.52 KB</div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1270567809868365849 class=chatlog__message-container data-message-id=1270567809868365849><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, August 7, 2024 2:22â€¯AM"> <a href=#chatlog__message-container-1270567809868365849>8/7/2024 2:22â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1271164916807503945 class=chatlog__message-container data-message-id=1271164916807503945><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/240303652701601793/ad488827f7fd5ea50f3ed4eb60531c8f.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=zeroarmedbandit data-user-id=240303652701601793>zeroarmedbandit</span> <span class=chatlog__timestamp title="Thursday, August 8, 2024 5:55â€¯PM"><a href=#chatlog__message-container-1271164916807503945>8/8/2024 5:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Not a big worry at all but the docs for full-text search don&#39;t indicate that you need to have a vector column or specifically set &quot;fts&quot; as a search method. As someone using it for the first time I was a bit confused why it was looking for a vector column as I was just trying to use fts. Otherwise things are looking great!</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup_tone1><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ðŸ» src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d-1f3fb.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1271959194848727150 class=chatlog__message-container data-message-id=1271959194848727150><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kpkpkpkpkp data-user-id=573400024919310337>kp</span> <span class=chatlog__timestamp title="Saturday, August 10, 2024 10:31â€¯PM"><a href=#chatlog__message-container-1271959194848727150>8/10/2024 10:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>We re-wrote out datasets in the Lance v2 format, but I&#39;m running into a new error.

We have a nullable binary column <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">mycolumn</code>  and an associated boolean column to store whether it is not null <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">has_mycolumn</code> (so we can create a scalar index).

For our data loading pipeline, we&#39;re first getting the list of all row IDs like so:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">row_ids = [
    r[&quot;_rowid&quot;].to_pylist()
    for r in tqdm.tqdm(db.to_batches(
        columns=[],
        filter=&quot;has_mycolumn IS TRUE&quot;,
        with_row_id=True,
    ))
]
row_ids = [x for xs in row_ids for x in xs]</code>

and then the idea is to use <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_take_rows</code> to get the rows in the dataloader, but this is sometimes leading to panic:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">batch_size = 1024
num_batches = len(row_ids) // batch_size
for batch_idx in tqdm.trange(num_batches):
    lo = batch_idx * batch_size
    hi = (batch_idx + 1) * batch_size
    rows = db._take_rows(row_ids[lo:hi], columns=[&quot;mycolumn&quot;])</code>
The panic error:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">PanicException                            Traceback (most recent call last)
Cell In[49], line 7
      5     hi = (batch_idx + 1) * batch_size
      6     print(lo, hi)
----&gt; 7     rows = db._take_rows(row_ids[lo:hi], columns=[&quot;mycolumn&quot;])
      9 # for r in tqdm.tqdm(row_ids):
     10 #     rows = db._take_rows([r], columns=[&quot;mycolumn&quot;])

File [...]/.venv/lib/python3.10/site-packages/lance/dataset.py:651, in LanceDataset._take_rows(self, row_ids, columns, **kargs)
    648     columns_with_transform = list(columns.items())
    649     columns = None
    650 return pa.Table.from_batches(
--&gt; 651     [self._ds.take_rows(row_ids, columns, columns_with_transform)]
    652 )

PanicException: called `Option::unwrap()` on a `None` value</code>

I&#39;ve narrowed down the two rows it happens in
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">rows = db._take_rows([32957, 32958], columns=[&quot;mycolumn&quot;])</code>
but strangely when I take the two rows independently it does not panic:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">rows = db._take_rows([32957], columns=[&quot;mycolumn&quot;])
rows = db._take_rows([32958], columns=[&quot;mycolumn&quot;])</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1273173005392019510 class=chatlog__message-container data-message-id=1273173005392019510><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kpkpkpkpkp data-user-id=573400024919310337>kp</span> <span class=chatlog__timestamp title="Wednesday, August 14, 2024 6:54â€¯AM"><a href=#chatlog__message-container-1273173005392019510>8/14/2024 6:54â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello! I&#39;m trying to use the fragment level API in Apache Beam to do distributed writes then a commit in the final step. I am explicitly setting <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">data_storage_version=&quot;stable&quot;</code> but this seems to be ignored and the dataset I read out always reports data storage version <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">0.1</code>. 

Here are the transforms I wrote to do this: <a href="https://gist.github.com/keunhong/2d8d1d0702a5d621baadaa06022d4b09">https://gist.github.com/keunhong/2d8d1d0702a5d621baadaa06022d4b09</a>

In particular, I&#39;m writing the fragments like this:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">        fragment_metadata = lance.fragment.write_fragments(
            data,
            self.dataset_uri,
            schema=self.schema,
            mode=&quot;append&quot;,
            data_storage_version=&quot;stable&quot;,
        )</code>

and then aggregating the fragment metadata to commit exactly once:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">        operation = lance.LanceOperation.Overwrite(self.schema, element)
        dataset = lance.LanceDataset.commit(self.dataset_uri, operation)</code>

This appears happens on both the lates <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">0.16</code> release and the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">0.17</code> pre-release.</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://gist.github.com/keunhong/2d8d1d0702a5d621baadaa06022d4b09><div class="chatlog__markdown chatlog__markdown-preserve">lanceio.py</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">lanceio.py. GitHub Gist: instantly share code, notes, and snippets.</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/7lesHV5TJfXV9rDct_prZ0T8dzM8AdALoVfer2-rnhs/https/github.githubassets.com/assets/gist-og-image-54fd7dc0713e.png> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/7lesHV5TJfXV9rDct_prZ0T8dzM8AdALoVfer2-rnhs/https/github.githubassets.com/assets/gist-og-image-54fd7dc0713e.png alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1273178192558948388 class=chatlog__message-container data-message-id=1273178192558948388><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=kpkpkpkpkp data-user-id=573400024919310337>kp</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, August 14, 2024 7:15â€¯AM"> <a href=#chatlog__message-container-1273178192558948388>8/14/2024 7:15â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1277230905584259185 class=chatlog__message-container data-message-id=1277230905584259185><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/431539523151986697/b73b47f91fe76a154b7d392b68199926.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=aiynd data-user-id=431539523151986697>Aiynd</span> <span class=chatlog__timestamp title="Sunday, August 25, 2024 11:39â€¯AM"><a href=#chatlog__message-container-1277230905584259185>8/25/2024 11:39â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Can the LanceDB cloud version of <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">create_table()</code> take a generator as an argument?

If I call:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">table = db.create_table(
    lance_db_table_name,
    get_batches_generator(),
    schema=Item.to_arrow_schema(),
)</code>

I get this error:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">File ~/miniconda3/envs/hl-reposearch/lib/python3.11/site-packages/lancedb/remote/arrow.py:20, in to_ipc_binary(table)
     18 &quot;&quot;&quot;Serialize a PyArrow Table to IPC binary.&quot;&quot;&quot;
...
---&gt; 20 with pa.ipc.new_stream(sink, table.schema) as writer:
     21     writer.write_table(table)
     22 return sink.getvalue().to_pybytes()

AttributeError: &#39;generator&#39; object has no attribute &#39;schema&#39;</code>

but it works fine if I keep everything the same but save to a local LanceDB database rather than cloud.

Here is the get_batches_generator() function I defined:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">def get_batches_generator():
    result = []
    batches = [nodes[i : i + batch_size] for i in range(0, len(nodes), batch_size)]
    for i, batch in enumerate(batches):
        yield pd.DataFrame.from_records(batch)</code>

and here is the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Item</code> definition

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">class Item(LanceModel):  
    vector: Vector(func.ndims()) = func.VectorField()
    content: str = func.SourceField() 
    file_path: str
    file_name: str</code></span> <span class=chatlog__edited-timestamp title="Sunday, August 25, 2024 11:40â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1277245961663549496 class=chatlog__message-container data-message-id=1277245961663549496><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=karl_bubble data-user-id=1210784375613034516>Karl</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Sunday, August 25, 2024 12:39â€¯PM"> <a href=#chatlog__message-container-1277245961663549496>8/25/2024 12:39â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1280970547966247035 class=chatlog__message-container data-message-id=1280970547966247035><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/806915177885728789/1ce9d534fe835d84d1280662c94c6fba.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=mkpro118 data-user-id=806915177885728789>mkpro118</span> <span class=chatlog__timestamp title="Wednesday, September 4, 2024 7:19â€¯PM"><a href=#chatlog__message-container-1280970547966247035>9/4/2024 7:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey everyone!

I&#39;m running into an issue with LanceDB while using it in a Docker container on Google Cloud Run. I&#39;ve got a GCS bucket mounted as a volume with GCS FUSE, and I&#39;m seeing an error when trying to create a table in the LanceDB database.

Hereâ€™s the error Iâ€™m getting (actual db/table names changed, hopefully that shouldn&#39;t matter):

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline language-txt">OSError: LanceError(IO): Generic LocalFileSystem error: Unable to copy file from /databases/test_db/test_table.lance/_versions/.tmp_1.manifest_ad2fc759-fcb6-4ce8-93f0-5e4d8ac3db40 to /databases/test_db/test_table.lance/_versions/1.manifest: Function not implemented (os error 38), /home/runner/work/lance/lance/rust/lance-table/src/io/commit.rs:693:54</code>

From what Iâ€™ve dug up, this error is coming from <a href="https://github.com/lancedb/lance/blob/1ee119cf5c003acf933b3c1513d832cb4e4f322c/rust/lance-table/src/io/commit.rs#L680">this line in the code</a>. It looks like itâ€™s trying to rename a file using a function from the object_store library, and that function seems to be trying to create a hard link. 

But the problem is, GCS FUSE doesnâ€™t support hard links, which I found in the <a href="https://cloud.google.com/storage/docs/gcs-fuse#differences-and-limitations">GCS FUSE documentation</a>. Hereâ€™s the related code from the other library if you&#39;re curious: <a href="https://docs.rs/object_store/0.11.0/src/object_store/local.rs.html#701-715">object_store/local.rs</a>.

Has anyone run into this before, or does anyone know of a workaround to avoid this error? Any help would be greatly appreciated! 

My current fix would be migrate the service to use the LanceDB GCS Object Store, but if there&#39;s any other workarounds I&#39;d love to know!

Thanks!

Some details:
<ul><li>The container uses the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">python:3.11.4-slim</code> image</li><li>LanceDB version used is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">0.12.0</code></li><li>Cloud Run service uses a second generation execution environment (idk if this is relevant but can&#39;t hurt)</li></ul></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1280993027581542435 class=chatlog__message-container data-message-id=1280993027581542435><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, September 4, 2024 8:48â€¯PM"> <a href=#chatlog__message-container-1280993027581542435>9/4/2024 8:48â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1288249286676451429 class=chatlog__message-container data-message-id=1288249286676451429><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=_pablete_ data-user-id=1070139639857418240>pablete</span> <span class=chatlog__timestamp title="Tuesday, September 24, 2024 9:22â€¯PM"><a href=#chatlog__message-container-1288249286676451429>9/24/2024 9:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello, I am having trouble merging 2 datasets since I always get OOM. 
The datasets are 11M rows with the source being&quot;uid&quot; and  &quot;image bytes&quot; (512x910) and the second dataset being &quot;uid&quot; and &quot;vector (4,32,32)&quot;

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">ds_master = lance.dataset(&quot;...&quot;) ~700Gb
ds_vae    = lance.dataset(&quot;...&quot;) ~1.2Tb

# First attempt
ds_master.merge(ds_vae, left_on=&quot;uid&quot;)

# Second attempt
ds_iterator = ds_vae.to_batches()
ds_master.merge(ds_iterator, left_on=&quot;uid&quot;, schema=ds_vae.schema)

# Third attempt
rbr = pa.RecordBatchReader.from_batches(ds_vae.schema, ds_vae.to_batches())
ds_master.merge(rbr, left_on=&quot;uid&quot;, schema=ds_vae.schema)</code>

My 3 attempt to join (or merge) these 2 columns have failed exhausting the memory of my node 768Gb. 

Am I doing something wrong? Is there a way to achieve the same operation, appending columns to a master dataset but without OOM? 

Thanks in advance</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1288472165628252269 class=chatlog__message-container data-message-id=1288472165628252269><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, September 25, 2024 12:08â€¯PM"> <a href=#chatlog__message-container-1288472165628252269>9/25/2024 12:08â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1288911085998444636 class=chatlog__message-container data-message-id=1288911085998444636><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/421450044827500554/919c62e7a6948caa25a6dc840ded2532.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=felipebcs data-user-id=421450044827500554>felipebcs</span> <span class=chatlog__timestamp title="Thursday, September 26, 2024 5:12â€¯PM"><a href=#chatlog__message-container-1288911085998444636>9/26/2024 5:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi guys! I&#39;m trying to store a Lance dataset in a GCP storage, but I&#39;ve been receiving an error regarding the JSON credentials not being parsed correctly. The error message is: 

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">OSError: LanceError(IO): Generic GCS error: GCP credential error: Unable to decode service account file: control character (\u0000-\u001F) found while parsing a string at line 2 column 0, /home/runner/work/lance/lance/rust/lance-io/src/object_store.rs:824:25</code>
I tried setting both <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">GOOGLE_SERVICE_ACCOUNT</code> with the path to the JSON file and <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">GOOGLE_SERVICE_ACCOUNT_KEY</code> with the serialized JSON that was downloaded from the GCP console. What is the right way to pass google service credentials?

I&#39;m using <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">pylance==0.17.0</code>. I&#39;ll share a sample code to reproduce this in the next message.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1291528516554330175 class=chatlog__message-container data-message-id=1291528516554330175><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/377998562619031554/d7c99706c9263ae2cb16d8e75b0012b1.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=hanimal21 data-user-id=377998562619031554>hanimal21</span> <span class=chatlog__timestamp title="Thursday, October 3, 2024 10:33â€¯PM"><a href=#chatlog__message-container-1291528516554330175>10/3/2024 10:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello everybody, I&#39;m having the following problem when running my app in vercel:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">[Error: lance error: LanceError(IO): Generic S3 error: Client error with status 400 Bad Request: No Body, /home/build_user/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-0.16.0/src/dataset.rs:390:35] {
  code: &#39;GenericFailure&#39;
}</code>
This happens when I&#39;m trying to retrieved data from a vector db in AWS S3. In local environment, this works fine. And I could not found a similar issue in the web. I&#39;m using node v20 and nextjs 13.5.7. Thanks in advance.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1291553757523345412 class=chatlog__message-container data-message-id=1291553757523345412><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, October 4, 2024 12:13â€¯AM"> <a href=#chatlog__message-container-1291553757523345412>10/4/2024 12:13â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1292804328611909645 class=chatlog__message-container data-message-id=1292804328611909645><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/292994178122514444/17b0b8c22d70aa5db17408b15383f9b2.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=victor55 data-user-id=292994178122514444>victor55</span> <span class=chatlog__timestamp title="Monday, October 7, 2024 11:02â€¯AM"><a href=#chatlog__message-container-1292804328611909645>10/7/2024 11:02â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello everyone, I&#39;m having a problem implementing hybrid search in my application. I store the tables in S3 where each user has their own table and I know that I can&#39;t perform hybrid search in S3, so I think a new alternative. I perform a search to query what documents the client wants to use and create a local table in tmp (this process will be hosted in lambda in AWS) and then I can perform hybrid search there.

 But I have a problem
File c:\Users\victor\Desktop\Itherapy_2\RAG TEST\venv\lib\site-packages\pyarrow\types.pxi:3012, in pyarrow.lib.Schema.get_field_index()

File &lt;stringsource&gt;:15, in string.from_py.<u>pyx_convert_string_from_py_6libcpp_6string_std</u>in_string()

TypeError: expected bytes, NoneType found

For doing the process I follow this code:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">table = db1.create_table(
    &quot;aux&quot;,
    schema=Documents,
) #Run on local
list_documents=[&quot;id8/76edd9e7-914e-42a4-9d9d-d70d64ab55c9.pdf&quot;]
a=str(list_documents)[1:-1]
x=tbl2.search().where(f&quot;metadata in ({a})&quot;, prefilter=True).to_arrow() #Table from S3
table.add(x) #Add the filtered documents from S3
table.create_fts_index(&quot;text&quot;, replace=True)
query=&quot;what are the symptoms of the patience&quot;
vector=bedrock_embeddings.embed_query(query)
docs = table.search(query_type=&quot;hybrid&quot;).text(query).vector(vector).limit(3).to_pandas()[&#39;text&#39;]</code></span> <span class=chatlog__edited-timestamp title="Monday, October 7, 2024 11:03â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1294652129562202112 class=chatlog__message-container data-message-id=1294652129562202112><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=ankitvarshney45 data-user-id=942349749758091284>Ankit</span> <span class=chatlog__timestamp title="Saturday, October 12, 2024 1:25â€¯PM"><a href=#chatlog__message-container-1294652129562202112>10/12/2024 1:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hello everybody , I am facing this issue while setting up connection
<code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Error in connecting to LanceDB: TypeError: Cannot read properties of undefined (reading &#39;new&#39;) </code>

this is the code which I have written
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">const uri = &quot;/tmp/lancedb/&quot;;
      const db = await lancedb.connect(uri).catch((e) =&gt; {
        Logger.error(&quot;Error in connecting to LanceDB: ${e}&quot;
);
      }); </code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1294780128332873836 class=chatlog__message-container data-message-id=1294780128332873836><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Saturday, October 12, 2024 9:53â€¯PM"> <a href=#chatlog__message-container-1294780128332873836>10/12/2024 9:53â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1296564416296390687 class=chatlog__message-container data-message-id=1296564416296390687><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=qian_00349 data-user-id=1139637723725041674>Qian</span> <span class=chatlog__timestamp title="Thursday, October 17, 2024 8:04â€¯PM"><a href=#chatlog__message-container-1296564416296390687>10/17/2024 8:04â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="smazokha">@Stephan</span> happy to debug the error you ran into <span class="chatlog__markdown-mention" title="luqiu_87609">@Lu Qiu</span> will be helping you</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1296566398977572904 class=chatlog__message-container data-message-id=1296566398977572904><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=luqiu_87609 data-user-id=1209390552148090902>Lu Qiu</span> <span class=chatlog__timestamp title="Thursday, October 17, 2024 8:11â€¯PM"><a href=#chatlog__message-container-1296566398977572904>10/17/2024 8:11â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi <span class="chatlog__markdown-mention" title="smazokha">@Stephan</span> , thanks for reporting the issue! the detailed error message is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance error: LanceError(Arrow): Io error: failed to fill whole buffer, /src/lance/rust/lance-datafusion/src/utils.rs:41:28&quot;,</code>. This error message typical occurs from <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">read_exact_at</code> when the read goes past the end of the file. We have been looking into this issue but could not reproduce on our end. Could you help provide some example scripts to help us reproduce and debug the issue?</span> <span class=chatlog__edited-timestamp title="Thursday, October 17, 2024 8:13â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1296573061901979680 class=chatlog__message-container data-message-id=1296573061901979680><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1128892477412229190/6dc7a7826b3683cf41bf45373e68b372.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=luqiu_87609>Lu Qiu</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1296566398977572904')"> Hi <span class="chatlog__markdown-mention" title="smazokha">@Stephan</span> , thanks for reporting the issue! the detailed error message is <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance error: LanceError(Arrow): Io error: failed to fill whole buffer, /src/lance/rust/lance-datafusion/src/utils.rs:41:28&quot;,</code>. This error message typical occurs from <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">read_exact_at</code> when the read goes past the end of the file. We have been looking into this issue but could not reproduce on our end. Could you help provide some example scripts to help us reproduce and debug the issue? </span> <span class=chatlog__reply-edited-timestamp title="Thursday, October 17, 2024 8:13â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author title=smazokha data-user-id=1128892477412229190>Stephan</span> <span class=chatlog__timestamp title="Thursday, October 17, 2024 8:38â€¯PM"><a href=#chatlog__message-container-1296573061901979680>10/17/2024 8:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi Lu! Yes, thanks for getting back to me so quickly. 

I&#39;m trying to import entries into vector DB, and occasionally keep getting this error:

WARNING:urllib3.connectionpool:Retrying (Retry(total=2, connect=3, read=3, redirect=None, status=None)) after connection broken by &#39;SSLEOFError(8, &#39;EOF occurred in violation of protocol (_ssl.c:2426)&#39;)&#39;: /v1/table/paper_embeddings_specter2/insert/?request_id=5d588f2161004526b1b0564edc7cee99&amp;mode=append

What do you need from me to reproduce it? Also, should we continue here, or can you send me a DM to avoid flooding the channel?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1296578644780650627 class=chatlog__message-container data-message-id=1296578644780650627><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/256442550683041793/957261bc8f0ac51195cdaa3270bfc93a.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=etrotta data-user-id=256442550683041793>etrotta</span> <span class=chatlog__timestamp title="Thursday, October 17, 2024 9:00â€¯PM"><a href=#chatlog__message-container-1296578644780650627>10/17/2024 9:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I recommending creating a thread ( <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">+</code> -&gt; Create Thread) instead of moving to DMs, that way the information remains in the server so others can participate and/or find it more easily later</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>2</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1299472524677087243 class=chatlog__message-container data-message-id=1299472524677087243><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jhsieh data-user-id=714506948132864011>jmhsieh</span> <span class=chatlog__timestamp title="Friday, October 25, 2024 8:39â€¯PM"><a href=#chatlog__message-container-1299472524677087243>10/25/2024 8:39â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This is interesting -- I&#39;m trying to do some  table compaction (compact<em>files) operations on independent  lancedb tables concurrently in python using threads.  I keep running into this error in the concurrent version but not in the single threaded iterative version.  Any ideas what could cause this?

```
[2024-10-25 13:32:45,981] WARNING:<em>_main</em></em>(403571): Database not initialized or accessible?  Query Execution error: Execution error: LanceError(Arrow): Compute error: Overflow happened on: 4367151981283354187 - -4930165380070389043, /home/runner/work/lance/lance/rust/lance-io/src/encodings/binary.rs:203:28, /home/runner/work/lance/lance/rust/lance-datafusion/src/chunker.rs:47:46
```</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1299475093642153984 class=chatlog__message-container data-message-id=1299475093642153984><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/714506948132864011/5355113b237b5af897f03717b54d18e4.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=jhsieh>jmhsieh</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1299472524677087243')"> This is interesting -- I&#39;m trying to do some  table compaction (compact<em>files) operations on independent  lancedb tables concurrently in python using threads.  I keep running into this error in the concurrent version but not in the single threaded iterative version.  Any ideas what could cause this?

```
[2024-10-25 13:32:45,981] WARNING:<em>_main</em></em>(403571): Database not initialized or accessible?  Query Execution error: Execution error: LanceError(Arrow): Compute error: Overflow happened on: 4367151981283354187 - -4930165380070389043, /home/runner/work/lance/lance/rust/lance-io/src/encodings/binary.rs:203:28, /home/runner/work/lance/lance/rust/lance-datafusion/src/chunker.rs:47:46
``` </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jhsieh data-user-id=714506948132864011>jmhsieh</span> <span class=chatlog__timestamp title="Friday, October 25, 2024 8:50â€¯PM"><a href=#chatlog__message-container-1299475093642153984>10/25/2024 8:50â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Seems to be happening around the same tables (though running the compaction against these tables serially has no problem).  Is there any way to check to see if tables are good or have corruptions?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1299487512724504632 class=chatlog__message-container data-message-id=1299487512724504632><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, October 25, 2024 9:39â€¯PM"> <a href=#chatlog__message-container-1299487512724504632>10/25/2024 9:39â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1299944099197091891 class=chatlog__message-container data-message-id=1299944099197091891><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/616275815008829450/f627d6350741b9fb75e5fb67c01e29c7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=zhikanbanxiaoshi5111 data-user-id=616275815008829450>hammer</span> <span class=chatlog__timestamp title="Sunday, October 27, 2024 3:53â€¯AM"><a href=#chatlog__message-container-1299944099197091891>10/27/2024 3:53â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Debugger attached.
Waiting for the debugger to disconnect...
node:internal/process/promises:391
    triggerUncaughtException(err, true /* fromPromise */);
    ^

[Error: Hit retry limit for request_id=705393cc-4f91-4903-afbd-ebffd133ee0d (request_failures=0/3, connect_failures=3/3, read_failures=0/3)] {
  code: &#39;GenericFailure&#39;
}

Node.js v20.16.0

Hi team!
 Is this a failure due to my network issues?<img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ¥¹"
    title="ðŸ¥¹"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f979.svg"></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1300522146497302554 class=chatlog__message-container data-message-id=1300522146497302554><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, October 28, 2024 6:10â€¯PM"> <a href=#chatlog__message-container-1300522146497302554>10/28/2024 6:10â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1309197604973707315 class=chatlog__message-container data-message-id=1309197604973707315><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chen3062 data-user-id=738395904008126494>chen</span> <span class=chatlog__timestamp title="Thursday, November 21, 2024 4:43â€¯PM"><a href=#chatlog__message-container-1309197604973707315>11/21/2024 4:43â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, do you know when will I see this error:   Failed to get next batch from stream: lance error: LanceError(IO): Execution error: Query Execution error: Execution error: Not found: mnt/knowledgeBases/59a816fa-cae5-46ac-8daa-14a97648012d/lance/embeddings.lance/data/3a616471-3343-408f-89fb-aa3ba1ecc385.lance, /home/build_user/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-io-0.19.2/src/local.rs:10031, /home/build_user/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-0.19.2/src/io/exec/take.rs:65:42, /home/build_user/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-0.19.2/src/dataset/scanner.rs:2103:83 at WebSocket.&lt;anonymous&gt;  ? I. tried looking for the file /mnt/knowledgeBases/59a816fa-cae5-46ac-8daa-14a97648012d/lance/embeddings.lance/data/3a616471-3343-408f-89fb-aa3ba1ecc385.lance, and it wasnt exist, but why would lance look for a file that doesnt exists?</span> <span class=chatlog__edited-timestamp title="Thursday, November 21, 2024 4:44â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1309210457609076793 class=chatlog__message-container data-message-id=1309210457609076793><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, November 21, 2024 5:34â€¯PM"> <a href=#chatlog__message-container-1309210457609076793>11/21/2024 5:34â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1309282110246355126 class=chatlog__message-container data-message-id=1309282110246355126><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=max_mpc_85836 data-user-id=1301572016809447537>Max</span> <span class=chatlog__timestamp title="Thursday, November 21, 2024 10:19â€¯PM"><a href=#chatlog__message-container-1309282110246355126>11/21/2024 10:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I have a streamlit app up which hits my lancedb-cloud db, has been running for a few days, then suddenly broke. I changed my requirements.txt lancedb version from <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&gt;=0.15.0</code> to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">==0.15.0</code> and now it works again. I see  a new Python LanceDB v0.16.1-beta.0 was just released 23 minutes ago, I think the error/stacktrace I get only with the latest lancedb version might be a bug?

 stacktrace attached. seems to be saying there&#39;s no <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vector_column_name</code> associated with the table (although there is), or associated with the query (a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">query_type=&#39;hybrid&#39;</code> query of that table with a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vector</code> field, which works fine with lancedb 0.15.0)</span></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1309282109751300107/message.txt?ex=698a5d7c&amp;is=69890bfc&amp;hm=32071d5efbbf7e208d1c43459442121957d8f1d40b7b50df23f3389b6b2d515d&amp;"> message.txt </a></div><div class=chatlog__attachment-generic-size>5.9 KB</div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1309282370653786213 class=chatlog__message-container data-message-id=1309282370653786213><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=max_mpc_85836>Max</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1309282110246355126')"> I have a streamlit app up which hits my lancedb-cloud db, has been running for a few days, then suddenly broke. I changed my requirements.txt lancedb version from <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&gt;=0.15.0</code> to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">==0.15.0</code> and now it works again. I see  a new Python LanceDB v0.16.1-beta.0 was just released 23 minutes ago, I think the error/stacktrace I get only with the latest lancedb version might be a bug?

 stacktrace attached. seems to be saying there&#39;s no <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vector_column_name</code> associated with the table (although there is), or associated with the query (a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">query_type=&#39;hybrid&#39;</code> query of that table with a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">vector</code> field, which works fine with lancedb 0.15.0) </span></div></div><div class=chatlog__header><span class=chatlog__author title=max_mpc_85836 data-user-id=1301572016809447537>Max</span> <span class=chatlog__timestamp title="Thursday, November 21, 2024 10:20â€¯PM"><a href=#chatlog__message-container-1309282370653786213>11/21/2024 10:20â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this isn&#39;t anything which is interfering with me, I have no problem staying pinned to lancedb version 0.15.0 for now. just highlighting in case my little streamlit app has identified a bug in the latest beta release...</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1310381340658634873 class=chatlog__message-container data-message-id=1310381340658634873><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/768507481256361984/8ef005790692fab12797b82c5abbd8b6.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=connell__ data-user-id=768507481256361984>connell</span> <span class=chatlog__timestamp title="Sunday, November 24, 2024 11:07â€¯PM"><a href=#chatlog__message-container-1310381340658634873>11/24/2024 11:07â€¯PM</a></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1315652792219734057 class=chatlog__message-container data-message-id=1315652792219734057><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/605834978865184793/598a7a8453df66efee2c202aacdd3c5e.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=fecet data-user-id=605834978865184793>Facet</span> <span class=chatlog__timestamp title="Monday, December 9, 2024 12:14â€¯PM"><a href=#chatlog__message-container-1315652792219734057>12/9/2024 12:14â€¯PM</a></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1316157800069726308 class=chatlog__message-container data-message-id=1316157800069726308><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/768507481256361984/8ef005790692fab12797b82c5abbd8b6.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=connell__ data-user-id=768507481256361984>connell</span> <span class=chatlog__timestamp title="Tuesday, December 10, 2024 9:41â€¯PM"><a href=#chatlog__message-container-1316157800069726308>12/10/2024 9:41â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">TypeError: &#39;numpy.float16&#39; object is not iterable
File &quot;pyarrow/error.pxi&quot;, line 89, in pyarrow.lib.check_status
File &quot;pyarrow/error.pxi&quot;, line 155, in pyarrow.lib.pyarrow_internal_check_status
File &quot;pyarrow/array.pxi&quot;, line 42, in pyarrow.lib._sequence_to_array  
File &quot;pyarrow/array.pxi&quot;, line 370, in pyarrow.lib.array  
^^^^^^^^^^^^^  
return pa.array(vec) 
File &quot;/app/venv/lib/python3.12/site-packages/lancedb/query.py&quot;, line 1590, in _query_vec_to_array  
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
query_vectors = [AsyncQuery._query_vec_to_array(v) for v in query_vector]  
File &quot;/app/venv/lib/python3.12/site-packages/lancedb/query.py&quot;, line 1650, in nearest_to
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
return self.query().nearest_to(query_vector)  
File &quot;/app/venv/lib/python3.12/site-packages/lancedb/table.py&quot;, line 2760, in vector_search
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
query: AsyncQueryBase = table.vector_search(embeddings)
File &quot;/app/lancedb_api/lancedb_api/api/app.py&quot;, line 233, in search
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
return await search(filters, text_blocks_table, embedding_service, request.state.request_id)
File &quot;/app/lancedb_api/lancedb_api/api/app.py&quot;, line 171, in search_text</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1316158011554791475 class=chatlog__message-container data-message-id=1316158011554791475><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/768507481256361984/8ef005790692fab12797b82c5abbd8b6.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/768507481256361984/8ef005790692fab12797b82c5abbd8b6.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=connell__>connell</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1316157800069726308')"> <code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">TypeError: &#39;numpy.float16&#39; object is not iterable
File &quot;pyarrow/error.pxi&quot;, line 89, in pyarrow.lib.check_status
File &quot;pyarrow/error.pxi&quot;, line 155, in pyarrow.lib.pyarrow_internal_check_status
File &quot;pyarrow/array.pxi&quot;, line 42, in pyarrow.lib._sequence_to_array  
File &quot;pyarrow/array.pxi&quot;, line 370, in pyarrow.lib.array  
^^^^^^^^^^^^^  
return pa.array(vec) 
File &quot;/app/venv/lib/python3.12/site-packages/lancedb/query.py&quot;, line 1590, in _query_vec_to_array  
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
query_vectors = [AsyncQuery._query_vec_to_array(v) for v in query_vector]  
File &quot;/app/venv/lib/python3.12/site-packages/lancedb/query.py&quot;, line 1650, in nearest_to
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
return self.query().nearest_to(query_vector)  
File &quot;/app/venv/lib/python3.12/site-packages/lancedb/table.py&quot;, line 2760, in vector_search
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
query: AsyncQueryBase = table.vector_search(embeddings)
File &quot;/app/lancedb_api/lancedb_api/api/app.py&quot;, line 233, in search
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
return await search(filters, text_blocks_table, embedding_service, request.state.request_id)
File &quot;/app/lancedb_api/lancedb_api/api/app.py&quot;, line 171, in search_text</code> </span></div></div><div class=chatlog__header><span class=chatlog__author title=connell__ data-user-id=768507481256361984>connell</span> <span class=chatlog__timestamp title="Tuesday, December 10, 2024 9:42â€¯PM"><a href=#chatlog__message-container-1316158011554791475>12/10/2024 9:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>this happens when I try a async vector search in lancedb 0.17.0</span></div></div></div></div><div id=chatlog__message-container-1316158059982225408 class=chatlog__message-container data-message-id=1316158059982225408><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Tuesday, December 10, 2024 9:42â€¯PM">9:42â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>our embeddings are float16</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1316158233563627600 class=chatlog__message-container data-message-id=1316158233563627600><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=max_mpc_85836 data-user-id=1301572016809447537>Max</span> <span class=chatlog__timestamp title="Tuesday, December 10, 2024 9:42â€¯PM"><a href=#chatlog__message-container-1316158233563627600>12/10/2024 9:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello,

I have some relatively minimal lancedb/python code that runs fine with pypi lancedb 0.15 or 0.16, but in 0.17 (latest on pypi) throws &quot;RemoteTable object has no attribute _loop&quot;. I think it actually finishes writing my data and my FTS index, but I also get this error.

I&#39;m happy to stick to 0.16 for now, just wanted to alert y&#39;all in case it&#39;s helpful</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1316176746810445849 class=chatlog__message-container data-message-id=1316176746810445849><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, December 10, 2024 10:56â€¯PM"> <a href=#chatlog__message-container-1316176746810445849>12/10/2024 10:56â€¯PM</a> </span></div></div></div><div id=chatlog__message-container-1316590767694942263 class=chatlog__message-container data-message-id=1316590767694942263><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, December 12, 2024 2:21â€¯AM"> <a href=#chatlog__message-container-1316590767694942263>12/12/2024 2:21â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1318113563193249802 class=chatlog__message-container data-message-id=1318113563193249802><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=jrish data-user-id=133040796260630529>jrish</span> <span class=chatlog__timestamp title="Monday, December 16, 2024 7:12â€¯AM"><a href=#chatlog__message-container-1318113563193249802>12/16/2024 7:12â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey all,

I am using lancedb (python, v0.17.1b2). I&#39;m trying to use hybrid searchwith a filter on a metadata dict I have stored in my table. It seems as though, when I do my metadata search, I receive the following error:
<div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">Error in step &#39;execute_search_action&#39;: struct fields don&#39;t match or are in the wrong order: Input fields: struct
</div></div>
where it looks like the filter I added is now in the wrong order? Without the filter, the query works totally fine. Any tips to debug?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1318217633614659609 class=chatlog__message-container data-message-id=1318217633614659609><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, December 16, 2024 2:06â€¯PM"> <a href=#chatlog__message-container-1318217633614659609>12/16/2024 2:06â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1320737233149628547 class=chatlog__message-container data-message-id=1320737233149628547><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=frdchang123456 data-user-id=1231994085879844887>Frederick Chang</span> <span class=chatlog__timestamp title="Monday, December 23, 2024 12:58â€¯PM"><a href=#chatlog__message-container-1320737233149628547>12/23/2024 12:58â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>what needs to be optimized when we see this warning?  I observe that not all cores (64) are saturated.  This is for a large lancedb with 500million rows per table.  <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance_io::scheduler] Backpressure throttle is full, I/O will pause until buffer is drained.  Max I/O bandwidth will not be achieved because CPU is falling behind</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1320818290658115659 class=chatlog__message-container data-message-id=1320818290658115659><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, December 23, 2024 6:20â€¯PM"> <a href=#chatlog__message-container-1320818290658115659>12/23/2024 6:20â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1322945044378030090 class=chatlog__message-container data-message-id=1322945044378030090><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chen3062 data-user-id=738395904008126494>chen</span> <span class=chatlog__timestamp title="Sunday, December 29, 2024 3:11â€¯PM"><a href=#chatlog__message-container-1322945044378030090>12/29/2024 3:11â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, I get this error when trying to use table.optimize ( JavaScript package ) :  Error: lance error: LanceError(Index): token 31680901 not found, /home/build_user/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-index-0.19.2/src/scalar/inverted/builder.rs:658:43  Caused by: LanceError(Index): token 31680901 not found, /home/build_user/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-index-0.19.2/src/scalar/inverted/builder.rs:658:43. It started happening after I created an FTS index on the table. ( the token id is always the same ) I think it happens when  deleteUnverified is true</span> <span class=chatlog__edited-timestamp title="Sunday, December 29, 2024 5:19â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1323324988073443352 class=chatlog__message-container data-message-id=1323324988073443352><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=yah2er0ne data-user-id=963889951810941039>Yang</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, December 30, 2024 4:21â€¯PM"> <a href=#chatlog__message-container-1323324988073443352>12/30/2024 4:21â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1324659090235854870 class=chatlog__message-container data-message-id=1324659090235854870><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/139104290475081728/579e4783f73cb50d9a35a2839037274a.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=industrial data-user-id=139104290475081728>Industrial</span> <span class=chatlog__timestamp title="Friday, January 3, 2025 8:42â€¯AM"><a href=#chatlog__message-container-1324659090235854870>1/3/2025 8:42â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi. When installing <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">@lancedb/lancedb</code> I get <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">error: @lancedb/lancedb-win32-arm64-msvc@0.14.1 failed to resolve</code>. I already installed <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">&quot;@lancedb/lancedb-linux-x64-gnu&quot;: &quot;^0.14.1&quot;</code> but it&#39;s still trying to pick win32-arm64. What do I do?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1324722226439651372 class=chatlog__message-container data-message-id=1324722226439651372><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, January 3, 2025 12:53â€¯PM"> <a href=#chatlog__message-container-1324722226439651372>1/3/2025 12:53â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1325953632163729410 class=chatlog__message-container data-message-id=1325953632163729410><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chen3062 data-user-id=738395904008126494>chen</span> <span class=chatlog__timestamp title="Monday, January 6, 2025 10:26â€¯PM"><a href=#chatlog__message-container-1325953632163729410>1/6/2025 10:26â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, I wwhen I try to do a full text search I get a negstive score ( and no matter the question I get the same chunks), is there a configuration I am missing?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1326222641048322152 class=chatlog__message-container data-message-id=1326222641048322152><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=jrish data-user-id=133040796260630529>jrish</span> <span class=chatlog__timestamp title="Tuesday, January 7, 2025 4:15â€¯PM"><a href=#chatlog__message-container-1326222641048322152>1/7/2025 4:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi all, when installing the latest version of lance (0.17.1), looks like I get the following error:
<div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">uv add lancedb==0.17.1                                                                                î‚² âœ” î‚² base Py 
  &#215; No solution found when resolving dependencies for split (platform_machine == &#39;x86_64&#39; and sys_platform == &#39;darwin&#39; and python_full_version &gt;= &#39;3.12&#39;):
  â•°â”€â–¶ Because there is no version of pylance==0.21.0b5 and lancedb==0.17.1 depends on pylance==0.21.0b5, we can conclude that lancedb==0.17.1 cannot be used.
      And because your project depends on lancedb==0.17.1, we can conclude that your project&#39;s requirements are unsatisfiable.</div></div></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1326233216415432785 class=chatlog__message-container data-message-id=1326233216415432785><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, January 7, 2025 4:57â€¯PM"> <a href=#chatlog__message-container-1326233216415432785>1/7/2025 4:57â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1326676270851031161 class=chatlog__message-container data-message-id=1326676270851031161><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/679376449320517663/f10a90cc294fa24cac84d663bdb21d33.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=iterrad3140 data-user-id=679376449320517663>talkasab</span> <span class=chatlog__timestamp title="Wednesday, January 8, 2025 10:17â€¯PM"><a href=#chatlog__message-container-1326676270851031161>1/8/2025 10:17â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Was trying to create a new FTS index on my cloud table...
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">HttpError: Http error: (request_id=b001695d-cfed-4a63-af38-eca37e34e8d3) 400 Bad Request: Index limit of 3 exceeded for table 84cbd20617e34ce9931f1500b1ff7d66. Please contact contact@lancedb.com for assistance.</code>
What&#39;s this about? There aren&#39;t three indices on this table, only the one on the vector field.</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1326676270607765564/470fe9cf-7abe-4bc1-830e-d6af6e0f8384-spark-clipboard.png?ex=698a5d0f&amp;is=69890b8f&amp;hm=4c9534a233644dee340497d4ab9441817947e87a750d4fa04f2289f25fdb7ce1&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1326676270607765564/470fe9cf-7abe-4bc1-830e-d6af6e0f8384-spark-clipboard.png?ex=698a5d0f&amp;is=69890b8f&amp;hm=4c9534a233644dee340497d4ab9441817947e87a750d4fa04f2289f25fdb7ce1&amp;" alt="Image attachment" title="Image: 470fe9cf-7abe-4bc1-830e-d6af6e0f8384-spark-clipboard.png (102.63 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1326676425175990394 class=chatlog__message-container data-message-id=1326676425175990394><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/679376449320517663/f10a90cc294fa24cac84d663bdb21d33.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/679376449320517663/f10a90cc294fa24cac84d663bdb21d33.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=iterrad3140>talkasab</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1326676270851031161')"> Was trying to create a new FTS index on my cloud table...
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">HttpError: Http error: (request_id=b001695d-cfed-4a63-af38-eca37e34e8d3) 400 Bad Request: Index limit of 3 exceeded for table 84cbd20617e34ce9931f1500b1ff7d66. Please contact contact@lancedb.com for assistance.</code>
What&#39;s this about? There aren&#39;t three indices on this table, only the one on the vector field. </span></div></div><div class=chatlog__header><span class=chatlog__author title=iterrad3140 data-user-id=679376449320517663>talkasab</span> <span class=chatlog__timestamp title="Wednesday, January 8, 2025 10:18â€¯PM"><a href=#chatlog__message-container-1326676425175990394>1/8/2025 10:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>FYI, sent an email to contact@lancedb.com as requested.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1326704621346881592 class=chatlog__message-container data-message-id=1326704621346881592><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, January 9, 2025 12:10â€¯AM"> <a href=#chatlog__message-container-1326704621346881592>1/9/2025 12:10â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1328507832965795962 class=chatlog__message-container data-message-id=1328507832965795962><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=vkullu data-user-id=1013849127555182612>vkullu</span> <span class=chatlog__timestamp title="Monday, January 13, 2025 11:35â€¯PM"><a href=#chatlog__message-container-1328507832965795962>1/13/2025 11:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>The food recoemmendation example does not work:

<a href="https://colab.research.google.com/github/lancedb/vectordb-recipes/blob/main/examples/archived_examples/Food_recommendation/main.ipynb#scrollTo=lc_yomsw_DRp">https://colab.research.google.com/github/lancedb/vectordb-recipes/blob/main/examples/archived_examples/Food_recommendation/main.ipynb#scrollTo=lc_yomsw_DRp</a></span></div><div class=chatlog__embed><div class="chatlog__embed-color-pill chatlog__embed-color-pill--default"></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://colab.research.google.com/github/lancedb/vectordb-recipes/blob/main/examples/archived_examples/Food_recommendation/main.ipynb><div class="chatlog__markdown chatlog__markdown-preserve">Google Colab</div></a></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/_K27snML6r0M3SI7nsBI0ZQHiyOFMrKc_HQm1RpU95o/https/colab.research.google.com/img/colab_favicon_256px.png> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/_K27snML6r0M3SI7nsBI0ZQHiyOFMrKc_HQm1RpU95o/https/colab.research.google.com/img/colab_favicon_256px.png alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div><div id=chatlog__message-container-1328508005922115747 class=chatlog__message-container data-message-id=1328508005922115747><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, January 13, 2025 11:36â€¯PM">11:36â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I get the error:
ArrowTypeError: (&#39;Expected a string or bytes dtype, got float64&#39;, &#39;Conversion failed for column Food_ID with type float64&#39;)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1328510764214124595 class=chatlog__message-container data-message-id=1328510764214124595><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=vkullu data-user-id=1013849127555182612>vkullu</span> <span class=chatlog__timestamp title="Monday, January 13, 2025 11:47â€¯PM"><a href=#chatlog__message-container-1328510764214124595>1/13/2025 11:47â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Is the expectation this notebook works? I installed a few dependecies it broke over (sentence transformers, tantiby etc. but it keeps giving new errors.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1328512184656855141 class=chatlog__message-container data-message-id=1328512184656855141><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, January 13, 2025 11:53â€¯PM"> <a href=#chatlog__message-container-1328512184656855141>1/13/2025 11:53â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1329564857527308409 class=chatlog__message-container data-message-id=1329564857527308409><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=jrish data-user-id=133040796260630529>jrish</span> <span class=chatlog__timestamp title="Thursday, January 16, 2025 9:36â€¯PM"><a href=#chatlog__message-container-1329564857527308409>1/16/2025 9:36â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey all,

We randomly see the following when creating a FTS index - any idea why or how to debug? This is in prod so volume is fairly high
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">2025-01-16 10:11:44.332    
pyo3_async_runtimes.RustPanic: rust future panicked: unknown error
2025-01-16 10:11:44.332    
    raise self._exception.with_traceback(self._exception_tb)
2025-01-16 10:11:44.332    
  File &quot;/usr/local/lib/python3.12/asyncio/futures.py&quot;, line 202, in result
2025-01-16 10:11:44.332    
    future.result()
2025-01-16 10:11:44.332    
  File &quot;/usr/local/lib/python3.12/asyncio/tasks.py&quot;, line 385, in __wakeup
2025-01-16 10:11:44.332    
    ^^^^^^^^^^
2025-01-16 10:11:44.332    
    yield self  # This tells Task to wait for completion.
2025-01-16 10:11:44.332    
  File &quot;/usr/local/lib/python3.12/asyncio/futures.py&quot;, line 289, in __await__
2025-01-16 10:11:44.332    
    await self._inner.create_index(column, index=index, replace=replace)
2025-01-16 10:11:44.331    
  File &quot;/app/.venv/lib/python3.12/site-packages/lancedb/table.py&quot;, line 2641, in create_index
2025-01-16 10:11:44.331    
    await self.table.create_index(
2025-01-16 10:11:44.331    
  File &quot;/app/src/utils/async_lance_db_vector_store.py&quot;, line 222, in async_add</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1329577648573255768 class=chatlog__message-container data-message-id=1329577648573255768><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, January 16, 2025 10:26â€¯PM"> <a href=#chatlog__message-container-1329577648573255768>1/16/2025 10:26â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1331617146651803678 class=chatlog__message-container data-message-id=1331617146651803678><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/340937930098999296/4ba4b99c084f9114d3f67f6c53c799e7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=nekowaii data-user-id=340937930098999296>nekowaii</span> <span class=chatlog__timestamp title="Wednesday, January 22, 2025 1:31â€¯PM"><a href=#chatlog__message-container-1331617146651803678>1/22/2025 1:31â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi everyone, it seems the merge insert operation is broken with LanceDB 0.18.0 (Lance 0.22.0) in Python. If I revert to LanceDB 0.17.0, everything works fine.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1339332814729908244 class=chatlog__message-container data-message-id=1339332814729908244><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=ozb7067 data-user-id=1252344492762206249>Oz</span> <span class=chatlog__timestamp title="Wednesday, February 12, 2025 8:30â€¯PM"><a href=#chatlog__message-container-1339332814729908244>2/12/2025 8:30â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Looks like since Python  lancedb==0.18.0, we&#39;re alphabetizing struct fields, causing errors; in 0.17.0, there was no error even if the order wasn&#39;t the same</span></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1339332814252019884/log?ex=698a43e2&amp;is=6988f262&amp;hm=f8506e8409f06e9773fc1d8a1334c29a977cf640adb54fab401a334160f1b120&amp;"> log </a></div><div class=chatlog__attachment-generic-size>3 KB</div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1344212067682619462 class=chatlog__message-container data-message-id=1344212067682619462><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=echolynn0528 data-user-id=1326954207277879418>echolynn</span> <span class=chatlog__timestamp title="Wednesday, February 26, 2025 7:38â€¯AM"><a href=#chatlog__message-container-1344212067682619462>2/26/2025 7:38â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I am trying to insert a batch of data (a total of 114 entries) into a LanceDB table. Each entry includes text, an image path, and metadata. However, despite inserting all the data in batches, the table only shows 10 records instead of the expected 114 records.Each insertion operation appears successful, but the table only contains 10 records.
I have verified the integrity of the input data and the generation of embeddings, and found no issues.</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1344212067472769095/image.png?ex=698a37cb&amp;is=6988e64b&amp;hm=fa09215334184acf511d614829e761f9e28df2e021bdd660302d2bdd20fa97b9&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1344212067472769095/image.png?ex=698a37cb&amp;is=6988e64b&amp;hm=fa09215334184acf511d614829e761f9e28df2e021bdd660302d2bdd20fa97b9&amp;" alt="Image attachment" title="Image: image.png (35.31 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1344349453011648620 class=chatlog__message-container data-message-id=1344349453011648620><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, February 26, 2025 4:44â€¯PM"> <a href=#chatlog__message-container-1344349453011648620>2/26/2025 4:44â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1344448853163774002 class=chatlog__message-container data-message-id=1344448853163774002><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/188480232964096000/63c27880ab8e52a8b04f2b935a2c2a3d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=michael.su data-user-id=188480232964096000>msu</span> <span class=chatlog__timestamp title="Wednesday, February 26, 2025 11:19â€¯PM"><a href=#chatlog__message-container-1344448853163774002>2/26/2025 11:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>It&#39;s trying to use a multimodal embedder for voyageai in lancedb when I pass it text. It errors on the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.add</code>. I think image looks for str which makes sense but also text should look for str as well.

here&#39;s code:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">vo_embed = get_registry().get(&quot;voyageai&quot;).create(name=&quot;voyage-3&quot;)

class PersonModel(LanceModel):
    name: str = vo_embed.SourceField()
    age: int
    vector: Vector(dim=vo_embed.ndims()) = vo_embed.VectorField()  # type: ignore

db = lancedb.connect(&quot;/tmp/db&quot;)
# db.drop_table(&quot;person&quot;)
table = (
    db.create_table(&quot;person&quot;, schema=PersonModel)
    if &quot;person&quot; not in db.table_names()
    else db.open_table(&quot;person&quot;)
)


print(table.schema.metadata)
print(table.embedding_functions)
table.add(
    [
        {&quot;name&quot;: &quot;bob&quot;, &quot;age&quot;: 1},
        {&quot;name&quot;: &quot;alice&quot;, &quot;age&quot;: 2},
    ]
)</code>

here&#39;s my logs
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">{b&#39;embedding_functions&#39;: b&#39;[\n  {\n    &quot;name&quot;: &quot;voyageai&quot;,\n    &quot;model&quot;: {\n      &quot;max_retries&quot;: 7,\n      &quot;name&quot;: &quot;voyage-3&quot;,\n      &quot;text_embedding_models&quot;: [\n        &quot;voyage-3&quot;,\n        &quot;voyage-3-lite&quot;,\n        &quot;voyage-finance-2&quot;,\n        &quot;voyage-law-2&quot;,\n        &quot;voyage-code-2&quot;\n      ],\n      &quot;multimodal_embedding_models&quot;: [\n        &quot;voyage-multimodal-3&quot;\n      ]\n    },\n    &quot;source_column&quot;: &quot;name&quot;,\n    &quot;vector_column&quot;: &quot;vector&quot;\n  }\n]&#39;}
{&#39;vector&#39;: EmbeddingFunctionConfig(vector_column=&#39;vector&#39;, source_column=&#39;name&#39;, function=VoyageAIEmbeddingFunction(max_retries=7, name=&#39;voyage-3&#39;, text_embedding_models=[&#39;voyage-3&#39;, &#39;voyage-3-lite&#39;, &#39;voyage-finance-2&#39;, &#39;voyage-law-2&#39;, &#39;voyage-code-2&#39;], multimodal_embedding_models=[&#39;voyage-multimodal-3&#39;]))}
WARNING:root:Error occurred: Model voyage-3 is not supported. Supported models are [&#39;voyage-multimodal-3&#39;, &#39;voyage-multimodal-3-l4&#39;]. 
 Retrying in 2.3743381460127555 seconds (retry 1 of 7) 

WARNING:root:Error occurred: Model voyage-3 is not supported. Supported models are [&#39;voyage-multimodal-3&#39;, &#39;voyage-multimodal-3-l4&#39;]. </code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1346845053997547564 class=chatlog__message-container data-message-id=1346845053997547564><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/704889332057505843/b630eed2f00dd26d74996af9e8f297db.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=enjalot data-user-id=704889332057505843>enjalot</span> <span class=chatlog__timestamp title="Wednesday, March 5, 2025 2:01â€¯PM"><a href=#chatlog__message-container-1346845053997547564>3/5/2025 2:01â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I tried to create an index on a list column like <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">table.create_scalar_index(&quot;sae_indices&quot;, index_type=&quot;LABEL_LIST&quot;)</code>
which worked fine on a smaller version of my database, but for full 25million rows I got a rust future panicked:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">Creating index for sae_indices on table &#39;500-64_32&#39;
thread &#39;tokio-runtime-worker&#39; panicked at /root/.cargo/registry/src/index.crates.io-6f17d22bba15001f/arrow-array-53.4.0/src/builder/generic_bytes_builder.rs:86:57:
byte array offset overflow
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
Traceback (most recent call last):
  File &quot;/pkg/modal/_runtime/container_io_manager.py&quot;, line 728, in handle_input_exception
    yield
  File &quot;/pkg/modal/_container_entrypoint.py&quot;, line 240, in run_input_sync
    res = io_context.call_finalized_function()
  File &quot;/pkg/modal/_runtime/container_io_manager.py&quot;, line 180, in call_finalized_function
    res = self.finalized_function.callable(*args, **kwargs)
  File &quot;/root/lancer.py&quot;, line 193, in create_indices
    table.create_scalar_index(&quot;sae_indices&quot;, index_type=&quot;LABEL_LIST&quot;)
  File &quot;/usr/local/lib/python3.10/site-packages/lancedb/table.py&quot;, line 1663, in create_scalar_index
    return LOOP.run(
  File &quot;/usr/local/lib/python3.10/site-packages/lancedb/background_loop.py&quot;, line 25, in run
    return asyncio.run_coroutine_threadsafe(future, self.loop).result()
  File &quot;/usr/local/lib/python3.10/concurrent/futures/_base.py&quot;, line 458, in result
    return self.__get_result()
  File &quot;/usr/local/lib/python3.10/concurrent/futures/_base.py&quot;, line 403, in __get_result
    raise self._exception
  File &quot;/usr/local/lib/python3.10/site-packages/lancedb/table.py&quot;, line 2815, in create_index
    await self._inner.create_index(column, index=config, replace=replace)
pyo3_async_runtimes.RustPanic: rust future panicked: unknown error</code></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1346863316059947085 class=chatlog__message-container data-message-id=1346863316059947085><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=weston_lance data-user-id=1272662049112981506>weston_lance</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, March 5, 2025 3:13â€¯PM"> <a href=#chatlog__message-container-1346863316059947085>3/5/2025 3:13â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1352543389517877279 class=chatlog__message-container data-message-id=1352543389517877279><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1240240746443833371/1664b7b909694e851b1ef4027ae91099.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kingtongchoo data-user-id=1240240746443833371>kingchoo</span> <span class=chatlog__timestamp title="Friday, March 21, 2025 7:24â€¯AM"><a href=#chatlog__message-container-1352543389517877279>3/21/2025 7:24â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello - I&#39;ve recently created a new lancedb cloud account and was testing with migrating some data over. You can see that there are 7067 rows, but I can&#39;t seem to see it on the GUI</span> <span class=chatlog__edited-timestamp title="Friday, March 21, 2025 7:25â€¯AM">(edited)</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1352543389312094208/Screenshot_2025-03-21_at_07.23.32.png?ex=698a3471&amp;is=6988e2f1&amp;hm=4fbea4255f66d992b506f737830b65ed92e7beae042c0df5ce1170f5fa4b0e4d&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1352543389312094208/Screenshot_2025-03-21_at_07.23.32.png?ex=698a3471&amp;is=6988e2f1&amp;hm=4fbea4255f66d992b506f737830b65ed92e7beae042c0df5ce1170f5fa4b0e4d&amp;" alt="Image attachment" title="Image: Screenshot_2025-03-21_at_07.23.32.png (38.06 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1352641813671841869 class=chatlog__message-container data-message-id=1352641813671841869><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, March 21, 2025 1:55â€¯PM"><a href=#chatlog__message-container-1352641813671841869>3/21/2025 1:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks for the report - do you see any errors in the browser console?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1352647830732542002 class=chatlog__message-container data-message-id=1352647830732542002><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1240240746443833371/1664b7b909694e851b1ef4027ae91099.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kingtongchoo data-user-id=1240240746443833371>kingchoo</span> <span class=chatlog__timestamp title="Friday, March 21, 2025 2:19â€¯PM"><a href=#chatlog__message-container-1352647830732542002>3/21/2025 2:19â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span> 

&quot;Access to fetch at &#39;...&#39; from origin &#39;<a href="https://cloud.lancedb.com">https://cloud.lancedb.com</a>&#39; has been blocked by CORS policy: No &#39;Access-Control-Allow-Origin&#39; header is present on the requested resource. If an opaque response serves your needs, set the request&#39;s mode to &#39;no-cors&#39; to fetch the resource with CORS disabled.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1352651814868357211 class=chatlog__message-container data-message-id=1352651814868357211><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, March 21, 2025 2:35â€¯PM"><a href=#chatlog__message-container-1352651814868357211>3/21/2025 2:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ah ok thatâ€™s not related. Anyways we found the issue and a fix is in PR review already. Thanks for reporting the bug!</span> <span class=chatlog__edited-timestamp title="Friday, March 21, 2025 2:35â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1352663717799657493 class=chatlog__message-container data-message-id=1352663717799657493><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span class=chatlog__timestamp title="Friday, March 21, 2025 3:22â€¯PM"><a href=#chatlog__message-container-1352663717799657493>3/21/2025 3:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="kingtongchoo">@kingchoo</span> fix is pushed to prod lmk if itâ€™s working for you</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1352695463845040249 class=chatlog__message-container data-message-id=1352695463845040249><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1240240746443833371/1664b7b909694e851b1ef4027ae91099.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kingtongchoo data-user-id=1240240746443833371>kingchoo</span> <span class=chatlog__timestamp title="Friday, March 21, 2025 5:28â€¯PM"><a href=#chatlog__message-container-1352695463845040249>3/21/2025 5:28â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Speedy ! Works well, thank you <span class="chatlog__markdown-mention" title="changkhiskhan">@changhiskhan</span>, very happy to have migrated</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=partying_face><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ¥³ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f973.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div><div class=chatlog__reaction title=ðŸ«¡><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ«¡ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1fae1.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1353085348271358002 class=chatlog__message-container data-message-id=1353085348271358002><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/768507481256361984/8ef005790692fab12797b82c5abbd8b6.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=connell__ data-user-id=768507481256361984>connell</span> <span class=chatlog__timestamp title="Saturday, March 22, 2025 7:18â€¯PM"><a href=#chatlog__message-container-1353085348271358002>3/22/2025 7:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Ran optimize and this happened , sync client version 0.21.1:

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">RuntimeError: lance error: LanceError(IO): Generic S3 error: Got invalid DeleteObjects response: unknown variant `Code`, expected `Deleted` or `Error`, /root/.cargo/registry/src/index.crates.io-6f17d22bba15001f/futures-util-0.3.31/src/fns.rs:368:13</code>
This only happens on my table with 167M rows. It messes up data enough that I need to restore a previous version, rebuild my scalar indexes or even copy the table to a new one. I&#39;ll follow up here after I&#39;m able to reproduce it on a backup table with backtrace on. Another interesting thing is I can&#39;t find the s3 cloudtrail log there are not &quot;eventName&quot; = &quot;DeleteObject&quot; records.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1353130024332431370 class=chatlog__message-container data-message-id=1353130024332431370><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Saturday, March 22, 2025 10:15â€¯PM"><a href=#chatlog__message-container-1353130024332431370>3/22/2025 10:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>That&#39;s pretty strange.  Seems like a mangled S3 response.  Do you see events for <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">DeleteObjects</code> (plural)?  object_store uses the bulk request described here: <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteObjects.html">https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteObjects.html</a></span></div><div class=chatlog__embed><div class="chatlog__embed-color-pill chatlog__embed-color-pill--default"></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteObjects.html><div class="chatlog__markdown chatlog__markdown-preserve">DeleteObjects - Amazon Simple Storage Service</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">This operation enables you to delete multiple objects from a bucket using a single HTTP request. If you know the object keys that you want to delete, then this operation provides a suitable alternative to sending individual delete requests, reducing per-request overhead.</div></div></div></div></div></div></div></div></div><div id=chatlog__message-container-1353130764769820734 class=chatlog__message-container data-message-id=1353130764769820734><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Saturday, March 22, 2025 10:18â€¯PM">10:18â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>This seems related but doesn&#39;t have much more info <img
    loading="lazy"
    class="chatlog__emoji "
    alt="ðŸ˜¦"
    title="frowning"
    src="https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f626.svg"> <a href="https://github.com/apache/arrow-rs-object-store/issues/277">https://github.com/apache/arrow-rs-object-store/issues/277</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/apache/arrow-rs-object-store/issues/277><div class="chatlog__markdown chatlog__markdown-preserve">Object store failing during bulk delete in S3 &#183; Issue #277 &#183; apache...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Describe the bug This started recently and I&#39;m uncertain as to the cause. I have a rather large S3 directory (10TB) that I delete using the following code: let object_store_s3_path = &amp;objec...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/PaLJUF4VP_DjdNC9aYYUQ3mmpDO5VVujmIYMC3ZfZZI/https/opengraph.githubassets.com/586d48c4bf384d495c22dc24a5c788a140979b8b662463e4b86bc4ebacd9deb1/apache/arrow-rs-object-store/issues/277> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/PaLJUF4VP_DjdNC9aYYUQ3mmpDO5VVujmIYMC3ZfZZI/https/opengraph.githubassets.com/586d48c4bf384d495c22dc24a5c788a140979b8b662463e4b86bc4ebacd9deb1/apache/arrow-rs-object-store/issues/277 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1353435317990068285 class=chatlog__message-container data-message-id=1353435317990068285><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/768507481256361984/8ef005790692fab12797b82c5abbd8b6.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wpace>WestonPace</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1353130024332431370')"> That&#39;s pretty strange.  Seems like a mangled S3 response.  Do you see events for <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">DeleteObjects</code> (plural)?  object_store uses the bulk request described here: <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteObjects.html">https://docs.aws.amazon.com/AmazonS3/latest/API/API_DeleteObjects.html</a> </span></div></div><div class=chatlog__header><span class=chatlog__author title=connell__ data-user-id=768507481256361984>connell</span> <span class=chatlog__timestamp title="Sunday, March 23, 2025 6:28â€¯PM"><a href=#chatlog__message-container-1353435317990068285>3/23/2025 6:28â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I found it in the cloudtrail logs:
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">errorCode: SlowDown
errorMessage: Please reduce your request rate.
eventCategory: Data</code>
Can you point me in the direction of s3 bindings in Lance?</span> <span class=chatlog__edited-timestamp title="Sunday, March 23, 2025 6:29â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1353460325571104823 class=chatlog__message-container data-message-id=1353460325571104823><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=lei.xu data-user-id=1001739727197700146>lei</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Sunday, March 23, 2025 8:08â€¯PM"> <a href=#chatlog__message-container-1353460325571104823>3/23/2025 8:08â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1353707180808732712 class=chatlog__message-container data-message-id=1353707180808732712><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1240240746443833371/1664b7b909694e851b1ef4027ae91099.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kingtongchoo data-user-id=1240240746443833371>kingchoo</span> <span class=chatlog__timestamp title="Monday, March 24, 2025 12:29â€¯PM"><a href=#chatlog__message-container-1353707180808732712>3/24/2025 12:29â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m currently trying to use the .merge_inesrt operation to update my lancedb table and hitting this error &quot;HttpError: Http error: (request_id=...) 500 Internal Server Error: Internal server error&quot; 

Any ideas why? 

Context: I took my table on lancedb, selected some columns, updated 2 columns, now trying to run .merge_insert but hitting that error</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1353801741254131810 class=chatlog__message-container data-message-id=1353801741254131810><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=luqiu_87609 data-user-id=1209390552148090902>Lu Qiu</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, March 24, 2025 6:44â€¯PM"> <a href=#chatlog__message-container-1353801741254131810>3/24/2025 6:44â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1354136300466343956 class=chatlog__message-container data-message-id=1354136300466343956><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=ozb7067 data-user-id=1252344492762206249>Oz</span> <span class=chatlog__timestamp title="Tuesday, March 25, 2025 4:54â€¯PM"><a href=#chatlog__message-container-1354136300466343956>3/25/2025 4:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Not sure if I&#39;m doing something wrong, or whether this is support to work at all, but any help would be appreciated</span></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1354136299614896242/datafusion-test2.log?ex=698a1134&amp;is=6988bfb4&amp;hm=3c2b792a1cd71240afe5c4be4fad24aee0da05d2c12e8d5638b481856d1f8a0d&amp;"> datafusion-test2.log </a></div><div class=chatlog__attachment-generic-size>663 bytes</div></div></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1354136300013228082/datafusion-test2.py?ex=698a1134&amp;is=6988bfb4&amp;hm=84b408cff0060e7fb211e7080bf222428f9d1c6b10415f9676a204f043af92d9&amp;"> datafusion-test2.py </a></div><div class=chatlog__attachment-generic-size>474 bytes</div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1354175833127780529 class=chatlog__message-container data-message-id=1354175833127780529><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, March 25, 2025 7:31â€¯PM"> <a href=#chatlog__message-container-1354175833127780529>3/25/2025 7:31â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1355951207428132934 class=chatlog__message-container data-message-id=1355951207428132934><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=renato2099_ data-user-id=1197089946683584522>R2099</span> <span class=chatlog__timestamp title="Sunday, March 30, 2025 5:06â€¯PM"><a href=#chatlog__message-container-1355951207428132934>3/30/2025 5:06â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi all, I am trying to create a foreign table provider , but I am a bit stuck , I might be missing something very basic</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1355959397846749220 class=chatlog__message-container data-message-id=1355959397846749220><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=renato2099_ data-user-id=1197089946683584522>R2099</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Sunday, March 30, 2025 5:38â€¯PM"> <a href=#chatlog__message-container-1355959397846749220>3/30/2025 5:38â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1356363071433740388 class=chatlog__message-container data-message-id=1356363071433740388><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=ozb7067 data-user-id=1252344492762206249>Oz</span> <span class=chatlog__timestamp title="Monday, March 31, 2025 8:22â€¯PM"><a href=#chatlog__message-container-1356363071433740388>3/31/2025 8:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hello all! I seem to be getting strange behavior on Python lance==0.25.2 (plus at least one old version):

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">import pyarrow as pa
import pytest
import os
import tempfile
import pandas as pd


def test_merge_empty_table_with_index():
    &quot;&quot;&quot;Test merge_insert on an empty table with an index&quot;&quot;&quot;
    
    # Create an empty dataset with an id column
    empty_table = pa.table({&quot;id&quot;: pa.array([], type=pa.float64())})
    
    with tempfile.TemporaryDirectory() as tmpdir:
        path = os.path.join(tmpdir, &quot;empty_dataset_with_index&quot;)
        empty_ds = lance.write_dataset(empty_table, path)
        
        empty_ds.create_scalar_index(&quot;id&quot;, &quot;BTREE&quot;)
        
        # Create data to merge
        df = pa.table({&quot;id&quot;: [1.0, 2.0, 3.0]})
        
        empty_ds.merge_insert(&quot;id&quot;)\
            .when_not_matched_insert_all()\
            .execute(df)

def test_merge_insert_empty_index():
    &quot;&quot;&quot;Test merge_insert on an empty table with an index&quot;&quot;&quot;

    # Create an empty dataset with an id column
    table = pa.table({&quot;id&quot;: pa.array([], type=pa.float64())})
    df_empty = pd.DataFrame({&quot;id&quot;: []})
    df = pd.DataFrame({&quot;id&quot;: [1.0, 2.0, 3.0]})

    with tempfile.TemporaryDirectory() as tmpdir:
        path = os.path.join(tmpdir, &quot;empty_dataset_with_index&quot;)
        ds = lance.write_dataset(df, path)

        ds.create_scalar_index(&quot;id&quot;, &quot;BTREE&quot;)
        # df = pa.table({&quot;id&quot;: [1.0, 2.0, 3.0]})
        # ds.insert(df)
        # df = pa.table({&quot;id&quot;: [3.0, 5.0, 6.0]})
        ds.merge_insert(&quot;id&quot;)\
            .when_not_matched_insert_all()\
            .when_matched_update_all()\
            .execute(df)

        assert len(ds.list_indices()) == 1</code></span> <span class=chatlog__edited-timestamp title="Monday, March 31, 2025 8:26â€¯PM">(edited)</span></div><div class=chatlog__attachment><div class=chatlog__attachment-generic><svg class=chatlog__attachment-generic-icon><use href=#attachment-icon /></svg><div class=chatlog__attachment-generic-name><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1356363070871699586/lance-pytest.log?ex=698a420c&amp;is=6988f08c&amp;hm=04fa75d5a7df7200c30dec4970873ddfdc1c16d3648f99311ab1ccd633517a3d&amp;"> lance-pytest.log </a></div><div class=chatlog__attachment-generic-size>4.49 KB</div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=eyes><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘€ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f440.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1356378948296249366 class=chatlog__message-container data-message-id=1356378948296249366><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, March 31, 2025 9:25â€¯PM"> <a href=#chatlog__message-container-1356378948296249366>3/31/2025 9:25â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1357046574017941515 class=chatlog__message-container data-message-id=1357046574017941515><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=henry_66121 data-user-id=1353076663771988039>Henry</span> <span class=chatlog__timestamp title="Wednesday, April 2, 2025 5:38â€¯PM"><a href=#chatlog__message-container-1357046574017941515>4/2/2025 5:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi folks, does anyone happen to know what this error is? I&#39;m writing a Ray dataset to Lance
<div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">  File &quot;/miniforge/envs/iris/lib/python3.10/site-packages/ray/data/<em>internal/execution/operators/map<em>transformer.py&quot;, line 351, in __call</em></em>
    yield from self._block_fn(input, ctx)
  File &quot;/miniforge/envs/iris/lib/python3.10/site-packages/ray/data/_internal/planner/plan_write_op.py&quot;, line 45, in fn
    ctx.kwargs[&quot;_datasink_write_return&quot;] = datasink_or_legacy_datasource.write(
  File &quot;/miniforge/envs/iris/lib/python3.10/site-packages/ray/data/_internal/datasource/lance_datasink.py&quot;, line 222, in write
    fragments_and_schema = _write_fragment(
  File &quot;/miniforge/envs/iris/lib/python3.10/site-packages/ray/data/_internal/datasource/lance_datasink.py&quot;, line 62, in _write_fragment
    fragments = write_fragments(
  File &quot;/miniforge/envs/iris/lib/python3.10/site-packages/lance/fragment.py&quot;, line 814, in write_fragments
    return function(
OSError: LanceError(Arrow): Arrow error: C Data interface error: The datatype &quot;List(Field { name: &quot;item&quot;, data_type: Utf8, nullable: true, dict_id: 0, dict_is_ordered: false, metadata: {} })&quot; expects 2 buffers, but requested 2. Please verify that the C data interface is correctly implemented., /home/runner/work/lance/lance/rust/lance-datafusion/src/utils.rs:57:31</div></div></span> <span class=chatlog__edited-timestamp title="Wednesday, April 2, 2025 5:39â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1357393865593585684 class=chatlog__message-container data-message-id=1357393865593585684><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/0.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=henry_66121 data-user-id=1353076663771988039>Henry</span> <span class=chatlog__timestamp title="Thursday, April 3, 2025 4:38â€¯PM"><a href=#chatlog__message-container-1357393865593585684>4/3/2025 4:38â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi folks, I&#39;m trying to build an index of about 865M rows. I&#39;m running on a large GPU enabled machine. The training step seems to be done within a few hours, but then I keep seeing this message. Is this okay and it&#39;s just that it takes time to run? or is it being stuck or something? Thanks
<div class="chatlog__markdown-quote"><div class="chatlog__markdown-quote-border"></div><div class="chatlog__markdown-quote-content">Assigning PQ codes: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 864622905/864666312 [2:06:38&lt;00:00, 135313.52it/s]
Assigning PQ codes: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 864643385/864666312 [2:06:39&lt;00:00, 101254.47it/s]
Assigning PQ codes: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 864663865/864666312 [2:06:39&lt;00:00, 117178.45it/s]
Assigning PQ codes: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 864666312/864666312 [2:06:39&lt;00:00, 113783.95it/s]
[2025-04-02 19:11:47] [vector.py:compute_pq_codes:391] INFO Saved precomputed pq_codes to /mnt/tmp/tmpho7umx7h
[2025-04-02 19:11:47] [dataset.py:create_index:2235] INFO pq transform time: 7599.2157945632935s
[2025-04-03T02:12:41Z WARN  lance::events] target=&quot;lance_io::scheduler&quot; message=Backpressure throttle exceeded 
[2025-04-03T02:14:11Z WARN  lance::events] target=&quot;lance_io::scheduler&quot; message=Backpressure throttle exceeded 
[2025-04-03T02:16:10Z WARN  lance::events] target=&quot;lance_io::scheduler&quot; message=Backpressure throttle exceeded 
[2025-04-03T02:18:08Z WARN  lance::events] target=&quot;lance_io::scheduler&quot; message=Backpressure throttle exceeded 
[2025-04-03T02:20:09Z WARN  lance::events] target=&quot;lance_io::scheduler&quot; message=Backpressure throttle exceeded 
[2025-04-03T02:22:07Z WARN  lance::events] target=&quot;lance_io::scheduler&quot; message=Backpressure throttle exceeded 
... (More of &quot;Backpressure throttle exceeded &quot;)</div></div></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1357405254790025282 class=chatlog__message-container data-message-id=1357405254790025282><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, April 3, 2025 5:23â€¯PM"> <a href=#chatlog__message-container-1357405254790025282>4/3/2025 5:23â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1367519369432793200 class=chatlog__message-container data-message-id=1367519369432793200><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/4.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=mwildehahn data-user-id=108305940062687232>mwildehahn</span> <span class=chatlog__timestamp title="Thursday, May 1, 2025 3:13â€¯PM"><a href=#chatlog__message-container-1367519369432793200>5/1/2025 3:13â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m running lancedb with EBS on EC2. I created a FTS index and have been indexing data. It  looks like the index randomly gets dropped though and I can&#39;t figure out why. When I set up the table I create the index but then after awhile when I go to query it I get :

<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">RuntimeError: lance error: Invalid user input: Column text has no inverted index, /root/.cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-0.26.0/src/dataset/scanner.rs:1770:17</code>

and then calling list_indices says it indeed doesn&#39;t exist anymore. What am I missing?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1367529668491612280 class=chatlog__message-container data-message-id=1367529668491612280><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, May 1, 2025 3:54â€¯PM"> <a href=#chatlog__message-container-1367529668491612280>5/1/2025 3:54â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1368988774658474035 class=chatlog__message-container data-message-id=1368988774658474035><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=lardbit data-user-id=735616399669461103>lardbit</span> <span class=chatlog__timestamp title="Monday, May 5, 2025 4:32â€¯PM"><a href=#chatlog__message-container-1368988774658474035>5/5/2025 4:32â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Documentation links to a 404.  &quot;Querying vector indexes is done via the <strong>search</strong> function&quot;.  This is the URL with the bad link
<a href="https://lancedb.github.io/lancedb/ann_indexes/#querying-an-ann-index">https://lancedb.github.io/lancedb/ann_indexes/#querying-an-ann-index</a></span> <span class=chatlog__edited-timestamp title="Monday, May 5, 2025 4:33â€¯PM">(edited)</span></div></div></div></div><div id=chatlog__message-container-1368988969185837116 class=chatlog__message-container data-message-id=1368988969185837116><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, May 5, 2025 4:33â€¯PM">4:33â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Which links to this 404: <a href="https://lancedb.github.io/lancedb/python/#lancedb.table.LanceTable.search">https://lancedb.github.io/lancedb/python/#lancedb.table.LanceTable.search</a></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1368994076443283550 class=chatlog__message-container data-message-id=1368994076443283550><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, May 5, 2025 4:53â€¯PM"> <a href=#chatlog__message-container-1368994076443283550>5/5/2025 4:53â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1369462802338680982 class=chatlog__message-container data-message-id=1369462802338680982><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/216673693298851850/8b52eabbe7f27c61545322783a77593d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.tayz data-user-id=216673693298851850>TayZ</span> <span class=chatlog__timestamp title="Tuesday, May 6, 2025 11:56â€¯PM"><a href=#chatlog__message-container-1369462802338680982>5/6/2025 11:56â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Normal brute force search works well, but after creating index on the column vector, for some reason the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">.distanceRange(-0.1, maxDistanceAway)</code> is not respected anymore and only returns 10 results at max even though I have specified no limit.

I have a slider in my app to reduce / increase maxDistanceAway but no matter what the values, after an index, it always does the same search. But on normal brute force, it works well

It was created on 8.8k vectors</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1369466031864545408 class=chatlog__message-container data-message-id=1369466031864545408><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=.tayz data-user-id=216673693298851850>TayZ</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, May 7, 2025 12:09â€¯AM"> <a href=#chatlog__message-container-1369466031864545408>5/7/2025 12:09â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1369473017121345659 class=chatlog__message-container data-message-id=1369473017121345659><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/216673693298851850/8b52eabbe7f27c61545322783a77593d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.tayz data-user-id=216673693298851850>TayZ</span> <span class=chatlog__timestamp title="Wednesday, May 7, 2025 12:36â€¯AM"><a href=#chatlog__message-container-1369473017121345659>5/7/2025 12:36â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>(Also after indexing, for identical vector the <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_distance</code> is 0.44 for some reason instead of around 0)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1369706433024753720 class=chatlog__message-container data-message-id=1369706433024753720><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, May 7, 2025 4:04â€¯PM"> <a href=#chatlog__message-container-1369706433024753720>5/7/2025 4:04â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1370346511367540756 class=chatlog__message-container data-message-id=1370346511367540756><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/389519377780703242/6c77e360a222b6cd34a9b76b2ba554f3.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=vigenere92 data-user-id=389519377780703242>vigenere92</span> <span class=chatlog__timestamp title="Friday, May 9, 2025 10:27â€¯AM"><a href=#chatlog__message-container-1370346511367540756>5/9/2025 10:27â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi! We are testing out lancedb as an alternative to Weaviate which we currently use. However, I keep running into this error when building the vector index. How can this be remedied? Tried out 0.22.0 and 0.21.2

OSError: LanceError(Arrow): Arrow error: C Data interface error: Type error: can&#39;t convert np.ndarray of type numpy.uint64. The only supported types are: float64, float32, float16, complex64, complex128, int64, int32, int16, int8, uint8, and bool.. Detail: Python exception: Traceback (most recent call last):
  File &quot;/Users/username/.lanceenv/lib/python3.9/site-packages/lance/vector.py&quot;, line 492, in <em>partition<em>assignment
    for batch in loader:
  File &quot;/Users/username/.lanceenv/lib/python3.9/site-packages/torch/utils/data/dataloader.py&quot;, line 631, in __next</em></em>
    data = self.<em>next<em>data()
  File &quot;/Users/username/.lanceenv/lib/python3.9/site-packages/torch/utils/data/dataloader.py&quot;, line 675, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File &quot;/Users/username/.lanceenv/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py&quot;, line 32, in fetch
    data.append(next(self.dataset_iter))
  File &quot;/Users/username/.lanceenv/lib/python3.9/site-packages/lance/torch/data.py&quot;, line 356, in __iter</em></em>
    batch = self._to_tensor_fn(
  File &quot;/Users/username/.lanceenv/lib/python3.9/site-packages/lance/torch/data.py&quot;, line 92, in _to_tensor
    tensor = torch.from_numpy(arr.to_numpy(zero_copy_only=False))
TypeError: can&#39;t convert np.ndarray of type numpy.uint64. The only supported types are: float64, float32, float16, complex64, complex128, int64, int32, int16, int8, uint8, and bool.
, /Users/runner/work/lance/lance/rust/lance-datafusion/src/utils.rs:49:31</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1370432304979251242 class=chatlog__message-container data-message-id=1370432304979251242><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, May 9, 2025 4:08â€¯PM"> <a href=#chatlog__message-container-1370432304979251242>5/9/2025 4:08â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1371611673449726082 class=chatlog__message-container data-message-id=1371611673449726082><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=gregbowyer_23560 data-user-id=1371607536851226715>Greg Bowyer</span> <span class=chatlog__timestamp title="Monday, May 12, 2025 10:15â€¯PM"><a href=#chatlog__message-container-1371611673449726082>5/12/2025 10:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I cant seem to onboard to lancedb cloude, can someone from lancedb help me.</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1371614852371447833 class=chatlog__message-container data-message-id=1371614852371447833><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=qian_00349 data-user-id=1139637723725041674>Qian</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, May 12, 2025 10:27â€¯PM"> <a href=#chatlog__message-container-1371614852371447833>5/12/2025 10:27â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1375169845104087120 class=chatlog__message-container data-message-id=1375169845104087120><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/569691375386492949/bd57241d26dc6bc619408a4891df0f68.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=haocheng001 data-user-id=569691375386492949>Haocheng Liu</span> <span class=chatlog__timestamp title="Thursday, May 22, 2025 5:54â€¯PM"><a href=#chatlog__message-container-1375169845104087120>5/22/2025 5:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I&#39;m working on adding new documents and notice that when running <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">make html</code> in lance repo there are tons of WARNINGs and quite a  few of them are legit. (referencing to non existing files, duplication etc)
Wondering if they should be configured from WARNings to errors sometime in the future to ensure the quality of the Lance documentation?</span> <span class=chatlog__edited-timestamp title="Thursday, May 22, 2025 5:54â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1375170036360151193 class=chatlog__message-container data-message-id=1375170036360151193><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/278977272734810123/6f7c19ff44405abffd2e8ddb2ad04284.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span class=chatlog__timestamp title="Thursday, May 22, 2025 5:54â€¯PM"><a href=#chatlog__message-container-1375170036360151193>5/22/2025 5:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yes, that would probably be a good idea.  I&#39;ve always struggled to get rst to build without some warnings though.  But maybe I&#39;m thinking of C++-&gt;rst errors (we got a lot of bizarre ones we couldn&#39;t decipher in pyarrow)</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=ðŸ¥¹><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ¥¹ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f979.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1375170222771798191 class=chatlog__message-container data-message-id=1375170222771798191><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/569691375386492949/bd57241d26dc6bc619408a4891df0f68.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=haocheng001 data-user-id=569691375386492949>Haocheng Liu</span> <span class=chatlog__timestamp title="Thursday, May 22, 2025 5:55â€¯PM"><a href=#chatlog__message-container-1375170222771798191>5/22/2025 5:55â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I will try to clean up a few noticable ones in my PR first</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1376583956069220413 class=chatlog__message-container data-message-id=1376583956069220413><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chen_48949 data-user-id=1376583124116308102>chen</span> <span class=chatlog__timestamp title="Monday, May 26, 2025 3:33â€¯PM"><a href=#chatlog__message-container-1376583956069220413>5/26/2025 3:33â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi,  I am using nodejs package and I am trying to drop lance table  and I fail: I get the following error :   message: &#39;lance error: LanceError(IO): Directory not empty (os error 39), /usr/local/cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-io-0.26.0/src/local.rs:47:14  Caused by: LanceError(IO): Directory not empty (os error 39), /usr/local/cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-io-0.26.0/src/local.rs:47:14    Caused by: Directory not empty (os error 39)&#39;,
  code: &#39;GenericFailure&#39;,
  statusCode: undefined  should.I remove the table by using remove directory node operation?</span> <span class=chatlog__edited-timestamp title="Monday, May 26, 2025 3:34â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1376593291822235698 class=chatlog__message-container data-message-id=1376593291822235698><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=chen_48949>chen</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1376583956069220413')"> Hi,  I am using nodejs package and I am trying to drop lance table  and I fail: I get the following error :   message: &#39;lance error: LanceError(IO): Directory not empty (os error 39), /usr/local/cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-io-0.26.0/src/local.rs:47:14  Caused by: LanceError(IO): Directory not empty (os error 39), /usr/local/cargo/registry/src/index.crates.io-6f17d22bba15001f/lance-io-0.26.0/src/local.rs:47:14    Caused by: Directory not empty (os error 39)&#39;,
  code: &#39;GenericFailure&#39;,
  statusCode: undefined  should.I remove the table by using remove directory node operation? </span> <span class=chatlog__reply-edited-timestamp title="Monday, May 26, 2025 3:34â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author title=chen_48949 data-user-id=1376583124116308102>chen</span> <span class=chatlog__timestamp title="Monday, May 26, 2025 4:10â€¯PM"><a href=#chatlog__message-container-1376593291822235698>5/26/2025 4:10â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Another issue I am having - after dropping the index I still see a connection to the directory: /lance/embeddings.lance/_indices/10136845-c863-4abf-8358-98cd436421b9/invert.lance - what am I missing?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1377000686734020754 class=chatlog__message-container data-message-id=1377000686734020754><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, May 27, 2025 7:09â€¯PM"> <a href=#chatlog__message-container-1377000686734020754>5/27/2025 7:09â€¯PM</a> </span></div></div></div><div id=chatlog__message-container-1377001091438219265 class=chatlog__message-container data-message-id=1377001091438219265><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, May 27, 2025 7:10â€¯PM"> <a href=#chatlog__message-container-1377001091438219265>5/27/2025 7:10â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1390291451878834258 class=chatlog__message-container data-message-id=1390291451878834258><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/271911699336921088/16f15f9d716df851443b832aa45c6c87.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=vincentwarmerdam data-user-id=271911699336921088>Vincent</span> <span class=chatlog__timestamp title="Thursday, July 3, 2025 11:21â€¯AM"><a href=#chatlog__message-container-1390291451878834258>7/3/2025 11:21â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey, folks. I noticed that there&#39;s a new docs page up and that a few things seem just a little bit broken. The edit button doesn&#39;t seem to work. I also spotted just a code snippet that&#39;s doesn&#39;t work. It also seems that search is no longer there. Am I missing something? I think... I remember before we used mkdocs material here?  But right now I&#39;m not exactly sure where to make edits if I see a mistake.</span></div></div></div></div><div id=chatlog__message-container-1390291780599025766 class=chatlog__message-container data-message-id=1390291780599025766><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Thursday, July 3, 2025 11:23â€¯AM">11:23â€¯AM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>The &quot;global object&quot; typo honestly took me 30 mins and diving into the source code to fix/grok/understand.</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1390291780120870974/CleanShot_2025-07-03_at_13.21.54.png?ex=698a6c5e&amp;is=69891ade&amp;hm=686d4ae07d2b4e66e59c72fd6b7258393f27096a8b5c1d2a77d2cd2eeb71a9d6&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1390291780120870974/CleanShot_2025-07-03_at_13.21.54.png?ex=698a6c5e&amp;is=69891ade&amp;hm=686d4ae07d2b4e66e59c72fd6b7258393f27096a8b5c1d2a77d2cd2eeb71a9d6&amp;" alt="Image attachment" title="Image: CleanShot_2025-07-03_at_13.21.54.png (228.51 KB)" loading=lazy> </a></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1390291780381048922/CleanShot_2025-07-03_at_13.22.02.png?ex=698a6c5e&amp;is=69891ade&amp;hm=a4fa1faafb63c2ac6e26da4477675297db0eef7f8bab340e78b5682baa1fb69b&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1390291780381048922/CleanShot_2025-07-03_at_13.22.02.png?ex=698a6c5e&amp;is=69891ade&amp;hm=a4fa1faafb63c2ac6e26da4477675297db0eef7f8bab340e78b5682baa1fb69b&amp;" alt="Image attachment" title="Image: CleanShot_2025-07-03_at_13.22.02.png (182.57 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1390301922694529128 class=chatlog__message-container data-message-id=1390301922694529128><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, July 3, 2025 12:03â€¯PM"> <a href=#chatlog__message-container-1390301922694529128>7/3/2025 12:03â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1392284250325254316 class=chatlog__message-container data-message-id=1392284250325254316><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/216673693298851850/8b52eabbe7f27c61545322783a77593d.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=.tayz data-user-id=216673693298851850>TayZ</span> <span class=chatlog__timestamp title="Tuesday, July 8, 2025 11:20â€¯PM"><a href=#chatlog__message-container-1392284250325254316>7/8/2025 11:20â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Anyone getting a crash on the new Snapdragon ARM64 chips on Windows?

Not sure if Lance has a package for it yet, the new Surface Book laptops are getting this crash</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1392284250107023400/image.png?ex=698a6bc0&amp;is=69891a40&amp;hm=b3d2ca39176246f8cc9e6e7e13136e013bf10edc7e29a220dda680f627c376cc&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1392284250107023400/image.png?ex=698a6bc0&amp;is=69891a40&amp;hm=b3d2ca39176246f8cc9e6e7e13136e013bf10edc7e29a220dda680f627c376cc&amp;" alt="Image attachment" title="Image: image.png (138.03 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1392632847105523747 class=chatlog__message-container data-message-id=1392632847105523747><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Wednesday, July 9, 2025 10:25â€¯PM"> <a href=#chatlog__message-container-1392632847105523747>7/9/2025 10:25â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1392820535179608159 class=chatlog__message-container data-message-id=1392820535179608159><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=chen_48949 data-user-id=1376583124116308102>chen</span> <span class=chatlog__timestamp title="Thursday, July 10, 2025 10:51â€¯AM"><a href=#chatlog__message-container-1392820535179608159>7/10/2025 10:51â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi,  we get this error: Failed to clean older version for table bed9d473-2acc-42fd-9c1b-d18807fb0ab1. Error: lance error: LanceError(IO): Generic LocalFileSystem error: Unable to copy file from /tmp/.tmpYgPXB8/part_0_tokens.lance to /bed9d473-2acc-42fd-9c1b-d18807fb0ab1/lance/embeddings.lance/_indices/6465deda-7ad9-436a-817e-2503bb1fb5f8/part_0_tokens.lance: Invalid cross-device link (os error 18), /usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/lance-io-0.30.0/src/object_store.rs:484:12  Caused by: LanceError(IO): Generic LocalFileSystem error: Unable to copy file from /tmp/.tmpYgPXB8/part_0_tokens.lance to /bed9d473-2acc-42fd-9c1b-d18807fb0ab1/lance/embeddings.lance/_indices/6465deda-7ad9-436a-817e-2503bb1fb5f8/part_0_tokens.lance: Invalid cross-device link (os error 18), /usr/local/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/lance-io-0.30.0/src/object_store.rs:484:12    Caused by: Generic LocalFileSystem error: Unable to copy file from /tmp/.tmpYgPXB8/part_0_tokens.lance to /bed9d473-2acc-42fd-9c1b-d18807fb0ab1/lance/embeddings.lance/_indices/6465deda-7ad9-436a-817e-2503bb1fb5f8/part_0_tokens.lance: Invalid cross-device link (os error 18)      Caused by: Unable to copy file from /tmp/.tmpYgPXB8/part_0_tokens.lance to /bed9d473-2acc-42fd-9c1b-d18807fb0ab1/lance/embeddings.lance/_indices/6465deda-7ad9-436a-817e-2503bb1fb5f8/part_0_tokens.lance: Invalid cross-device link (os error 18)        Caused by: Invalid cross-device link (os error 18) when trying to do cleanup operation on lancedb using node.js.  I saw there was an issue on python - is it fixed on nodejs package as well?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1392824762618740859 class=chatlog__message-container data-message-id=1392824762618740859><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=yah2er0ne data-user-id=963889951810941039>Yang</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, July 10, 2025 11:08â€¯AM"> <a href=#chatlog__message-container-1392824762618740859>7/10/2025 11:08â€¯AM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1395758382161592332 class=chatlog__message-container data-message-id=1395758382161592332><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/569691375386492949/bd57241d26dc6bc619408a4891df0f68.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=haocheng001 data-user-id=569691375386492949>Haocheng Liu</span> <span class=chatlog__timestamp title="Friday, July 18, 2025 1:25â€¯PM"><a href=#chatlog__message-container-1395758382161592332>7/18/2025 1:25â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hey, I recently noticed that some contents about the lance format webpage are outdated. <a href="https://lancedb.github.io/lance/format/">https://lancedb.github.io/lance/format/</a>
Wondering if it&#39;s already been worked on?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1395794101584007370 class=chatlog__message-container data-message-id=1395794101584007370><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/762192026653294603/0777b1b2252f5f54629d0b5ef334f9fd.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/569691375386492949/bd57241d26dc6bc619408a4891df0f68.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=haocheng001>Haocheng Liu</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1395758382161592332')"> Hey, I recently noticed that some contents about the lance format webpage are outdated. <a href="https://lancedb.github.io/lance/format/">https://lancedb.github.io/lance/format/</a>
Wondering if it&#39;s already been worked on? </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jackye8397 data-user-id=762192026653294603>Jack Ye</span> <span class=chatlog__timestamp title="Friday, July 18, 2025 3:47â€¯PM"><a href=#chatlog__message-container-1395794101584007370>7/18/2025 3:47â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yeah there are quite a few related work items we are tracking: <a href="https://github.com/lancedb/lance/issues/4136">https://github.com/lancedb/lance/issues/4136</a>, <a href="https://github.com/lancedb/lance/issues/3999">https://github.com/lancedb/lance/issues/3999</a>, <a href="https://github.com/lancedb/lance/issues/4250">https://github.com/lancedb/lance/issues/4250</a>.</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/4136,><div class="chatlog__markdown chatlog__markdown-preserve">lancedb/lance</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Modern columnar data format for ML and LLMs implemented in Rust. Convert from parquet in 2 lines of code for 100x faster random access, vector index, and data versioning. Compatible with Pandas, Du...</div></div></div></div></div></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/3999,><div class="chatlog__markdown chatlog__markdown-preserve">lancedb/lance</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Modern columnar data format for ML and LLMs implemented in Rust. Convert from parquet in 2 lines of code for 100x faster random access, vector index, and data versioning. Compatible with Pandas, Du...</div></div></div></div></div></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/4250.><div class="chatlog__markdown chatlog__markdown-preserve">lancedb/lance</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Modern columnar data format for ML and LLMs implemented in Rust. Convert from parquet in 2 lines of code for 100x faster random access, vector index, and data versioning. Compatible with Pandas, Du...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/D0fzXSn4f1ruk1PWErr8YCHt0PSju1uNPdkevgXkePI/https/opengraph.githubassets.com/a820d42341f1d30dbfaf08837105567f8d256034aa3d2b9329b853c82f8d355c/lancedb/lance> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/D0fzXSn4f1ruk1PWErr8YCHt0PSju1uNPdkevgXkePI/https/opengraph.githubassets.com/a820d42341f1d30dbfaf08837105567f8d256034aa3d2b9329b853c82f8d355c/lancedb/lance alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1395968286537027614 class=chatlog__message-container data-message-id=1395968286537027614><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/297602268193095680/6dfb3f0adf553a2a3a6b751e15afdb27.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=scooby_rat data-user-id=297602268193095680>1jamesthompson1</span> <span class=chatlog__timestamp title="Saturday, July 19, 2025 3:19â€¯AM"><a href=#chatlog__message-container-1395968286537027614>7/19/2025 3:19â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>With the merge_insert function am I correct that the merge_insert function will re-compute the embeddings for all given documents.  This somewhat seems like a bug to me. Atleast it doesnt match up with my expectations.
Say you something like this where some_new_some_old_data is of size 100
<code class="chatlog__markdown-pre chatlog__markdown-pre--multiline nohighlight">table.merge_insert(on=[&quot;document_id&quot;, &quot;document&quot;]) \
    .when_not_matched_insert_all() \
    .execute(some_new_some_old_data)
# Returns
# MergeResult(version=17, num_updated_rows=0, num_inserted_rows=89, num_deleted_rows=0)</code>

Will all of the 100 documents have their documents rembedded. Or will it just be 89 documents that are new.

After looking at <a href="https://github.com/lancedb/lancedb/blob/88283110f4f782db51b857e1efc61f3e3531a743/python/python/lancedb/table.py#L3718C5-L3752C1">https://github.com/lancedb/lancedb/blob/88283110f4f782db51b857e1efc61f3e3531a743/python/python/lancedb/table.py#L3718C5-L3752C1</a> and the call to <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">_sanitize_data</code> it seems like all the embeddings are recomputed.

This seems really inefficent and in my eyes takes a big advantage of the merge_insert away.

I am trying to do something where I dataset that is growing. I want to periodically run merge_insert which will only add the new documents. However the dataset is quite large so I don&#39;t want to recomputet he embeddings. Is there a way to do this that is not simply storing a seperate dataset tracking what has already been added to the vector db?</span> <span class=chatlog__edited-timestamp title="Saturday, July 19, 2025 3:20â€¯AM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1396534879126159374 class=chatlog__message-container data-message-id=1396534879126159374><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Sunday, July 20, 2025 4:51â€¯PM"> <a href=#chatlog__message-container-1396534879126159374>7/20/2025 4:51â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1405551454181261363 class=chatlog__message-container data-message-id=1405551454181261363><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/569691375386492949/bd57241d26dc6bc619408a4891df0f68.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=haocheng001 data-user-id=569691375386492949>Haocheng Liu</span> <span class=chatlog__timestamp title="Thursday, August 14, 2025 1:59â€¯PM"><a href=#chatlog__message-container-1405551454181261363>8/14/2025 1:59â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, is it possible to allow external people to link label/types/assignees  with PR/Issue on github? It was adopted by many project I&#39;ve worked in the past and I think it offers better categorization</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1409296313304219699 class=chatlog__message-container data-message-id=1409296313304219699><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1101360658928381973/a_44eeadf628010ef7783f4b7987102133.gif?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=henry00c data-user-id=1101360658928381973>henry</span> <span class=chatlog__timestamp title="Sunday, August 24, 2025 10:00â€¯PM"><a href=#chatlog__message-container-1409296313304219699>8/24/2025 10:00â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>cloud.lancedb.com/user/profile

the header overlaps the top of the content so you cant see or click some of the stuff at the top</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1409561959929614356 class=chatlog__message-container data-message-id=1409561959929614356><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1101360658928381973/a_44eeadf628010ef7783f4b7987102133.gif?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=henry00c>henry</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1409296313304219699')"> cloud.lancedb.com/user/profile

the header overlaps the top of the content so you cant see or click some of the stuff at the top </span></div></div><div class=chatlog__header><span class=chatlog__author title=jim.apple data-user-id=1385382078433988658>Jim Apple</span> <span class=chatlog__timestamp title="Monday, August 25, 2025 3:35â€¯PM"><a href=#chatlog__message-container-1409561959929614356>8/25/2025 3:35â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks!, we&#39;ll take a look! Are you on desktop, phone, or other? What browser are you using?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1409567144504721438 class=chatlog__message-container data-message-id=1409567144504721438><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/516038066427920394/8d228b64fe5341e2198a89a817bbe357.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1101360658928381973/a_44eeadf628010ef7783f4b7987102133.gif?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=henry00c>henry</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1409296313304219699')"> cloud.lancedb.com/user/profile

the header overlaps the top of the content so you cant see or click some of the stuff at the top </span></div></div><div class=chatlog__header><span class=chatlog__author title=ayy5 data-user-id=516038066427920394>ayy5</span> <span class=chatlog__timestamp title="Monday, August 25, 2025 3:56â€¯PM"><a href=#chatlog__message-container-1409567144504721438>8/25/2025 3:56â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi Henry, if possible, could you send us a picture of what you are seeing (with your information masked out of course)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1409649520266182676 class=chatlog__message-container data-message-id=1409649520266182676><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1101360658928381973/a_44eeadf628010ef7783f4b7987102133.gif?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=henry00c data-user-id=1101360658928381973>henry</span> <span class=chatlog__timestamp title="Monday, August 25, 2025 9:23â€¯PM"><a href=#chatlog__message-container-1409649520266182676>8/25/2025 9:23â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>macos, chrome</span></div></div></div></div><div id=chatlog__message-container-1409649536229445782 class=chatlog__message-container data-message-id=1409649536229445782><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__short-timestamp title="Monday, August 25, 2025 9:23â€¯PM">9:23â€¯PM</div></div><div class=chatlog__message-primary><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>will do</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1409654693868601414 class=chatlog__message-container data-message-id=1409654693868601414><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1101360658928381973/a_44eeadf628010ef7783f4b7987102133.gif?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=henry00c data-user-id=1101360658928381973>henry</span> <span class=chatlog__timestamp title="Monday, August 25, 2025 9:44â€¯PM"><a href=#chatlog__message-container-1409654693868601414>8/25/2025 9:44â€¯PM</a></span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1409654693638176818/Screenshot_2025-08-26_at_6.43.42_AM.png?ex=698a553d&amp;is=698903bd&amp;hm=a7a232feb361520ef9c2b981e8d3e1c1048538ffe0d61cb716236b23e949bb07&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1409654693638176818/Screenshot_2025-08-26_at_6.43.42_AM.png?ex=698a553d&amp;is=698903bd&amp;hm=a7a232feb361520ef9c2b981e8d3e1c1048538ffe0d61cb716236b23e949bb07&amp;" alt="Image attachment" title="Image: Screenshot_2025-08-26_at_6.43.42_AM.png (234.4 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1409767236532568135 class=chatlog__message-container data-message-id=1409767236532568135><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/516038066427920394/8d228b64fe5341e2198a89a817bbe357.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=ayy5 data-user-id=516038066427920394>ayy5</span> <span class=chatlog__timestamp title="Tuesday, August 26, 2025 5:11â€¯AM"><a href=#chatlog__message-container-1409767236532568135>8/26/2025 5:11â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I see what is going on. The profile page is centered on the screen. The height it needs is less than what the page provides. To work around it, just increase the browser height. In the mean time, I will see what we can do to improve it.</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1409800771087634452 class=chatlog__message-container data-message-id=1409800771087634452><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1101360658928381973/a_44eeadf628010ef7783f4b7987102133.gif?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=henry00c data-user-id=1101360658928381973>henry</span> <span class=chatlog__timestamp title="Tuesday, August 26, 2025 7:24â€¯AM"><a href=#chatlog__message-container-1409800771087634452>8/26/2025 7:24â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>zooming out to 75% fixed it</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1414584148609208420 class=chatlog__message-container data-message-id=1414584148609208420><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=adam_62385 data-user-id=1414568252662611988>adam</span> <span class=chatlog__timestamp title="Monday, September 8, 2025 12:12â€¯PM"><a href=#chatlog__message-container-1414584148609208420>9/8/2025 12:12â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><strong>I make two schema for the same data (one contains fixed-size binary, another one contains binary)ï¼ŒI found that the latter is compressed by lance, is this a bug?</strong>

Example code :

compress_metadata = \
    {
        &quot;lance-encoding:compression&quot;: &quot;zstd&quot;,
        &quot;lance-encoding:compression-level&quot;: &quot;1&quot;,
        &quot;lance-encoding:structural-encoding&quot;: &quot;miniblock&quot;,
        &quot;lance-encoding:packed&quot;: &quot;true&quot;
    }

pa.field(&quot;data&quot;, pa.binary(280 * 160 * 8), metadata=compress_metadata)  vs pa.field(&quot;data&quot;, pa.binary(), metadata=compress_metadata)</span> <span class=chatlog__edited-timestamp title="Monday, September 8, 2025 12:12â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1414586882309750929 class=chatlog__message-container data-message-id=1414586882309750929><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wpace data-user-id=278977272734810123>WestonPace</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, September 8, 2025 12:23â€¯PM"> <a href=#chatlog__message-container-1414586882309750929>9/8/2025 12:23â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1414760733782179841 class=chatlog__message-container data-message-id=1414760733782179841><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/445116234481139724/c972f0261d40a001c6bb06fbecad19f9.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=ebyhr data-user-id=445116234481139724>ebyhr</span> <span class=chatlog__timestamp title="Monday, September 8, 2025 11:54â€¯PM"><a href=#chatlog__message-container-1414760733782179841>9/8/2025 11:54â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi, it seems <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance-trino</code> fails to start due to missing <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">@Inject</code> annotation in <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">LanceReader</code> class. 
I sent <a href="https://github.com/lancedb/lance-trino/pull/14">https://github.com/lancedb/lance-trino/pull/14</a> fixing the issue, and another PR to add CI <a href="https://github.com/lancedb/lance-trino/pull/15">https://github.com/lancedb/lance-trino/pull/15</a></span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1416092566759145513 class=chatlog__message-container data-message-id=1416092566759145513><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/5.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/445116234481139724/c972f0261d40a001c6bb06fbecad19f9.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=ebyhr>ebyhr</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1414760733782179841')"> Hi, it seems <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">lance-trino</code> fails to start due to missing <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">@Inject</code> annotation in <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">LanceReader</code> class. 
I sent <a href="https://github.com/lancedb/lance-trino/pull/14">https://github.com/lancedb/lance-trino/pull/14</a> fixing the issue, and another PR to add CI <a href="https://github.com/lancedb/lance-trino/pull/15">https://github.com/lancedb/lance-trino/pull/15</a> </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=rpgreen_lancedb data-user-id=1235914389664829440>Ryan</span> <span class=chatlog__timestamp title="Friday, September 12, 2025 4:06â€¯PM"><a href=#chatlog__message-container-1416092566759145513>9/12/2025 4:06â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks, we will take a look soon</span></div><div class=chatlog__reactions><div class=chatlog__reaction title=heart><img class="chatlog__emoji chatlog__emoji--small" alt=â¤ï¸ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/2764.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1422257471699030056 class=chatlog__message-container data-message-id=1422257471699030056><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1381615301720018945/0b51a04b16a05504e1c44c0000a5a0f7.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=matejnewtide data-user-id=1381615301720018945>Matej</span> <span class=chatlog__timestamp title="Monday, September 29, 2025 4:23â€¯PM"><a href=#chatlog__message-container-1422257471699030056>9/29/2025 4:23â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hi, lance team...
i logged in to the web ui, wanted to quickly browse one of my tables but getting the spinner only:</span></div><div class=chatlog__attachment><a href="https://cdn.discordapp.com/attachments/1105226910528716912/1422257471354962001/image.png?ex=698a09fd&amp;is=6988b87d&amp;hm=9ceccf5a50b0bd80ef8c7d057f12adf2c6e662e39edba9013d788bf29bc7129d&amp;"> <img class=chatlog__attachment-media src="https://cdn.discordapp.com/attachments/1105226910528716912/1422257471354962001/image.png?ex=698a09fd&amp;is=6988b87d&amp;hm=9ceccf5a50b0bd80ef8c7d057f12adf2c6e662e39edba9013d788bf29bc7129d&amp;" alt="Image attachment" title="Image: image.png (3.67 KB)" loading=lazy> </a></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1422261785913983030 class=chatlog__message-container data-message-id=1422261785913983030><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=changkhiskhan data-user-id=1029794695418761228>changhiskhan</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, September 29, 2025 4:40â€¯PM"> <a href=#chatlog__message-container-1422261785913983030>9/29/2025 4:40â€¯PM</a> </span></div></div></div><div id=chatlog__message-container-1422703729295101952 class=chatlog__message-container data-message-id=1422703729295101952><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=ebyhr data-user-id=445116234481139724>ebyhr</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Tuesday, September 30, 2025 9:56â€¯PM"> <a href=#chatlog__message-container-1422703729295101952>9/30/2025 9:56â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1435015383466639530 class=chatlog__message-container data-message-id=1435015383466639530><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=josh_hhai data-user-id=1435010225332813864>Josh Paul</span> <span class=chatlog__timestamp title="Monday, November 3, 2025 9:18â€¯PM"><a href=#chatlog__message-container-1435015383466639530>11/3/2025 9:18â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hello lance team, I filed an issue <a href="https://github.com/lancedb/lance/issues/5128">https://github.com/lancedb/lance/issues/5128</a> and would love to get your thoughts on it, i can generate a pr if you find this to be a valid issue</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/5128><div class="chatlog__markdown chatlog__markdown-preserve">FTS panic: Incomplete fix for empty posting lists (PR #4019 missed ...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">FTS panic: Incomplete fix for empty posting lists (PR #4019 missed 4 instances) Bug Description The fix in PR #4019 (commit 77bbcb2) addressed one instance of calling .doc().unwrap() without checki...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/zJBs1Y2KVkghJrmImyU8p2rntS_nCLUs9T0PXqMQfFU/https/opengraph.githubassets.com/59373c3838c4b90e17639d048cd244ca5d8064e8b880ea88481fbcc2505e4c8f/lancedb/lance/issues/5128> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/zJBs1Y2KVkghJrmImyU8p2rntS_nCLUs9T0PXqMQfFU/https/opengraph.githubassets.com/59373c3838c4b90e17639d048cd244ca5d8064e8b880ea88481fbcc2505e4c8f/lancedb/lance/issues/5128 alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__reactions><div class=chatlog__reaction title=thumbsup><img class="chatlog__emoji chatlog__emoji--small" alt=ðŸ‘ src=https://cdn.jsdelivr.net/gh/twitter/twemoji@latest/assets/svg/1f44d.svg loading=lazy> <span class=chatlog__reaction-count>1</span></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1435026917421224058 class=chatlog__message-container data-message-id=1435026917421224058><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1422848062015143977/8d8077ab1d2a29f86a77aea1a8f4e603.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=arnavw999 data-user-id=1422848062015143977>Arnav</span> <span class=chatlog__timestamp title="Monday, November 3, 2025 10:04â€¯PM"><a href=#chatlog__message-container-1435026917421224058>11/3/2025 10:04â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>hey lance team, on a dataset with ~50million 4096d vectors on S3 my vector search speeds are about 5-10 seconds after the index cache is warm. I&#39;ve inspected the analyze_plan and it looks like the I/O for &#39;take&#39; on the metadata columns is dominating the query times.

Is this expected on S3 or am I tuning something wrong? I&#39;m slightly confused because an earlier version we had of this dataset (exactly the same but with only about ~10 million rows) gave us no problem and was consistently sub-second query latency.

for context, these are the params I built my vector index with:

    ds.create_index(
        column=&quot;vector&quot;,
        index_type=&quot;IVF_PQ&quot;,
        metric=&quot;L2&quot;,
        replace=True,
        target_partition_size=8192,
        num_sub_vectors=256,
        accelerator=&quot;cuda&quot;,
        num_bits=8,
    )

during the search, I&#39;m passing refine_factor=None and nprobes=64 and k=10. 

I&#39;m querying from an ec2 machine in the same region as the bucket. I&#39;ve recently compacted the dataset and there are no small fragments, its on lance version 2.1. Happy to provide any more details if needed!</span> <span class=chatlog__edited-timestamp title="Monday, November 3, 2025 10:47â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1435041676044538043 class=chatlog__message-container data-message-id=1435041676044538043><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author title=arnavw999 data-user-id=1422848062015143977>Arnav</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Monday, November 3, 2025 11:03â€¯PM"> <a href=#chatlog__message-container-1435041676044538043>11/3/2025 11:03â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1436018030369837268 class=chatlog__message-container data-message-id=1436018030369837268><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1430991007113154701/f7de3b3850f656bd2dffad9ef50dd3e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=rahilchertara_13869 data-user-id=1430991007113154701>Rahil Chertara</span> <span class=chatlog__timestamp title="Thursday, November 6, 2025 3:42â€¯PM"><a href=#chatlog__message-container-1436018030369837268>11/6/2025 3:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi all, recently I have been working on adding lance file format support within Apache <a href="https://github.com/apache/hudi/issues/14127">Hudi</a> and wanted to raise a potential <a href="https://github.com/lancedb/lance/issues/5167">issue</a> with the Lance Java SDK not returning the blob encoding. Let me know if you need any more details or if my understanding is incorrect.
cc <span class="chatlog__markdown-mention" title="jackye8397">@Jack Ye</span> <span class="chatlog__markdown-mention" title="lei.xu">@lei</span></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/apache/hudi/issues/14127><div class="chatlog__markdown chatlog__markdown-preserve">RFC-100: Lance File Format support in Hudi &#183; Issue #14127 &#183; apach...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Feature Description What the feature achieves: This feature enables Apache Hudi to use Lance as a storage file format, similar to existing formats we support like Parquet and ORC. By doing so, Hudi...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/JM4Inz-DtJxhMmI-8qIj9G0n0rgFPnuwCYV2_vdautQ/https/opengraph.githubassets.com/31633454c05467eb9fd8a96cf9adf42bbc9d8bd2df5dfbfcecdf37bfddff8188/apache/hudi/issues/14127> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/JM4Inz-DtJxhMmI-8qIj9G0n0rgFPnuwCYV2_vdautQ/https/opengraph.githubassets.com/31633454c05467eb9fd8a96cf9adf42bbc9d8bd2df5dfbfcecdf37bfddff8188/apache/hudi/issues/14127 alt=Thumbnail loading=lazy> </a></div></div></div></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/issues/5167><div class="chatlog__markdown chatlog__markdown-preserve">Blob Encoding not working with Lance Java SDK &#183; Issue #5167 &#183; lan...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Issue Summary Hi all, recently I have been working on adding lance file format support within Apache Hudi: apache/hudi#14127 and wanted to raise a potential issue(hopefully my understanding is corr...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/hKKvkjcFUpEt7iKdhJeyCkN6KANWCqEahZV2f4ofBHQ/https/opengraph.githubassets.com/141ae74179a718652aad98f11220e94bdeb7f2cd855e2be33006a671d891d5c8/lancedb/lance/issues/5167> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/hKKvkjcFUpEt7iKdhJeyCkN6KANWCqEahZV2f4ofBHQ/https/opengraph.githubassets.com/141ae74179a718652aad98f11220e94bdeb7f2cd855e2be33006a671d891d5c8/lancedb/lance/issues/5167 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1436026330323095673 class=chatlog__message-container data-message-id=1436026330323095673><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/762192026653294603/0777b1b2252f5f54629d0b5ef334f9fd.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/1430991007113154701/f7de3b3850f656bd2dffad9ef50dd3e4.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author title=rahilchertara_13869>Rahil Chertara</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1436018030369837268')"> Hi all, recently I have been working on adding lance file format support within Apache <a href="https://github.com/apache/hudi/issues/14127">Hudi</a> and wanted to raise a potential <a href="https://github.com/lancedb/lance/issues/5167">issue</a> with the Lance Java SDK not returning the blob encoding. Let me know if you need any more details or if my understanding is incorrect.
cc <span class="chatlog__markdown-mention" title="jackye8397">@Jack Ye</span> <span class="chatlog__markdown-mention" title="lei.xu">@lei</span> </span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=jackye8397 data-user-id=762192026653294603>Jack Ye</span> <span class=chatlog__timestamp title="Thursday, November 6, 2025 4:15â€¯PM"><a href=#chatlog__message-container-1436026330323095673>11/6/2025 4:15â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Added some replies there</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1436066068824326356 class=chatlog__message-container data-message-id=1436066068824326356><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1430991007113154701/f7de3b3850f656bd2dffad9ef50dd3e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/762192026653294603/0777b1b2252f5f54629d0b5ef334f9fd.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=jackye8397>Jack Ye</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1436026330323095673')"> Added some replies there </span></div></div><div class=chatlog__header><span class=chatlog__author title=rahilchertara_13869 data-user-id=1430991007113154701>Rahil Chertara</span> <span class=chatlog__timestamp title="Thursday, November 6, 2025 6:53â€¯PM"><a href=#chatlog__message-container-1436066068824326356>11/6/2025 6:53â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Thanks for the comment, i also left a response. Just to confirm then the current blob v1 encoding is only support in the Rust SDK for using file reader and file writer, but not supportted for other languages SDK?</span> <span class=chatlog__edited-timestamp title="Thursday, November 6, 2025 6:54â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1436365997312442398 class=chatlog__message-container data-message-id=1436365997312442398><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/1430991007113154701/f7de3b3850f656bd2dffad9ef50dd3e4.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src="https://cdn.discordapp.com/avatars/762192026653294603/0777b1b2252f5f54629d0b5ef334f9fd.png?size=512" alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=jackye8397>Jack Ye</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1436026330323095673')"> Added some replies there </span></div></div><div class=chatlog__header><span class=chatlog__author title=rahilchertara_13869 data-user-id=1430991007113154701>Rahil Chertara</span> <span class=chatlog__timestamp title="Friday, November 7, 2025 2:45â€¯PM"><a href=#chatlog__message-container-1436365997312442398>11/7/2025 2:45â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="jackye8397">@Jack Ye</span> <span class="chatlog__markdown-mention" title="wpace">@WestonPace</span> <span class="chatlog__markdown-mention" title="lei.xu">@lei</span>  have made the following <a href="https://github.com/lancedb/lance/pull/5193">patch</a> here, which allowed me to see the blob encoding returned. I am not super familiar with lance file format and rust intriciacies yet so feel free to correct it if this is not the ideal fix.</span> <span class=chatlog__edited-timestamp title="Friday, November 7, 2025 2:45â€¯PM">(edited)</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lance/pull/5193><div class="chatlog__markdown chatlog__markdown-preserve">fix: ensure blob encoding work when using file reader directly by r...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Issue summary
Raised the following issue here which provides a reproduction of using the java file reader api which is not returning back the blob encoding when setting the &amp;amp;quot;lance-encoding...</div></div></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1436485992659026091 class=chatlog__message-container data-message-id=1436485992659026091><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/2.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=immaculate_star_17039 data-user-id=1345646860496277514>Sen</span> <span class=chatlog__timestamp title="Friday, November 7, 2025 10:42â€¯PM"><a href=#chatlog__message-container-1436485992659026091>11/7/2025 10:42â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi Team, I found that in a freshly built venv, it takes ~10 seconds to run <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">import lancedb</code>
I was wondering if this is expected?</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1436497029663559686 class=chatlog__message-container data-message-id=1436497029663559686><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=prrao data-user-id=675128789646442557>prashanth</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, November 7, 2025 11:26â€¯PM"> <a href=#chatlog__message-container-1436497029663559686>11/7/2025 11:26â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1443298066118480045 class=chatlog__message-container data-message-id=1443298066118480045><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=akhushalani data-user-id=888248321490174012>akhushalani</span> <span class=chatlog__timestamp title="Wednesday, November 26, 2025 5:51â€¯PM"><a href=#chatlog__message-container-1443298066118480045>11/26/2025 5:51â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi Team, I&#39;m running into a bug on LanceDB Cloud where I&#39;m unable to generate API keys because the site says that payment hasn&#39;t been set up, even though it has been. It only lets us generate keys that expire in the past, on 10/17/25.</span> <span class=chatlog__edited-timestamp title="Wednesday, November 26, 2025 5:54â€¯PM">(edited)</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1443347421282173049 class=chatlog__message-container data-message-id=1443347421282173049><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy><div class=chatlog__reply-author title=akhushalani>akhushalani</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1443298066118480045')"> Hi Team, I&#39;m running into a bug on LanceDB Cloud where I&#39;m unable to generate API keys because the site says that payment hasn&#39;t been set up, even though it has been. It only lets us generate keys that expire in the past, on 10/17/25. </span> <span class=chatlog__reply-edited-timestamp title="Wednesday, November 26, 2025 5:54â€¯PM">(edited)</span></div></div><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=wyatt.alt data-user-id=1331668878178127883>wkalt</span> <span class=chatlog__timestamp title="Wednesday, November 26, 2025 9:07â€¯PM"><a href=#chatlog__message-container-1443347421282173049>11/26/2025 9:07â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve><span class="chatlog__markdown-mention" title="akhushalani">@akhushalani</span> did your team also reach out to us through the support email? This sounds like something that came up earlier today</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1443429225553068072 class=chatlog__message-container data-message-id=1443429225553068072><div class=chatlog__message><div class=chatlog__message-aside><div class=chatlog__reply-symbol></div><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__reply><img class=chatlog__reply-avatar src=https://cdn.discordapp.com/embed/avatars/3.png alt=Avatar loading=lazy><div class=chatlog__reply-author style=color:rgb(230,126,34) title=wyatt.alt>wkalt</div><div class=chatlog__reply-content><span class=chatlog__reply-link onclick="scrollToMessage(event,'1443347421282173049')"> <span class="chatlog__markdown-mention" title="akhushalani">@akhushalani</span> did your team also reach out to us through the support email? This sounds like something that came up earlier today </span></div></div><div class=chatlog__header><span class=chatlog__author title=akhushalani data-user-id=888248321490174012>akhushalani</span> <span class=chatlog__timestamp title="Thursday, November 27, 2025 2:32â€¯AM"><a href=#chatlog__message-container-1443429225553068072>11/27/2025 2:32â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Yes, it was resolved, thanks</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1443639491653796002 class=chatlog__message-container data-message-id=1443639491653796002><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/508682252595626015/d010225358b327066c854c6e2fc36982.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=dexters1 data-user-id=508682252595626015>Dexters1</span> <span class=chatlog__timestamp title="Thursday, November 27, 2025 4:27â€¯PM"><a href=#chatlog__message-container-1443639491653796002>11/27/2025 4:27â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Is there an estimation of when this LanceDB library breaking issue will be resolved?

<a href="https://github.com/lancedb/lancedb/issues/2823">https://github.com/lancedb/lancedb/issues/2823</a></span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lancedb/lancedb/issues/2823><div class="chatlog__markdown chatlog__markdown-preserve">bug(node): lancedb-namespace package is empty &#183; Issue #2823 &#183; lan...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">LanceDB version 0.2.0 lancedb-namespace What happened? Pin because 0.2.0 ships an empty wheel and breaks imports &amp;quot;lance-namespace==0.0.16&amp;quot;, please fix the release Are there known steps to...</div></div></div><div class=chatlog__embed-thumbnail-container><a class=chatlog__embed-thumbnail-link href=https://images-ext-1.discordapp.net/external/3F9yN5ZUIAVEmOPQGgqX8O43wHFv16JXwn-qJweBxw8/https/opengraph.githubassets.com/f303118cd04c1161c24db3313ba204a57b5f55293098bdcf31efc150f973e183/lancedb/lancedb/issues/2823> <img class=chatlog__embed-thumbnail src=https://images-ext-1.discordapp.net/external/3F9yN5ZUIAVEmOPQGgqX8O43wHFv16JXwn-qJweBxw8/https/opengraph.githubassets.com/f303118cd04c1161c24db3313ba204a57b5f55293098bdcf31efc150f973e183/lancedb/lancedb/issues/2823 alt=Thumbnail loading=lazy> </a></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1446535797770551516 class=chatlog__message-container data-message-id=1446535797770551516><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=xuanwo data-user-id=676283050434232365>Xuanwo</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Friday, December 5, 2025 4:16â€¯PM"> <a href=#chatlog__message-container-1446535797770551516>12/5/2025 4:16â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1456155278847508522 class=chatlog__message-container data-message-id=1456155278847508522><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src=https://cdn.discordapp.com/embed/avatars/1.png alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=kevinwmerritt data-user-id=741347330929983518>kevin</span> <span class=chatlog__timestamp title="Thursday, January 1, 2026 5:21â€¯AM"><a href=#chatlog__message-container-1456155278847508522>1/1/2026 5:21â€¯AM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>I got enticed by the json support but ran into a problem where you can&#39;t a record with json to the table:

  When creating a table with pa.json<em>() columns and inserting data via table.add([{...}]), inserts fail with:

  RuntimeError: Append with different schema: <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">data</code> should have type json but type was large_binary

  Repro:

```python
  import lancedb
  import pyarrow as pa

  db = lancedb.connect(&#39;/tmp/test&#39;)
  schema = pa.schema([
      pa.field(&#39;id&#39;, pa.string()),
      pa.field(&#39;data&#39;, pa.json</em>())
  ])
  table = db.create<em>table(&#39;test&#39;, schema=schema)
  table.add([{&#39;id&#39;: &#39;1&#39;, &#39;data&#39;: &#39;{&quot;foo&quot;: &quot;bar&quot;}&#39;}])  # fails
```

  The schema accepts pa.json</em>(), but on insert the string data gets converted to large_binary instead of the JSON extension type. Happens on both fresh tables and appends. Using pa.string() works as a workaround.

related:
<a href="https://github.com/lance-format/lance/issues/4831">https://github.com/lance-format/lance/issues/4831</a></span> <span class=chatlog__edited-timestamp title="Thursday, January 1, 2026 5:21â€¯AM">(edited)</span></div><div class=chatlog__embed><div class=chatlog__embed-color-pill style=background-color:rgba(30,35,39,255)></div><div class=chatlog__embed-content-container><div class=chatlog__embed-content><div class=chatlog__embed-text><div class=chatlog__embed-title><a class=chatlog__embed-title-link href=https://github.com/lance-format/lance/issues/4831><div class="chatlog__markdown chatlog__markdown-preserve">Can&#39;t use JSON fields with merge_insert &#183; Issue #4831 &#183; lance-for...</div></a></div><div class=chatlog__embed-description><div class="chatlog__markdown chatlog__markdown-preserve">Hi. <a href="https://github.com/lancedb/lance/blob/30dcb5b8eb01e2fd4d05824b908d4174bab549d6/rust/lance/src/dataset/write/merge_insert/exec/write.rs#L361-L373">https://github.com/lancedb/lance/blob/30dcb5b8eb01e2fd4d05824b908d4174bab549d6/rust/lance/src/dataset/write/merge_insert/exec/write.rs#L361-L373</a> I found that the metadata of data column field w...</div></div></div></div></div></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1456355075843952675 class=chatlog__message-container data-message-id=1456355075843952675><div class=chatlog__message><div class=chatlog__message-aside><svg class=chatlog__system-notification-icon><use href=#thread-icon></use></svg></div><div class=chatlog__message-primary><span class=chatlog__system-notification-author style=color:rgb(230,126,34) title=wjones127 data-user-id=1107704233685434519>Will Jones</span> <span> </span> <span class=chatlog__system-notification-content> <span>started a thread.</span> </span> <span class=chatlog__system-notification-timestamp title="Thursday, January 1, 2026 6:35â€¯PM"> <a href=#chatlog__message-container-1456355075843952675>1/1/2026 6:35â€¯PM</a> </span></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1456659493659213834 class=chatlog__message-container data-message-id=1456659493659213834><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/307584337329782784/e42959e6022ceca97f82bf9f668aa94a.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author title=cdellinger data-user-id=307584337329782784>cdellinger</span> <span class=chatlog__timestamp title="Friday, January 2, 2026 2:44â€¯PM"><a href=#chatlog__message-container-1456659493659213834>1/2/2026 2:44â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>After creating a new table with 4M records and a single IVF_HNSW_SQ/Cosine index, when I try to run an &quot;optimize&quot; I get the following error.  Any suggestions on what is causing this and how to troubleshoot?

thread &#39;tokio-runtime-worker&#39; panicked at /Users/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/lance-0.39.0/src/index/vector/builder.rs:1779:14:
called <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">Option::unwrap()</code> on a <code class="chatlog__markdown-pre chatlog__markdown-pre--inline">None</code> value
Traceback (most recent call last):
  File &quot;/Users/cdellinger/dev/podrocket/tenant_analysis_server/app/data_setup/scripts/optimize.py&quot;, line 7, in &lt;module&gt;
    tbl.optimize()
  File &quot;/Users/cdellinger/.pyenv/versions/venv-extractor/lib/python3.11/site-packages/lancedb/table.py&quot;, line 2890, in optimize
    LOOP.run(
  File &quot;/Users/cdellinger/.pyenv/versions/venv-extractor/lib/python3.11/site-packages/lancedb/background_loop.py&quot;, line 25, in run
    return asyncio.run_coroutine_threadsafe(future, self.loop).result()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/Users/cdellinger/.pyenv/versions/3.11.10/lib/python3.11/concurrent/futures/_base.py&quot;, line 456, in result
    return self.<u>get_result()
           ^^^^^^^^^^^^^^^^^^^
  File &quot;/Users/cdellinger/.pyenv/versions/3.11.10/lib/python3.11/concurrent/futures/_base.py&quot;, line 401, in </u>get_result
    raise self._exception
  File &quot;/Users/cdellinger/.pyenv/versions/venv-extractor/lib/python3.11/site-packages/lancedb/table.py&quot;, line 4369, in optimize
    return await self._inner.optimize(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
pyo3_async_runtimes.RustPanic: rust future panicked: unknown error</span></div></div></div></div></div>
<div class=chatlog__message-group><div id=chatlog__message-container-1465743793528508430 class=chatlog__message-container data-message-id=1465743793528508430><div class=chatlog__message><div class=chatlog__message-aside><img class=chatlog__avatar src="https://cdn.discordapp.com/avatars/675128789646442557/1cb13b6385769af97ea2584be513124e.png?size=512" alt=Avatar loading=lazy></div><div class=chatlog__message-primary><div class=chatlog__header><span class=chatlog__author style=color:rgb(230,126,34) title=prrao data-user-id=675128789646442557>prashanth</span> <span class=chatlog__timestamp title="Tuesday, January 27, 2026 4:22â€¯PM"><a href=#chatlog__message-container-1465743793528508430>1/27/2026 4:22â€¯PM</a></span></div><div class="chatlog__content chatlog__markdown"><span class=chatlog__markdown-preserve>Hi all, from this point, we will be directing users to posting bug reports as issues <a href="https://github.com/lancedb/lancedb/issues">on GitHub</a>. Thanks!
If you have questions about specific topics, please post them on <span class="chatlog__markdown-mention">#â“questions</span></span></div></div></div></div></div>

</div>
<div class=postamble><div class=postamble__entry>Exported 878 message(s)</div><div class=postamble__entry>Timezone: UTC+0</div></div>
